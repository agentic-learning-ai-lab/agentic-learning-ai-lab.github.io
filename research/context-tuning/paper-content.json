{
  "html": "<section class=\"ltx_section\" id=\"S1\">\n<h2 class=\"ltx_title ltx_title_section\">\n<span class=\"ltx_tag ltx_tag_section\">1 </span>Introduction</h2>\n<div class=\"ltx_para\" id=\"S1.p1\">\n<p class=\"ltx_p\" id=\"S1.p1.1\">Large language models (LLMs) have demonstrated impressive capabilities across a wide range of natural language processing (NLP) tasks by leveraging knowledge acquired during large-scale pretraining <cite class=\"ltx_cite ltx_citemacro_citep\">(Brown et al., <a class=\"ltx_ref\" href=\"#bib.bib3\" title=\"\">2020</a>; Grattafiori et al., <a class=\"ltx_ref\" href=\"#bib.bib17\" title=\"\">2024</a>; Jiang et al., <a class=\"ltx_ref\" href=\"#bib.bib24\" title=\"\">2023</a>)</cite>. These models can adapt to new tasks using only a few input and output examples provided in context, a process known as In-Context Learning (ICL) <cite class=\"ltx_cite ltx_citemacro_citep\">(Brown et al., <a class=\"ltx_ref\" href=\"#bib.bib3\" title=\"\">2020</a>)</cite>. However, ICL often struggles with complex reasoning or domain shifts, as it relies solely on a forward pass to interpret the examples. While methods like Test-Time Training (TTT) <cite class=\"ltx_cite ltx_citemacro_citep\">(Akyürek et al., <a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite> have shown that effective adaptation is possible with limited data, they can still be computationally expensive. This highlights the need for more efficient and effective approaches to task adaptation in LLMs.</p>\n</div>\n<div class=\"ltx_para\" id=\"S1.p2\">\n<p class=\"ltx_p\" id=\"S1.p2.1\">Contrary to ICL’s reliance on a forward pass, prompt-based adaptation methods like Prompt Tuning <cite class=\"ltx_cite ltx_citemacro_citep\">(Lester et al., <a class=\"ltx_ref\" href=\"#bib.bib27\" title=\"\">2021</a>)</cite> and Prefix Tuning <cite class=\"ltx_cite ltx_citemacro_citep\">(Li and Liang, <a class=\"ltx_ref\" href=\"#bib.bib29\" title=\"\">2021</a>)</cite> prepend a set of trainable vectors to each example input and optimize them via gradient descent. At a conceptual level, ICL harnesses the model’s ability to extract task-relevant information from the context of few-shot examples, while prompt-based adaptation methods optimize randomly initialized vectors to guide the model’s behavior in solving each example. Given these complementary approaches, it is natural to ask whether we can bridge them by directly optimizing the context of few-shot examples to steer the model more effectively.</p>\n</div>\n<div class=\"ltx_para\" id=\"S1.p3\">\n<p class=\"ltx_p\" id=\"S1.p3.1\">In this work, we introduce <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.1\">Context Tuning</span>, a simple and effective method for few-shot learning that initializes trainable vectors from the few-shot examples of a novel task, then optimizes them to solve each example. We develop two variants: <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.2\">CT-Prompt</span>, which applies Prompt Tuning to a soft prompt initialized from few-shot examples, and <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.3\">CT-KV</span>, which applies Prefix Tuning to optimize the key-value (KV) cache derived from those same examples. While <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.4\">CT-Prompt</span> achieves strong performance, it suffers from a quadratic training-time cost in the number of examples. Similarly, the recently proposed Test-Time Training (TTT) <cite class=\"ltx_cite ltx_citemacro_citep\">(Akyürek et al., <a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite> method, which fine-tunes model parameters with LoRA <cite class=\"ltx_cite ltx_citemacro_citep\">(Hu et al., <a class=\"ltx_ref\" href=\"#bib.bib22\" title=\"\">2022</a>)</cite> on permutations of few-shot examples, also incurs quadratic cost. In contrast, <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.5\">CT-KV</span> achieves linear training time complexity while also outperforming <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.6\">CT-Prompt</span> and achieving competitive performance to TTT, thanks to the efficiency and per-layer conditioning of the KV cache. In addition, because <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.7\">Context Tuning</span> tunes the context and TTT tunes the model, the two methods are complementary: applying <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.8\">CT-KV</span> to refine the model context after TTT’s weight updates leads to additional performance gains. A high-level comparison in Figure <a class=\"ltx_ref\" href=\"#S1.F1\" title=\"Figure 1 ‣ 1 Introduction ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a> illustrates <span class=\"ltx_text ltx_font_italic\" id=\"S1.p3.1.9\">CT-KV</span>’s high efficiency and accuracy, whether used alone or in combination with TTT.</p>\n</div>\n<figure class=\"ltx_figure ltx_align_floatright\" id=\"S1.F1\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"187\" id=\"S1.F1.g1\" src=\"./assets/x1.png\" width=\"299\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 1: </span>\nComparison of training-free, prompt-based adaptation, and <span class=\"ltx_text ltx_font_italic\" id=\"S1.F1.5.1\">In-Context Optimization</span> methods on solving 26 NLP-LR tasks from Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a>. <span class=\"ltx_text\" id=\"S1.F1.6.2\" style=\"color:#0000FF;\">Circles</span> are baselines; <span class=\"ltx_text\" id=\"S1.F1.7.3\" style=\"color:#FF0000;\">stars</span> are our methods; <span class=\"ltx_text ltx_font_bold\" id=\"S1.F1.8.4\">bolded</span> methods attain the best performance-efficiency tradeoff.\n</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"S1.p4\">\n<p class=\"ltx_p\" id=\"S1.p4.1\">We situate these two approaches for few-shot learning with in-context examples – TTT that optimizes the model itself, and <span class=\"ltx_text ltx_font_italic\" id=\"S1.p4.1.1\">Context Tuning</span> that optimizes the model’s context – within a broader framework we term <span class=\"ltx_text ltx_font_italic\" id=\"S1.p4.1.2\">In-Context Optimization</span> (<span class=\"ltx_text ltx_font_italic\" id=\"S1.p4.1.3\">ICO</span>). Under this framework, adaptation leverages the LLM’s ICL ability and either updates its parameters or its context representation. We evaluate ICL, prompt-based adaptation methods, and <span class=\"ltx_text ltx_font_italic\" id=\"S1.p4.1.4\">ICO</span> techniques across a wide range of natural language and symbolic reasoning benchmarks, including CrossFit <cite class=\"ltx_cite ltx_citemacro_citep\">(Ye et al., <a class=\"ltx_ref\" href=\"#bib.bib50\" title=\"\">2021</a>)</cite>, UnifiedQA <cite class=\"ltx_cite ltx_citemacro_citep\">(Khashabi et al., <a class=\"ltx_ref\" href=\"#bib.bib25\" title=\"\">2020</a>)</cite>, BIG-Bench Hard (BBH) <cite class=\"ltx_cite ltx_citemacro_citep\">(Srivastava et al., <a class=\"ltx_ref\" href=\"#bib.bib44\" title=\"\">2023</a>; Suzgun et al., <a class=\"ltx_ref\" href=\"#bib.bib46\" title=\"\">2022</a>)</cite>, MMLU <cite class=\"ltx_cite ltx_citemacro_citep\">(Hendrycks et al., <a class=\"ltx_ref\" href=\"#bib.bib19\" title=\"\">2021</a>)</cite>, and the Abstraction and Reasoning Corpus (ARC) <cite class=\"ltx_cite ltx_citemacro_citep\">(Chollet, <a class=\"ltx_ref\" href=\"#bib.bib6\" title=\"\">2019b</a>)</cite>. <span class=\"ltx_text ltx_font_italic\" id=\"S1.p4.1.5\">CT-KV</span> significantly outperforms both ICL and prompt-based adaptation methods, while remaining competitive with the more computationally intensive TTT approach. Furthermore, we show that <span class=\"ltx_text ltx_font_italic\" id=\"S1.p4.1.6\">CT-KV</span> can serve as a post-hoc refinement step following TTT, leading to improved few-shot adaptation performance compared to either method used in isolation.</p>\n</div>\n</section>\n<section class=\"ltx_section\" id=\"S2\">\n<h2 class=\"ltx_title ltx_title_section\">\n<span class=\"ltx_tag ltx_tag_section\">2 </span>Related Work</h2>\n<section class=\"ltx_paragraph\" id=\"S2.SS0.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Prompt-Based Adaptation.</h4>\n<div class=\"ltx_para\" id=\"S2.SS0.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"S2.SS0.SSS0.Px1.p1.1\">Prompt-Based Adaptation steers pretrained language models to solve downstream tasks by learning task-specific inputs while keeping the model weights frozen. AutoPrompt <cite class=\"ltx_cite ltx_citemacro_citep\">(Shin et al., <a class=\"ltx_ref\" href=\"#bib.bib42\" title=\"\">2020</a>)</cite> was an early method that constructed discrete prompts via gradient-based search. Prefix Tuning <cite class=\"ltx_cite ltx_citemacro_citep\">(Li and Liang, <a class=\"ltx_ref\" href=\"#bib.bib29\" title=\"\">2021</a>)</cite> introduced trainable continuous vectors that serve as a prefix to the model’s key-value cache at each layer, achieving strong performance on generation tasks with only a small number of trainable parameters. P-Tuning <cite class=\"ltx_cite ltx_citemacro_citep\">(Liu et al., <a class=\"ltx_ref\" href=\"#bib.bib34\" title=\"\">2022b</a>)</cite> appended soft prompts to the input and used an LSTM-based prompt encoder to model dependencies between prompt tokens. Prompt Tuning <cite class=\"ltx_cite ltx_citemacro_citep\">(Lester et al., <a class=\"ltx_ref\" href=\"#bib.bib27\" title=\"\">2021</a>)</cite> simplified the approach by learning soft prompts solely at the input layer and demonstrated that performance improves with model scale. P-Tuning v2 <cite class=\"ltx_cite ltx_citemacro_citep\">(Liu et al., <a class=\"ltx_ref\" href=\"#bib.bib33\" title=\"\">2022a</a>)</cite> provided an optimized implementation of Prefix Tuning and extended it to natural language understanding tasks. While these works typically initialize their learnable prompts using high-level task instructions, random tokens, or unrelated words, <span class=\"ltx_text ltx_font_italic\" id=\"S2.SS0.SSS0.Px1.p1.1.1\">Context Tuning</span> leverages the pretrained LLM’s ability to extract meaningful task-specific information directly from in-context demonstration pairs. Finally, <cite class=\"ltx_cite ltx_citemacro_citet\">Singhal et al., (<a class=\"ltx_ref\" href=\"#bib.bib43\" title=\"\">2023</a>)</cite> proposed Instruction Prompt Tuning, in which expert-curated few-shot demonstrations are prepended to a learned soft prompt. In contrast, <span class=\"ltx_text ltx_font_italic\" id=\"S2.SS0.SSS0.Px1.p1.1.2\">Context Tuning</span> draws demonstration pairs directly from the dataset and uses them to initialize the prompt rather than prepending them as input.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S2.SS0.SSS0.Px2\">\n<h4 class=\"ltx_title ltx_title_paragraph\">In-Context Learning.</h4>\n<div class=\"ltx_para\" id=\"S2.SS0.SSS0.Px2.p1\">\n<p class=\"ltx_p\" id=\"S2.SS0.SSS0.Px2.p1.1\">Introduced by <cite class=\"ltx_cite ltx_citemacro_citet\">Radford et al., (<a class=\"ltx_ref\" href=\"#bib.bib40\" title=\"\">2019</a>)</cite>, ICL has become a defining feature of large language models (LLMs), enabling them to perform novel tasks by conditioning on a few input-output demonstrations without any parameter updates. This behavior has been leveraged through various prompting strategies, such as Chain-of-Thought prompting to elicit reasoning <cite class=\"ltx_cite ltx_citemacro_citep\">(Wei et al., <a class=\"ltx_ref\" href=\"#bib.bib49\" title=\"\">2022</a>)</cite> and self-consistency decoding to reduce variance <cite class=\"ltx_cite ltx_citemacro_citep\">(Wang et al., <a class=\"ltx_ref\" href=\"#bib.bib48\" title=\"\">2023</a>)</cite>. Prior work has also explored selecting informative demonstrations <cite class=\"ltx_cite ltx_citemacro_citep\">(Liu et al., <a class=\"ltx_ref\" href=\"#bib.bib31\" title=\"\">2021</a>; Li and Qiu, <a class=\"ltx_ref\" href=\"#bib.bib28\" title=\"\">2023</a>)</cite>, as well as meta-training over large sets of tasks to improve ICL generalization and inference-time efficiency <cite class=\"ltx_cite ltx_citemacro_citep\">(Min et al., <a class=\"ltx_ref\" href=\"#bib.bib36\" title=\"\">2022a</a>; Chen et al., <a class=\"ltx_ref\" href=\"#bib.bib4\" title=\"\">2022</a>; Muhtar et al., <a class=\"ltx_ref\" href=\"#bib.bib38\" title=\"\">2024</a>)</cite>. From a theoretical perspective, <cite class=\"ltx_cite ltx_citemacro_citet\">Dai et al., (<a class=\"ltx_ref\" href=\"#bib.bib8\" title=\"\">2023</a>)</cite> and <cite class=\"ltx_cite ltx_citemacro_citet\">Deutch et al., (<a class=\"ltx_ref\" href=\"#bib.bib10\" title=\"\">2024</a>)</cite> interpret ICL as performing implicit gradient descent; <cite class=\"ltx_cite ltx_citemacro_citet\">Zhao, (<a class=\"ltx_ref\" href=\"#bib.bib51\" title=\"\">2023</a>)</cite> conceptualizes it as contextual retrieval within an associative memory framework; and <cite class=\"ltx_cite ltx_citemacro_citet\">Garg et al., (<a class=\"ltx_ref\" href=\"#bib.bib15\" title=\"\">2022</a>)</cite> demonstrates that transformers trained from scratch can learn complex function classes in-context. While these findings highlight ICL’s potential, recent studies <cite class=\"ltx_cite ltx_citemacro_citet\">Min et al., <a class=\"ltx_ref\" href=\"#bib.bib37\" title=\"\">2022b</a> </cite> and <cite class=\"ltx_cite ltx_citemacro_citet\">Jang et al., (<a class=\"ltx_ref\" href=\"#bib.bib23\" title=\"\">2024</a>)</cite> show that LLMs often only rely on superficial patterns in the demonstrations rather than learning the underlying task. Our work further investigates these limitations by analyzing the intermediate key-value (KV) cache extracted from demonstration pairs in Section <a class=\"ltx_ref\" href=\"#S5.SS7\" title=\"5.7 Why does CT-KV Outperform ICL? ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">5.7</span></a>, showing that it fails to encode sufficient task information and addresses this shortcoming through gradient optimization.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S2.SS0.SSS0.Px3\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Inference-Time Optimization.</h4>\n<div class=\"ltx_para\" id=\"S2.SS0.SSS0.Px3.p1\">\n<p class=\"ltx_p\" id=\"S2.SS0.SSS0.Px3.p1.1\">Our framework, <span class=\"ltx_text ltx_font_italic\" id=\"S2.SS0.SSS0.Px3.p1.1.1\">In-Context Optimization</span>, contributes to a broader class of methods that adapt models or their internal representations at inference time. Originally applied to object recognition <cite class=\"ltx_cite ltx_citemacro_citep\">(Sun et al., <a class=\"ltx_ref\" href=\"#bib.bib45\" title=\"\">2020</a>; Gandelsman et al., <a class=\"ltx_ref\" href=\"#bib.bib14\" title=\"\">2022</a>)</cite>, test-time training has since shown strong results in language modeling <cite class=\"ltx_cite ltx_citemacro_citep\">(Hardt and Sun, <a class=\"ltx_ref\" href=\"#bib.bib18\" title=\"\">2024</a>)</cite>, video generation <cite class=\"ltx_cite ltx_citemacro_citep\">(Dalal et al., <a class=\"ltx_ref\" href=\"#bib.bib9\" title=\"\">2025</a>)</cite>, controllable language generation <cite class=\"ltx_cite ltx_citemacro_citep\">(Liu et al., <a class=\"ltx_ref\" href=\"#bib.bib32\" title=\"\">2024b</a>)</cite>, and abstract reasoning <cite class=\"ltx_cite ltx_citemacro_citep\">(Bonnet and Macfarlane, <a class=\"ltx_ref\" href=\"#bib.bib2\" title=\"\">2024</a>)</cite>. In diffusion models <cite class=\"ltx_cite ltx_citemacro_citep\">(Ho et al., <a class=\"ltx_ref\" href=\"#bib.bib21\" title=\"\">2020</a>; Rombach et al., <a class=\"ltx_ref\" href=\"#bib.bib41\" title=\"\">2022</a>)</cite>, techniques such as classifier guidance and classifier-free guidance <cite class=\"ltx_cite ltx_citemacro_citep\">(Dhariwal and Nichol, <a class=\"ltx_ref\" href=\"#bib.bib12\" title=\"\">2021</a>; Ho, <a class=\"ltx_ref\" href=\"#bib.bib20\" title=\"\">2022</a>)</cite> steer generation by optimizing intermediate outputs during sampling. These methods have enabled controllable text-to-image synthesis <cite class=\"ltx_cite ltx_citemacro_citep\">(Nichol et al., <a class=\"ltx_ref\" href=\"#bib.bib39\" title=\"\">2022</a>)</cite>, adjustable aesthetic attributes <cite class=\"ltx_cite ltx_citemacro_citep\">(Wallace et al., <a class=\"ltx_ref\" href=\"#bib.bib47\" title=\"\">2023</a>)</cite>, and improved sample diversity <cite class=\"ltx_cite ltx_citemacro_citep\">(Lu et al., <a class=\"ltx_ref\" href=\"#bib.bib35\" title=\"\">2024</a>)</cite>. More recently, <cite class=\"ltx_cite ltx_citemacro_citet\">Akyürek et al., (<a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite> proposed test-time training of LoRA <cite class=\"ltx_cite ltx_citemacro_citep\">(Hu et al., <a class=\"ltx_ref\" href=\"#bib.bib22\" title=\"\">2022</a>)</cite> parameters for ICL using a leave-one-out strategy, achieving state-of-the-art performance on the Abstraction and Reasoning Corpus (ARC) <cite class=\"ltx_cite ltx_citemacro_citep\">(Chollet, <a class=\"ltx_ref\" href=\"#bib.bib6\" title=\"\">2019b</a>; Chollet, <a class=\"ltx_ref\" href=\"#bib.bib5\" title=\"\">2019a</a>)</cite>. In contrast, <span class=\"ltx_text ltx_font_italic\" id=\"S2.SS0.SSS0.Px3.p1.1.2\">Context Tuning</span> tunes a soft prompt or continuous prefix rather than updating model weights, and we evaluate it on a broader range of ICL tasks.</p>\n</div>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"S3\">\n<h2 class=\"ltx_title ltx_title_section\">\n<span class=\"ltx_tag ltx_tag_section\">3 </span>Background</h2>\n<div class=\"ltx_para\" id=\"S3.p1\">\n<p class=\"ltx_p\" id=\"S3.p1.4\">We introduce the mathematical formulation of ICL, Prefix Tuning, and Prompt Tuning. To set up the problem of single-task few-shot adaptation, we consider a language model <math alttext=\"p_{\\phi}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.p1.1.m1.1\"><semantics id=\"S3.p1.1.m1.1a\"><msub id=\"S3.p1.1.m1.1.1\" xref=\"S3.p1.1.m1.1.1.cmml\"><mi id=\"S3.p1.1.m1.1.1.2\" xref=\"S3.p1.1.m1.1.1.2.cmml\">p</mi><mi id=\"S3.p1.1.m1.1.1.3\" xref=\"S3.p1.1.m1.1.1.3.cmml\">ϕ</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S3.p1.1.m1.1b\"><apply id=\"S3.p1.1.m1.1.1.cmml\" xref=\"S3.p1.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.p1.1.m1.1.1.1.cmml\" xref=\"S3.p1.1.m1.1.1\">subscript</csymbol><ci id=\"S3.p1.1.m1.1.1.2.cmml\" xref=\"S3.p1.1.m1.1.1.2\">𝑝</ci><ci id=\"S3.p1.1.m1.1.1.3.cmml\" xref=\"S3.p1.1.m1.1.1.3\">italic-ϕ</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.p1.1.m1.1c\">p_{\\phi}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.p1.1.m1.1d\">italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> with parameters <math alttext=\"\\phi\" class=\"ltx_Math\" display=\"inline\" id=\"S3.p1.2.m2.1\"><semantics id=\"S3.p1.2.m2.1a\"><mi id=\"S3.p1.2.m2.1.1\" xref=\"S3.p1.2.m2.1.1.cmml\">ϕ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.p1.2.m2.1b\"><ci id=\"S3.p1.2.m2.1.1.cmml\" xref=\"S3.p1.2.m2.1.1\">italic-ϕ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.p1.2.m2.1c\">\\phi</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.p1.2.m2.1d\">italic_ϕ</annotation></semantics></math>, <math alttext=\"d\" class=\"ltx_Math\" display=\"inline\" id=\"S3.p1.3.m3.1\"><semantics id=\"S3.p1.3.m3.1a\"><mi id=\"S3.p1.3.m3.1.1\" xref=\"S3.p1.3.m3.1.1.cmml\">d</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.p1.3.m3.1b\"><ci id=\"S3.p1.3.m3.1.1.cmml\" xref=\"S3.p1.3.m3.1.1\">𝑑</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.p1.3.m3.1c\">d</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.p1.3.m3.1d\">italic_d</annotation></semantics></math> hidden dimensions, <math alttext=\"L\" class=\"ltx_Math\" display=\"inline\" id=\"S3.p1.4.m4.1\"><semantics id=\"S3.p1.4.m4.1a\"><mi id=\"S3.p1.4.m4.1.1\" xref=\"S3.p1.4.m4.1.1.cmml\">L</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.p1.4.m4.1b\"><ci id=\"S3.p1.4.m4.1.1.cmml\" xref=\"S3.p1.4.m4.1.1\">𝐿</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.p1.4.m4.1c\">L</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.p1.4.m4.1d\">italic_L</annotation></semantics></math> layers, a demonstration set</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S3.Ex1\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathcal{D}=\\{(x_{i},y_{i})\\}_{i=1}^{k},\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex1.m1.1\"><semantics id=\"S3.Ex1.m1.1a\"><mrow id=\"S3.Ex1.m1.1.1.1\" xref=\"S3.Ex1.m1.1.1.1.1.cmml\"><mrow id=\"S3.Ex1.m1.1.1.1.1\" xref=\"S3.Ex1.m1.1.1.1.1.cmml\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S3.Ex1.m1.1.1.1.1.3\" xref=\"S3.Ex1.m1.1.1.1.1.3.cmml\">𝒟</mi><mo id=\"S3.Ex1.m1.1.1.1.1.2\" xref=\"S3.Ex1.m1.1.1.1.1.2.cmml\">=</mo><msubsup id=\"S3.Ex1.m1.1.1.1.1.1\" xref=\"S3.Ex1.m1.1.1.1.1.1.cmml\"><mrow id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml\"><mo id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml\">{</mo><mrow id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml\"><mo id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.3\" stretchy=\"false\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml\">(</mo><msub id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml\">x</mi><mi id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml\">i</mi></msub><mo id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.4\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml\">,</mo><msub id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml\"><mi id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.2\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml\">y</mi><mi id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.3\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml\">i</mi></msub><mo id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.5\" stretchy=\"false\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml\">)</mo></mrow><mo id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml\">}</mo></mrow><mrow id=\"S3.Ex1.m1.1.1.1.1.1.1.3\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3.cmml\"><mi id=\"S3.Ex1.m1.1.1.1.1.1.1.3.2\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml\">i</mi><mo id=\"S3.Ex1.m1.1.1.1.1.1.1.3.1\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3.1.cmml\">=</mo><mn id=\"S3.Ex1.m1.1.1.1.1.1.1.3.3\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml\">1</mn></mrow><mi id=\"S3.Ex1.m1.1.1.1.1.1.3\" xref=\"S3.Ex1.m1.1.1.1.1.1.3.cmml\">k</mi></msubsup></mrow><mo id=\"S3.Ex1.m1.1.1.1.2\" xref=\"S3.Ex1.m1.1.1.1.1.cmml\">,</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S3.Ex1.m1.1b\"><apply id=\"S3.Ex1.m1.1.1.1.1.cmml\" xref=\"S3.Ex1.m1.1.1.1\"><eq id=\"S3.Ex1.m1.1.1.1.1.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.2\"></eq><ci id=\"S3.Ex1.m1.1.1.1.1.3.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.3\">𝒟</ci><apply id=\"S3.Ex1.m1.1.1.1.1.1.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.Ex1.m1.1.1.1.1.1.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1\">superscript</csymbol><apply id=\"S3.Ex1.m1.1.1.1.1.1.1.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.Ex1.m1.1.1.1.1.1.1.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1\">subscript</csymbol><set id=\"S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1\"><interval closure=\"open\" id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2\"><apply id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2\">𝑥</ci><ci id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3\">𝑖</ci></apply><apply id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2\"><csymbol cd=\"ambiguous\" id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2\">subscript</csymbol><ci id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.2\">𝑦</ci><ci id=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.1.1.1.2.2.3\">𝑖</ci></apply></interval></set><apply id=\"S3.Ex1.m1.1.1.1.1.1.1.3.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3\"><eq id=\"S3.Ex1.m1.1.1.1.1.1.1.3.1.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3.1\"></eq><ci id=\"S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3.2\">𝑖</ci><cn id=\"S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml\" type=\"integer\" xref=\"S3.Ex1.m1.1.1.1.1.1.1.3.3\">1</cn></apply></apply><ci id=\"S3.Ex1.m1.1.1.1.1.1.3.cmml\" xref=\"S3.Ex1.m1.1.1.1.1.1.3\">𝑘</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.Ex1.m1.1c\">\\mathcal{D}=\\{(x_{i},y_{i})\\}_{i=1}^{k},</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.Ex1.m1.1d\">caligraphic_D = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S3.p1.6\">and the goal of solving a new query <math alttext=\"x_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.p1.5.m1.1\"><semantics id=\"S3.p1.5.m1.1a\"><msub id=\"S3.p1.5.m1.1.1\" xref=\"S3.p1.5.m1.1.1.cmml\"><mi id=\"S3.p1.5.m1.1.1.2\" xref=\"S3.p1.5.m1.1.1.2.cmml\">x</mi><mi id=\"S3.p1.5.m1.1.1.3\" xref=\"S3.p1.5.m1.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S3.p1.5.m1.1b\"><apply id=\"S3.p1.5.m1.1.1.cmml\" xref=\"S3.p1.5.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.p1.5.m1.1.1.1.cmml\" xref=\"S3.p1.5.m1.1.1\">subscript</csymbol><ci id=\"S3.p1.5.m1.1.1.2.cmml\" xref=\"S3.p1.5.m1.1.1.2\">𝑥</ci><ci id=\"S3.p1.5.m1.1.1.3.cmml\" xref=\"S3.p1.5.m1.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.p1.5.m1.1c\">x_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.p1.5.m1.1d\">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> from the same task. We denote the concatenated context of all demonstration pairs as <math alttext=\"\\mathcal{C}=[x_{1};y_{1};\\dots;x_{k};y_{k}]\" class=\"ltx_Math\" display=\"inline\" id=\"S3.p1.6.m2.5\"><semantics id=\"S3.p1.6.m2.5a\"><mrow id=\"S3.p1.6.m2.5.5\" xref=\"S3.p1.6.m2.5.5.cmml\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S3.p1.6.m2.5.5.6\" xref=\"S3.p1.6.m2.5.5.6.cmml\">𝒞</mi><mo id=\"S3.p1.6.m2.5.5.5\" xref=\"S3.p1.6.m2.5.5.5.cmml\">=</mo><mrow id=\"S3.p1.6.m2.5.5.4.4\" xref=\"S3.p1.6.m2.5.5.4.5.cmml\"><mo id=\"S3.p1.6.m2.5.5.4.4.5\" stretchy=\"false\" xref=\"S3.p1.6.m2.5.5.4.5.cmml\">[</mo><msub id=\"S3.p1.6.m2.2.2.1.1.1\" xref=\"S3.p1.6.m2.2.2.1.1.1.cmml\"><mi id=\"S3.p1.6.m2.2.2.1.1.1.2\" xref=\"S3.p1.6.m2.2.2.1.1.1.2.cmml\">x</mi><mn id=\"S3.p1.6.m2.2.2.1.1.1.3\" xref=\"S3.p1.6.m2.2.2.1.1.1.3.cmml\">1</mn></msub><mo id=\"S3.p1.6.m2.5.5.4.4.6\" xref=\"S3.p1.6.m2.5.5.4.5.cmml\">;</mo><msub id=\"S3.p1.6.m2.3.3.2.2.2\" xref=\"S3.p1.6.m2.3.3.2.2.2.cmml\"><mi id=\"S3.p1.6.m2.3.3.2.2.2.2\" xref=\"S3.p1.6.m2.3.3.2.2.2.2.cmml\">y</mi><mn id=\"S3.p1.6.m2.3.3.2.2.2.3\" xref=\"S3.p1.6.m2.3.3.2.2.2.3.cmml\">1</mn></msub><mo id=\"S3.p1.6.m2.5.5.4.4.7\" xref=\"S3.p1.6.m2.5.5.4.5.cmml\">;</mo><mi id=\"S3.p1.6.m2.1.1\" mathvariant=\"normal\" xref=\"S3.p1.6.m2.1.1.cmml\">…</mi><mo id=\"S3.p1.6.m2.5.5.4.4.8\" xref=\"S3.p1.6.m2.5.5.4.5.cmml\">;</mo><msub id=\"S3.p1.6.m2.4.4.3.3.3\" xref=\"S3.p1.6.m2.4.4.3.3.3.cmml\"><mi id=\"S3.p1.6.m2.4.4.3.3.3.2\" xref=\"S3.p1.6.m2.4.4.3.3.3.2.cmml\">x</mi><mi id=\"S3.p1.6.m2.4.4.3.3.3.3\" xref=\"S3.p1.6.m2.4.4.3.3.3.3.cmml\">k</mi></msub><mo id=\"S3.p1.6.m2.5.5.4.4.9\" xref=\"S3.p1.6.m2.5.5.4.5.cmml\">;</mo><msub id=\"S3.p1.6.m2.5.5.4.4.4\" xref=\"S3.p1.6.m2.5.5.4.4.4.cmml\"><mi id=\"S3.p1.6.m2.5.5.4.4.4.2\" xref=\"S3.p1.6.m2.5.5.4.4.4.2.cmml\">y</mi><mi id=\"S3.p1.6.m2.5.5.4.4.4.3\" xref=\"S3.p1.6.m2.5.5.4.4.4.3.cmml\">k</mi></msub><mo id=\"S3.p1.6.m2.5.5.4.4.10\" stretchy=\"false\" xref=\"S3.p1.6.m2.5.5.4.5.cmml\">]</mo></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S3.p1.6.m2.5b\"><apply id=\"S3.p1.6.m2.5.5.cmml\" xref=\"S3.p1.6.m2.5.5\"><eq id=\"S3.p1.6.m2.5.5.5.cmml\" xref=\"S3.p1.6.m2.5.5.5\"></eq><ci id=\"S3.p1.6.m2.5.5.6.cmml\" xref=\"S3.p1.6.m2.5.5.6\">𝒞</ci><list id=\"S3.p1.6.m2.5.5.4.5.cmml\" xref=\"S3.p1.6.m2.5.5.4.4\"><apply id=\"S3.p1.6.m2.2.2.1.1.1.cmml\" xref=\"S3.p1.6.m2.2.2.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.p1.6.m2.2.2.1.1.1.1.cmml\" xref=\"S3.p1.6.m2.2.2.1.1.1\">subscript</csymbol><ci id=\"S3.p1.6.m2.2.2.1.1.1.2.cmml\" xref=\"S3.p1.6.m2.2.2.1.1.1.2\">𝑥</ci><cn id=\"S3.p1.6.m2.2.2.1.1.1.3.cmml\" type=\"integer\" xref=\"S3.p1.6.m2.2.2.1.1.1.3\">1</cn></apply><apply id=\"S3.p1.6.m2.3.3.2.2.2.cmml\" xref=\"S3.p1.6.m2.3.3.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S3.p1.6.m2.3.3.2.2.2.1.cmml\" xref=\"S3.p1.6.m2.3.3.2.2.2\">subscript</csymbol><ci id=\"S3.p1.6.m2.3.3.2.2.2.2.cmml\" xref=\"S3.p1.6.m2.3.3.2.2.2.2\">𝑦</ci><cn id=\"S3.p1.6.m2.3.3.2.2.2.3.cmml\" type=\"integer\" xref=\"S3.p1.6.m2.3.3.2.2.2.3\">1</cn></apply><ci id=\"S3.p1.6.m2.1.1.cmml\" xref=\"S3.p1.6.m2.1.1\">…</ci><apply id=\"S3.p1.6.m2.4.4.3.3.3.cmml\" xref=\"S3.p1.6.m2.4.4.3.3.3\"><csymbol cd=\"ambiguous\" id=\"S3.p1.6.m2.4.4.3.3.3.1.cmml\" xref=\"S3.p1.6.m2.4.4.3.3.3\">subscript</csymbol><ci id=\"S3.p1.6.m2.4.4.3.3.3.2.cmml\" xref=\"S3.p1.6.m2.4.4.3.3.3.2\">𝑥</ci><ci id=\"S3.p1.6.m2.4.4.3.3.3.3.cmml\" xref=\"S3.p1.6.m2.4.4.3.3.3.3\">𝑘</ci></apply><apply id=\"S3.p1.6.m2.5.5.4.4.4.cmml\" xref=\"S3.p1.6.m2.5.5.4.4.4\"><csymbol cd=\"ambiguous\" id=\"S3.p1.6.m2.5.5.4.4.4.1.cmml\" xref=\"S3.p1.6.m2.5.5.4.4.4\">subscript</csymbol><ci id=\"S3.p1.6.m2.5.5.4.4.4.2.cmml\" xref=\"S3.p1.6.m2.5.5.4.4.4.2\">𝑦</ci><ci id=\"S3.p1.6.m2.5.5.4.4.4.3.cmml\" xref=\"S3.p1.6.m2.5.5.4.4.4.3\">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.p1.6.m2.5c\">\\mathcal{C}=[x_{1};y_{1};\\dots;x_{k};y_{k}]</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.p1.6.m2.5d\">caligraphic_C = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; … ; italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ; italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ]</annotation></semantics></math>.</p>\n</div>\n<section class=\"ltx_paragraph\" id=\"S3.SS0.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">In-Context Learning.</h4>\n<div class=\"ltx_para\" id=\"S3.SS0.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"S3.SS0.SSS0.Px1.p1.3\">ICL concatenates all <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px1.p1.1.m1.1\"><semantics id=\"S3.SS0.SSS0.Px1.p1.1.m1.1a\"><mi id=\"S3.SS0.SSS0.Px1.p1.1.m1.1.1\" xref=\"S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px1.p1.1.m1.1b\"><ci id=\"S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.1.m1.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px1.p1.1.m1.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px1.p1.1.m1.1d\">italic_k</annotation></semantics></math> demonstration pairs followed by the query <math alttext=\"x_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px1.p1.2.m2.1\"><semantics id=\"S3.SS0.SSS0.Px1.p1.2.m2.1a\"><msub id=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1\" xref=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml\"><mi id=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.2\" xref=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml\">x</mi><mi id=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.3\" xref=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px1.p1.2.m2.1b\"><apply id=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1\">subscript</csymbol><ci id=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.2\">𝑥</ci><ci id=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.2.m2.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px1.p1.2.m2.1c\">x_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px1.p1.2.m2.1d\">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>. The model then predicts <math alttext=\"\\hat{y}_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px1.p1.3.m3.1\"><semantics id=\"S3.SS0.SSS0.Px1.p1.3.m3.1a\"><msub id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml\"><mover accent=\"true\" id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml\"><mi id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml\">y</mi><mo id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml\">^</mo></mover><mi id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.3\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px1.p1.3.m3.1b\"><apply id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1\">subscript</csymbol><apply id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2\"><ci id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.1\">^</ci><ci id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.2.2\">𝑦</ci></apply><ci id=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml\" xref=\"S3.SS0.SSS0.Px1.p1.3.m3.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px1.p1.3.m3.1c\">\\hat{y}_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px1.p1.3.m3.1d\">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> conditioned on this context:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S3.Ex2\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\hat{y}_{q}=\\arg\\max_{y}\\;p_{\\phi}\\bigl{(}y\\bigm{|}[\\,\\mathcal{C};x_{q}\\,]%\n\\bigr{)}.\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S3.Ex2.m1.1\"><semantics id=\"S3.Ex2.m1.1a\"><mrow id=\"S3.Ex2.m1.1b\"><msub id=\"S3.Ex2.m1.1.2\"><mover accent=\"true\" id=\"S3.Ex2.m1.1.2.2\"><mi id=\"S3.Ex2.m1.1.2.2.2\">y</mi><mo id=\"S3.Ex2.m1.1.2.2.1\">^</mo></mover><mi id=\"S3.Ex2.m1.1.2.3\">q</mi></msub><mo id=\"S3.Ex2.m1.1.3\">=</mo><mi id=\"S3.Ex2.m1.1.4\">arg</mi><munder id=\"S3.Ex2.m1.1.5\"><mi id=\"S3.Ex2.m1.1.5.2\">max</mi><mi id=\"S3.Ex2.m1.1.5.3\">y</mi></munder><msub id=\"S3.Ex2.m1.1.6\"><mi id=\"S3.Ex2.m1.1.6.2\">p</mi><mi id=\"S3.Ex2.m1.1.6.3\">ϕ</mi></msub><mrow id=\"S3.Ex2.m1.1.7\"><mo id=\"S3.Ex2.m1.1.7.1\" maxsize=\"120%\" minsize=\"120%\">(</mo><mi id=\"S3.Ex2.m1.1.7.2\">y</mi><mo id=\"S3.Ex2.m1.1.7.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S3.Ex2.m1.1.7.4\"><mo id=\"S3.Ex2.m1.1.7.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><mi class=\"ltx_font_mathcaligraphic\" id=\"S3.Ex2.m1.1.1\">𝒞</mi><mo id=\"S3.Ex2.m1.1.7.4.2\">;</mo><msub id=\"S3.Ex2.m1.1.7.4.3\"><mi id=\"S3.Ex2.m1.1.7.4.3.2\">x</mi><mi id=\"S3.Ex2.m1.1.7.4.3.3\">q</mi></msub><mo id=\"S3.Ex2.m1.1.7.4.4\" stretchy=\"false\">]</mo></mrow><mo id=\"S3.Ex2.m1.1.7.5\" maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo id=\"S3.Ex2.m1.1.8\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S3.Ex2.m1.1c\">\\hat{y}_{q}=\\arg\\max_{y}\\;p_{\\phi}\\bigl{(}y\\bigm{|}[\\,\\mathcal{C};x_{q}\\,]%\n\\bigr{)}.</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.Ex2.m1.1d\">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y | [ caligraphic_C ; italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S3.SS0.SSS0.Px1.p1.4\">In ICL, there is no gradient-based optimization; instead, the model adapts by attending to the tokens of the demonstration pairs provided in context.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S3.SS0.SSS0.Px2\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Prompt Tuning.</h4>\n<div class=\"ltx_para\" id=\"S3.SS0.SSS0.Px2.p1\">\n<p class=\"ltx_p\" id=\"S3.SS0.SSS0.Px2.p1.3\">In Prompt Tuning, the model parameters <math alttext=\"\\phi\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px2.p1.1.m1.1\"><semantics id=\"S3.SS0.SSS0.Px2.p1.1.m1.1a\"><mi id=\"S3.SS0.SSS0.Px2.p1.1.m1.1.1\" xref=\"S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml\">ϕ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px2.p1.1.m1.1b\"><ci id=\"S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px2.p1.1.m1.1.1\">italic-ϕ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px2.p1.1.m1.1c\">\\phi</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px2.p1.1.m1.1d\">italic_ϕ</annotation></semantics></math> remain fixed. Instead, <math alttext=\"m\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px2.p1.2.m2.1\"><semantics id=\"S3.SS0.SSS0.Px2.p1.2.m2.1a\"><mi id=\"S3.SS0.SSS0.Px2.p1.2.m2.1.1\" xref=\"S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml\">m</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px2.p1.2.m2.1b\"><ci id=\"S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml\" xref=\"S3.SS0.SSS0.Px2.p1.2.m2.1.1\">𝑚</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px2.p1.2.m2.1c\">m</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px2.p1.2.m2.1d\">italic_m</annotation></semantics></math> trainable soft prompt tokens <math alttext=\"P\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px2.p1.3.m3.1\"><semantics id=\"S3.SS0.SSS0.Px2.p1.3.m3.1a\"><mi id=\"S3.SS0.SSS0.Px2.p1.3.m3.1.1\" xref=\"S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml\">P</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px2.p1.3.m3.1b\"><ci id=\"S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml\" xref=\"S3.SS0.SSS0.Px2.p1.3.m3.1.1\">𝑃</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px2.p1.3.m3.1c\">P</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px2.p1.3.m3.1d\">italic_P</annotation></semantics></math> are prepended to each input and optimized via gradient descent:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S3.E1\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"P^{*}=\\arg\\min_{P}\\sum_{i=1}^{k}-\\log p_{\\phi}\\bigl{(}y_{i}\\bigm{|}[\\,P;x_{i}%\n\\,]\\bigr{)}.\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S3.E1.m1.1\"><semantics id=\"S3.E1.m1.1a\"><mrow id=\"S3.E1.m1.1b\"><msup id=\"S3.E1.m1.1.2\"><mi id=\"S3.E1.m1.1.2.2\">P</mi><mo id=\"S3.E1.m1.1.2.3\">∗</mo></msup><mo id=\"S3.E1.m1.1.3\">=</mo><mi id=\"S3.E1.m1.1.4\">arg</mi><munder id=\"S3.E1.m1.1.5\"><mi id=\"S3.E1.m1.1.5.2\">min</mi><mi id=\"S3.E1.m1.1.5.3\">P</mi></munder><munderover id=\"S3.E1.m1.1.6\"><mo id=\"S3.E1.m1.1.6.2.2\" movablelimits=\"false\" rspace=\"0em\">∑</mo><mrow id=\"S3.E1.m1.1.6.2.3\"><mi id=\"S3.E1.m1.1.6.2.3.2\">i</mi><mo id=\"S3.E1.m1.1.6.2.3.1\">=</mo><mn id=\"S3.E1.m1.1.6.2.3.3\">1</mn></mrow><mi id=\"S3.E1.m1.1.6.3\">k</mi></munderover><mo id=\"S3.E1.m1.1.7\" lspace=\"0em\">−</mo><mi id=\"S3.E1.m1.1.8\">log</mi><msub id=\"S3.E1.m1.1.9\"><mi id=\"S3.E1.m1.1.9.2\">p</mi><mi id=\"S3.E1.m1.1.9.3\">ϕ</mi></msub><mrow id=\"S3.E1.m1.1.10\"><mo id=\"S3.E1.m1.1.10.1\" maxsize=\"120%\" minsize=\"120%\">(</mo><msub id=\"S3.E1.m1.1.10.2\"><mi id=\"S3.E1.m1.1.10.2.2\">y</mi><mi id=\"S3.E1.m1.1.10.2.3\">i</mi></msub><mo id=\"S3.E1.m1.1.10.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S3.E1.m1.1.10.4\"><mo id=\"S3.E1.m1.1.10.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><mi id=\"S3.E1.m1.1.1\">P</mi><mo id=\"S3.E1.m1.1.10.4.2\">;</mo><msub id=\"S3.E1.m1.1.10.4.3\"><mi id=\"S3.E1.m1.1.10.4.3.2\">x</mi><mi id=\"S3.E1.m1.1.10.4.3.3\">i</mi></msub><mo id=\"S3.E1.m1.1.10.4.4\" stretchy=\"false\">]</mo></mrow><mo id=\"S3.E1.m1.1.10.5\" maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo id=\"S3.E1.m1.1.11\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S3.E1.m1.1c\">P^{*}=\\arg\\min_{P}\\sum_{i=1}^{k}-\\log p_{\\phi}\\bigl{(}y_{i}\\bigm{|}[\\,P;x_{i}%\n\\,]\\bigr{)}.</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.E1.m1.1d\">italic_P start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - roman_log italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | [ italic_P ; italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(1)</span></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S3.SS0.SSS0.Px2.p1.4\">After optimizing on the demonstration pairs, the optimized soft prompt <math alttext=\"P^{*}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px2.p1.4.m1.1\"><semantics id=\"S3.SS0.SSS0.Px2.p1.4.m1.1a\"><msup id=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1\" xref=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.cmml\"><mi id=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.2\" xref=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.2.cmml\">P</mi><mo id=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.3\" xref=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.3.cmml\">∗</mo></msup><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px2.p1.4.m1.1b\"><apply id=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1\">superscript</csymbol><ci id=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.2.cmml\" xref=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.2\">𝑃</ci><times id=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.3.cmml\" xref=\"S3.SS0.SSS0.Px2.p1.4.m1.1.1.3\"></times></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px2.p1.4.m1.1c\">P^{*}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px2.p1.4.m1.1d\">italic_P start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> can be used for inference:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S3.Ex3\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\hat{y}_{q}=\\arg\\max_{y}\\;p_{\\phi}\\bigl{(}y\\bigm{|}[\\,P^{*};x_{q}\\,]\\bigr{)}.\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S3.Ex3.m1.1\"><semantics id=\"S3.Ex3.m1.1a\"><mrow id=\"S3.Ex3.m1.1b\"><msub id=\"S3.Ex3.m1.1.1\"><mover accent=\"true\" id=\"S3.Ex3.m1.1.1.2\"><mi id=\"S3.Ex3.m1.1.1.2.2\">y</mi><mo id=\"S3.Ex3.m1.1.1.2.1\">^</mo></mover><mi id=\"S3.Ex3.m1.1.1.3\">q</mi></msub><mo id=\"S3.Ex3.m1.1.2\">=</mo><mi id=\"S3.Ex3.m1.1.3\">arg</mi><munder id=\"S3.Ex3.m1.1.4\"><mi id=\"S3.Ex3.m1.1.4.2\">max</mi><mi id=\"S3.Ex3.m1.1.4.3\">y</mi></munder><msub id=\"S3.Ex3.m1.1.5\"><mi id=\"S3.Ex3.m1.1.5.2\">p</mi><mi id=\"S3.Ex3.m1.1.5.3\">ϕ</mi></msub><mrow id=\"S3.Ex3.m1.1.6\"><mo id=\"S3.Ex3.m1.1.6.1\" maxsize=\"120%\" minsize=\"120%\">(</mo><mi id=\"S3.Ex3.m1.1.6.2\">y</mi><mo id=\"S3.Ex3.m1.1.6.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S3.Ex3.m1.1.6.4\"><mo id=\"S3.Ex3.m1.1.6.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><msup id=\"S3.Ex3.m1.1.6.4.2\"><mi id=\"S3.Ex3.m1.1.6.4.2.2\">P</mi><mo id=\"S3.Ex3.m1.1.6.4.2.3\">∗</mo></msup><mo id=\"S3.Ex3.m1.1.6.4.3\">;</mo><msub id=\"S3.Ex3.m1.1.6.4.4\"><mi id=\"S3.Ex3.m1.1.6.4.4.2\">x</mi><mi id=\"S3.Ex3.m1.1.6.4.4.3\">q</mi></msub><mo id=\"S3.Ex3.m1.1.6.4.5\" stretchy=\"false\">]</mo></mrow><mo id=\"S3.Ex3.m1.1.6.5\" maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo id=\"S3.Ex3.m1.1.7\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S3.Ex3.m1.1c\">\\hat{y}_{q}=\\arg\\max_{y}\\;p_{\\phi}\\bigl{(}y\\bigm{|}[\\,P^{*};x_{q}\\,]\\bigr{)}.</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.Ex3.m1.1d\">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y | [ italic_P start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ; italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S3.SS0.SSS0.Px3\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Prefix Tuning.</h4>\n<div class=\"ltx_para\" id=\"S3.SS0.SSS0.Px3.p1\">\n<p class=\"ltx_p\" id=\"S3.SS0.SSS0.Px3.p1.2\">Prefix Tuning also keeps <math alttext=\"\\phi\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px3.p1.1.m1.1\"><semantics id=\"S3.SS0.SSS0.Px3.p1.1.m1.1a\"><mi id=\"S3.SS0.SSS0.Px3.p1.1.m1.1.1\" xref=\"S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml\">ϕ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px3.p1.1.m1.1b\"><ci id=\"S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.1.m1.1.1\">italic-ϕ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px3.p1.1.m1.1c\">\\phi</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px3.p1.1.m1.1d\">italic_ϕ</annotation></semantics></math> fixed but learns layer-wise prefixes of <math alttext=\"m\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px3.p1.2.m2.1\"><semantics id=\"S3.SS0.SSS0.Px3.p1.2.m2.1a\"><mi id=\"S3.SS0.SSS0.Px3.p1.2.m2.1.1\" xref=\"S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml\">m</mi><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px3.p1.2.m2.1b\"><ci id=\"S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.2.m2.1.1\">𝑚</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px3.p1.2.m2.1c\">m</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px3.p1.2.m2.1d\">italic_m</annotation></semantics></math> trainable vectors for the keys and values in each transformer layer:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S3.Ex4\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\Theta=\\{K_{j},V_{j}\\}_{j=1}^{L}.\" class=\"ltx_Math\" display=\"block\" id=\"S3.Ex4.m1.1\"><semantics id=\"S3.Ex4.m1.1a\"><mrow id=\"S3.Ex4.m1.1.1.1\" xref=\"S3.Ex4.m1.1.1.1.1.cmml\"><mrow id=\"S3.Ex4.m1.1.1.1.1\" xref=\"S3.Ex4.m1.1.1.1.1.cmml\"><mi id=\"S3.Ex4.m1.1.1.1.1.4\" mathvariant=\"normal\" xref=\"S3.Ex4.m1.1.1.1.1.4.cmml\">Θ</mi><mo id=\"S3.Ex4.m1.1.1.1.1.3\" xref=\"S3.Ex4.m1.1.1.1.1.3.cmml\">=</mo><msubsup id=\"S3.Ex4.m1.1.1.1.1.2\" xref=\"S3.Ex4.m1.1.1.1.1.2.cmml\"><mrow id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.3.cmml\"><mo id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.3\" stretchy=\"false\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.3.cmml\">{</mo><msub id=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1\" xref=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2\" xref=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml\">K</mi><mi id=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3\" xref=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml\">j</mi></msub><mo id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.4\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.3.cmml\">,</mo><msub id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.cmml\"><mi id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.2\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.2.cmml\">V</mi><mi id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.3\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.3.cmml\">j</mi></msub><mo id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.5\" stretchy=\"false\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.3.cmml\">}</mo></mrow><mrow id=\"S3.Ex4.m1.1.1.1.1.2.2.4\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4.cmml\"><mi id=\"S3.Ex4.m1.1.1.1.1.2.2.4.2\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4.2.cmml\">j</mi><mo id=\"S3.Ex4.m1.1.1.1.1.2.2.4.1\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4.1.cmml\">=</mo><mn id=\"S3.Ex4.m1.1.1.1.1.2.2.4.3\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4.3.cmml\">1</mn></mrow><mi id=\"S3.Ex4.m1.1.1.1.1.2.4\" xref=\"S3.Ex4.m1.1.1.1.1.2.4.cmml\">L</mi></msubsup></mrow><mo id=\"S3.Ex4.m1.1.1.1.2\" lspace=\"0em\" xref=\"S3.Ex4.m1.1.1.1.1.cmml\">.</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S3.Ex4.m1.1b\"><apply id=\"S3.Ex4.m1.1.1.1.1.cmml\" xref=\"S3.Ex4.m1.1.1.1\"><eq id=\"S3.Ex4.m1.1.1.1.1.3.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.3\"></eq><ci id=\"S3.Ex4.m1.1.1.1.1.4.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.4\">Θ</ci><apply id=\"S3.Ex4.m1.1.1.1.1.2.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2\"><csymbol cd=\"ambiguous\" id=\"S3.Ex4.m1.1.1.1.1.2.3.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2\">superscript</csymbol><apply id=\"S3.Ex4.m1.1.1.1.1.2.2.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2\"><csymbol cd=\"ambiguous\" id=\"S3.Ex4.m1.1.1.1.1.2.2.3.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2\">subscript</csymbol><set id=\"S3.Ex4.m1.1.1.1.1.2.2.2.3.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2\"><apply id=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2\">𝐾</ci><ci id=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3\">𝑗</ci></apply><apply id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.1.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2\">subscript</csymbol><ci id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.2.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.2\">𝑉</ci><ci id=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.3.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.2.2.2.3\">𝑗</ci></apply></set><apply id=\"S3.Ex4.m1.1.1.1.1.2.2.4.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4\"><eq id=\"S3.Ex4.m1.1.1.1.1.2.2.4.1.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4.1\"></eq><ci id=\"S3.Ex4.m1.1.1.1.1.2.2.4.2.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4.2\">𝑗</ci><cn id=\"S3.Ex4.m1.1.1.1.1.2.2.4.3.cmml\" type=\"integer\" xref=\"S3.Ex4.m1.1.1.1.1.2.2.4.3\">1</cn></apply></apply><ci id=\"S3.Ex4.m1.1.1.1.1.2.4.cmml\" xref=\"S3.Ex4.m1.1.1.1.1.2.4\">𝐿</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.Ex4.m1.1c\">\\Theta=\\{K_{j},V_{j}\\}_{j=1}^{L}.</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.Ex4.m1.1d\">roman_Θ = { italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S3.SS0.SSS0.Px3.p1.4\">Each layer’s attention uses these prefixes by prepending <math alttext=\"K_{j}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px3.p1.3.m1.1\"><semantics id=\"S3.SS0.SSS0.Px3.p1.3.m1.1a\"><msub id=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1\" xref=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.cmml\"><mi id=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.2\" xref=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.2.cmml\">K</mi><mi id=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.3\" xref=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.3.cmml\">j</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px3.p1.3.m1.1b\"><apply id=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1\">subscript</csymbol><ci id=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.2.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.2\">𝐾</ci><ci id=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.3.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.3.m1.1.1.3\">𝑗</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px3.p1.3.m1.1c\">K_{j}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px3.p1.3.m1.1d\">italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to its keys and <math alttext=\"V_{j}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px3.p1.4.m2.1\"><semantics id=\"S3.SS0.SSS0.Px3.p1.4.m2.1a\"><msub id=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1\" xref=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.cmml\"><mi id=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.2\" xref=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.2.cmml\">V</mi><mi id=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.3\" xref=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.3.cmml\">j</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px3.p1.4.m2.1b\"><apply id=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1\">subscript</csymbol><ci id=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.2.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.2\">𝑉</ci><ci id=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.3.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.4.m2.1.1.3\">𝑗</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px3.p1.4.m2.1c\">V_{j}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px3.p1.4.m2.1d\">italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to its values. The prefixes are optimized to minimize</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S3.E2\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\Theta^{*}=\\arg\\min_{\\Theta}\\sum_{i=1}^{k}-\\log p_{\\phi}\\bigl{(}y_{i}\\bigm{|}[%\n\\,\\Theta;x_{i}\\,]\\bigr{)}.\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S3.E2.m1.1\"><semantics id=\"S3.E2.m1.1a\"><mrow id=\"S3.E2.m1.1b\"><msup id=\"S3.E2.m1.1.2\"><mi id=\"S3.E2.m1.1.2.2\" mathvariant=\"normal\">Θ</mi><mo id=\"S3.E2.m1.1.2.3\">∗</mo></msup><mo id=\"S3.E2.m1.1.3\">=</mo><mi id=\"S3.E2.m1.1.4\">arg</mi><munder id=\"S3.E2.m1.1.5\"><mi id=\"S3.E2.m1.1.5.2\">min</mi><mi id=\"S3.E2.m1.1.5.3\" mathvariant=\"normal\">Θ</mi></munder><munderover id=\"S3.E2.m1.1.6\"><mo id=\"S3.E2.m1.1.6.2.2\" movablelimits=\"false\" rspace=\"0em\">∑</mo><mrow id=\"S3.E2.m1.1.6.2.3\"><mi id=\"S3.E2.m1.1.6.2.3.2\">i</mi><mo id=\"S3.E2.m1.1.6.2.3.1\">=</mo><mn id=\"S3.E2.m1.1.6.2.3.3\">1</mn></mrow><mi id=\"S3.E2.m1.1.6.3\">k</mi></munderover><mo id=\"S3.E2.m1.1.7\" lspace=\"0em\">−</mo><mi id=\"S3.E2.m1.1.8\">log</mi><msub id=\"S3.E2.m1.1.9\"><mi id=\"S3.E2.m1.1.9.2\">p</mi><mi id=\"S3.E2.m1.1.9.3\">ϕ</mi></msub><mrow id=\"S3.E2.m1.1.10\"><mo id=\"S3.E2.m1.1.10.1\" maxsize=\"120%\" minsize=\"120%\">(</mo><msub id=\"S3.E2.m1.1.10.2\"><mi id=\"S3.E2.m1.1.10.2.2\">y</mi><mi id=\"S3.E2.m1.1.10.2.3\">i</mi></msub><mo id=\"S3.E2.m1.1.10.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S3.E2.m1.1.10.4\"><mo id=\"S3.E2.m1.1.10.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><mi id=\"S3.E2.m1.1.1\" mathvariant=\"normal\">Θ</mi><mo id=\"S3.E2.m1.1.10.4.2\">;</mo><msub id=\"S3.E2.m1.1.10.4.3\"><mi id=\"S3.E2.m1.1.10.4.3.2\">x</mi><mi id=\"S3.E2.m1.1.10.4.3.3\">i</mi></msub><mo id=\"S3.E2.m1.1.10.4.4\" stretchy=\"false\">]</mo></mrow><mo id=\"S3.E2.m1.1.10.5\" maxsize=\"120%\" minsize=\"120%\">)</mo></mrow><mo id=\"S3.E2.m1.1.11\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S3.E2.m1.1c\">\\Theta^{*}=\\arg\\min_{\\Theta}\\sum_{i=1}^{k}-\\log p_{\\phi}\\bigl{(}y_{i}\\bigm{|}[%\n\\,\\Theta;x_{i}\\,]\\bigr{)}.</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.E2.m1.1d\">roman_Θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT roman_Θ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - roman_log italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | [ roman_Θ ; italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(2)</span></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S3.SS0.SSS0.Px3.p1.6\">After obtaining <math alttext=\"\\Theta^{*}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px3.p1.5.m1.1\"><semantics id=\"S3.SS0.SSS0.Px3.p1.5.m1.1a\"><msup id=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1\" xref=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.cmml\"><mi id=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.2\" mathvariant=\"normal\" xref=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.2.cmml\">Θ</mi><mo id=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.3\" xref=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.3.cmml\">∗</mo></msup><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px3.p1.5.m1.1b\"><apply id=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1\">superscript</csymbol><ci id=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.2.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.2\">Θ</ci><times id=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.3.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.5.m1.1.1.3\"></times></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px3.p1.5.m1.1c\">\\Theta^{*}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px3.p1.5.m1.1d\">roman_Θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, inference on the query <math alttext=\"x_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S3.SS0.SSS0.Px3.p1.6.m2.1\"><semantics id=\"S3.SS0.SSS0.Px3.p1.6.m2.1a\"><msub id=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1\" xref=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.cmml\"><mi id=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.2\" xref=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.2.cmml\">x</mi><mi id=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.3\" xref=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S3.SS0.SSS0.Px3.p1.6.m2.1b\"><apply id=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.1.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1\">subscript</csymbol><ci id=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.2.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.2\">𝑥</ci><ci id=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.3.cmml\" xref=\"S3.SS0.SSS0.Px3.p1.6.m2.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S3.SS0.SSS0.Px3.p1.6.m2.1c\">x_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S3.SS0.SSS0.Px3.p1.6.m2.1d\">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> proceeds analogously to Prompt Tuning.</p>\n</div>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"S4\">\n<h2 class=\"ltx_title ltx_title_section\">\n<span class=\"ltx_tag ltx_tag_section\">4 </span>Context Tuning for In-Context Optimization</h2>\n<figure class=\"ltx_figure\" id=\"S4.F2\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"253\" id=\"S4.F2.g1\" src=\"./assets/x2.png\" width=\"598\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 2: </span>\n<span class=\"ltx_text ltx_font_italic\" id=\"S4.F2.16.1\">CT-KV</span>, the variant of <span class=\"ltx_text ltx_font_italic\" id=\"S4.F2.17.2\">Context Tuning</span> that optimizes the key-value prefixes derived from in-context demonstration pairs. <span class=\"ltx_text ltx_font_italic\" id=\"S4.F2.18.3\">CT-KV</span> (left) first initializes a prefix <math alttext=\"\\{K_{i},V_{i}\\}_{i=1}^{k}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.F2.7.m1.2\"><semantics id=\"S4.F2.7.m1.2b\"><msubsup id=\"S4.F2.7.m1.2.2\" xref=\"S4.F2.7.m1.2.2.cmml\"><mrow id=\"S4.F2.7.m1.2.2.2.2.2\" xref=\"S4.F2.7.m1.2.2.2.2.3.cmml\"><mo id=\"S4.F2.7.m1.2.2.2.2.2.3\" stretchy=\"false\" xref=\"S4.F2.7.m1.2.2.2.2.3.cmml\">{</mo><msub id=\"S4.F2.7.m1.1.1.1.1.1.1\" xref=\"S4.F2.7.m1.1.1.1.1.1.1.cmml\"><mi id=\"S4.F2.7.m1.1.1.1.1.1.1.2\" xref=\"S4.F2.7.m1.1.1.1.1.1.1.2.cmml\">K</mi><mi id=\"S4.F2.7.m1.1.1.1.1.1.1.3\" xref=\"S4.F2.7.m1.1.1.1.1.1.1.3.cmml\">i</mi></msub><mo id=\"S4.F2.7.m1.2.2.2.2.2.4\" xref=\"S4.F2.7.m1.2.2.2.2.3.cmml\">,</mo><msub id=\"S4.F2.7.m1.2.2.2.2.2.2\" xref=\"S4.F2.7.m1.2.2.2.2.2.2.cmml\"><mi id=\"S4.F2.7.m1.2.2.2.2.2.2.2\" xref=\"S4.F2.7.m1.2.2.2.2.2.2.2.cmml\">V</mi><mi id=\"S4.F2.7.m1.2.2.2.2.2.2.3\" xref=\"S4.F2.7.m1.2.2.2.2.2.2.3.cmml\">i</mi></msub><mo id=\"S4.F2.7.m1.2.2.2.2.2.5\" stretchy=\"false\" xref=\"S4.F2.7.m1.2.2.2.2.3.cmml\">}</mo></mrow><mrow id=\"S4.F2.7.m1.2.2.2.4\" xref=\"S4.F2.7.m1.2.2.2.4.cmml\"><mi id=\"S4.F2.7.m1.2.2.2.4.2\" xref=\"S4.F2.7.m1.2.2.2.4.2.cmml\">i</mi><mo id=\"S4.F2.7.m1.2.2.2.4.1\" xref=\"S4.F2.7.m1.2.2.2.4.1.cmml\">=</mo><mn id=\"S4.F2.7.m1.2.2.2.4.3\" xref=\"S4.F2.7.m1.2.2.2.4.3.cmml\">1</mn></mrow><mi id=\"S4.F2.7.m1.2.2.4\" xref=\"S4.F2.7.m1.2.2.4.cmml\">k</mi></msubsup><annotation-xml encoding=\"MathML-Content\" id=\"S4.F2.7.m1.2c\"><apply id=\"S4.F2.7.m1.2.2.cmml\" xref=\"S4.F2.7.m1.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.7.m1.2.2.3.cmml\" xref=\"S4.F2.7.m1.2.2\">superscript</csymbol><apply id=\"S4.F2.7.m1.2.2.2.cmml\" xref=\"S4.F2.7.m1.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.7.m1.2.2.2.3.cmml\" xref=\"S4.F2.7.m1.2.2\">subscript</csymbol><set id=\"S4.F2.7.m1.2.2.2.2.3.cmml\" xref=\"S4.F2.7.m1.2.2.2.2.2\"><apply id=\"S4.F2.7.m1.1.1.1.1.1.1.cmml\" xref=\"S4.F2.7.m1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.7.m1.1.1.1.1.1.1.1.cmml\" xref=\"S4.F2.7.m1.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S4.F2.7.m1.1.1.1.1.1.1.2.cmml\" xref=\"S4.F2.7.m1.1.1.1.1.1.1.2\">𝐾</ci><ci id=\"S4.F2.7.m1.1.1.1.1.1.1.3.cmml\" xref=\"S4.F2.7.m1.1.1.1.1.1.1.3\">𝑖</ci></apply><apply id=\"S4.F2.7.m1.2.2.2.2.2.2.cmml\" xref=\"S4.F2.7.m1.2.2.2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.7.m1.2.2.2.2.2.2.1.cmml\" xref=\"S4.F2.7.m1.2.2.2.2.2.2\">subscript</csymbol><ci id=\"S4.F2.7.m1.2.2.2.2.2.2.2.cmml\" xref=\"S4.F2.7.m1.2.2.2.2.2.2.2\">𝑉</ci><ci id=\"S4.F2.7.m1.2.2.2.2.2.2.3.cmml\" xref=\"S4.F2.7.m1.2.2.2.2.2.2.3\">𝑖</ci></apply></set><apply id=\"S4.F2.7.m1.2.2.2.4.cmml\" xref=\"S4.F2.7.m1.2.2.2.4\"><eq id=\"S4.F2.7.m1.2.2.2.4.1.cmml\" xref=\"S4.F2.7.m1.2.2.2.4.1\"></eq><ci id=\"S4.F2.7.m1.2.2.2.4.2.cmml\" xref=\"S4.F2.7.m1.2.2.2.4.2\">𝑖</ci><cn id=\"S4.F2.7.m1.2.2.2.4.3.cmml\" type=\"integer\" xref=\"S4.F2.7.m1.2.2.2.4.3\">1</cn></apply></apply><ci id=\"S4.F2.7.m1.2.2.4.cmml\" xref=\"S4.F2.7.m1.2.2.4\">𝑘</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.F2.7.m1.2d\">\\{K_{i},V_{i}\\}_{i=1}^{k}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.F2.7.m1.2e\">{ italic_K start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> from demonstration pairs <math alttext=\"\\{(x_{i},y_{i})\\}_{i=1}^{k}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.F2.8.m2.1\"><semantics id=\"S4.F2.8.m2.1b\"><msubsup id=\"S4.F2.8.m2.1.1\" xref=\"S4.F2.8.m2.1.1.cmml\"><mrow id=\"S4.F2.8.m2.1.1.1.1.1\" xref=\"S4.F2.8.m2.1.1.1.1.2.cmml\"><mo id=\"S4.F2.8.m2.1.1.1.1.1.2\" stretchy=\"false\" xref=\"S4.F2.8.m2.1.1.1.1.2.cmml\">{</mo><mrow id=\"S4.F2.8.m2.1.1.1.1.1.1.2\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.3.cmml\"><mo id=\"S4.F2.8.m2.1.1.1.1.1.1.2.3\" stretchy=\"false\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.3.cmml\">(</mo><msub id=\"S4.F2.8.m2.1.1.1.1.1.1.1.1\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.cmml\"><mi id=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.2\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.2.cmml\">x</mi><mi id=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.3\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.3.cmml\">i</mi></msub><mo id=\"S4.F2.8.m2.1.1.1.1.1.1.2.4\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.3.cmml\">,</mo><msub id=\"S4.F2.8.m2.1.1.1.1.1.1.2.2\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.cmml\"><mi id=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.2\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.2.cmml\">y</mi><mi id=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.3\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.3.cmml\">i</mi></msub><mo id=\"S4.F2.8.m2.1.1.1.1.1.1.2.5\" stretchy=\"false\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.3.cmml\">)</mo></mrow><mo id=\"S4.F2.8.m2.1.1.1.1.1.3\" stretchy=\"false\" xref=\"S4.F2.8.m2.1.1.1.1.2.cmml\">}</mo></mrow><mrow id=\"S4.F2.8.m2.1.1.1.3\" xref=\"S4.F2.8.m2.1.1.1.3.cmml\"><mi id=\"S4.F2.8.m2.1.1.1.3.2\" xref=\"S4.F2.8.m2.1.1.1.3.2.cmml\">i</mi><mo id=\"S4.F2.8.m2.1.1.1.3.1\" xref=\"S4.F2.8.m2.1.1.1.3.1.cmml\">=</mo><mn id=\"S4.F2.8.m2.1.1.1.3.3\" xref=\"S4.F2.8.m2.1.1.1.3.3.cmml\">1</mn></mrow><mi id=\"S4.F2.8.m2.1.1.3\" xref=\"S4.F2.8.m2.1.1.3.cmml\">k</mi></msubsup><annotation-xml encoding=\"MathML-Content\" id=\"S4.F2.8.m2.1c\"><apply id=\"S4.F2.8.m2.1.1.cmml\" xref=\"S4.F2.8.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.8.m2.1.1.2.cmml\" xref=\"S4.F2.8.m2.1.1\">superscript</csymbol><apply id=\"S4.F2.8.m2.1.1.1.cmml\" xref=\"S4.F2.8.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.8.m2.1.1.1.2.cmml\" xref=\"S4.F2.8.m2.1.1\">subscript</csymbol><set id=\"S4.F2.8.m2.1.1.1.1.2.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1\"><interval closure=\"open\" id=\"S4.F2.8.m2.1.1.1.1.1.1.3.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2\"><apply id=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.1.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.2.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.2\">𝑥</ci><ci id=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.3.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.1.1.3\">𝑖</ci></apply><apply id=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.1.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2.2\">subscript</csymbol><ci id=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.2.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.2\">𝑦</ci><ci id=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.3.cmml\" xref=\"S4.F2.8.m2.1.1.1.1.1.1.2.2.3\">𝑖</ci></apply></interval></set><apply id=\"S4.F2.8.m2.1.1.1.3.cmml\" xref=\"S4.F2.8.m2.1.1.1.3\"><eq id=\"S4.F2.8.m2.1.1.1.3.1.cmml\" xref=\"S4.F2.8.m2.1.1.1.3.1\"></eq><ci id=\"S4.F2.8.m2.1.1.1.3.2.cmml\" xref=\"S4.F2.8.m2.1.1.1.3.2\">𝑖</ci><cn id=\"S4.F2.8.m2.1.1.1.3.3.cmml\" type=\"integer\" xref=\"S4.F2.8.m2.1.1.1.3.3\">1</cn></apply></apply><ci id=\"S4.F2.8.m2.1.1.3.cmml\" xref=\"S4.F2.8.m2.1.1.3\">𝑘</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.F2.8.m2.1d\">\\{(x_{i},y_{i})\\}_{i=1}^{k}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.F2.8.m2.1e\">{ ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, then trains it to solve each pair. To prevent the model from simply retrieving the demonstration pair from the prefix, Leave-One-Out Masking prevents the model from attending to <math alttext=\"K_{i},V_{i}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.F2.9.m3.2\"><semantics id=\"S4.F2.9.m3.2b\"><mrow id=\"S4.F2.9.m3.2.2.2\" xref=\"S4.F2.9.m3.2.2.3.cmml\"><msub id=\"S4.F2.9.m3.1.1.1.1\" xref=\"S4.F2.9.m3.1.1.1.1.cmml\"><mi id=\"S4.F2.9.m3.1.1.1.1.2\" xref=\"S4.F2.9.m3.1.1.1.1.2.cmml\">K</mi><mi id=\"S4.F2.9.m3.1.1.1.1.3\" xref=\"S4.F2.9.m3.1.1.1.1.3.cmml\">i</mi></msub><mo id=\"S4.F2.9.m3.2.2.2.3\" xref=\"S4.F2.9.m3.2.2.3.cmml\">,</mo><msub id=\"S4.F2.9.m3.2.2.2.2\" xref=\"S4.F2.9.m3.2.2.2.2.cmml\"><mi id=\"S4.F2.9.m3.2.2.2.2.2\" xref=\"S4.F2.9.m3.2.2.2.2.2.cmml\">V</mi><mi id=\"S4.F2.9.m3.2.2.2.2.3\" xref=\"S4.F2.9.m3.2.2.2.2.3.cmml\">i</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.F2.9.m3.2c\"><list id=\"S4.F2.9.m3.2.2.3.cmml\" xref=\"S4.F2.9.m3.2.2.2\"><apply id=\"S4.F2.9.m3.1.1.1.1.cmml\" xref=\"S4.F2.9.m3.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.9.m3.1.1.1.1.1.cmml\" xref=\"S4.F2.9.m3.1.1.1.1\">subscript</csymbol><ci id=\"S4.F2.9.m3.1.1.1.1.2.cmml\" xref=\"S4.F2.9.m3.1.1.1.1.2\">𝐾</ci><ci id=\"S4.F2.9.m3.1.1.1.1.3.cmml\" xref=\"S4.F2.9.m3.1.1.1.1.3\">𝑖</ci></apply><apply id=\"S4.F2.9.m3.2.2.2.2.cmml\" xref=\"S4.F2.9.m3.2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.9.m3.2.2.2.2.1.cmml\" xref=\"S4.F2.9.m3.2.2.2.2\">subscript</csymbol><ci id=\"S4.F2.9.m3.2.2.2.2.2.cmml\" xref=\"S4.F2.9.m3.2.2.2.2.2\">𝑉</ci><ci id=\"S4.F2.9.m3.2.2.2.2.3.cmml\" xref=\"S4.F2.9.m3.2.2.2.2.3\">𝑖</ci></apply></list></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.F2.9.m3.2d\">K_{i},V_{i}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.F2.9.m3.2e\">italic_K start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> when solving pair <math alttext=\"i\" class=\"ltx_Math\" display=\"inline\" id=\"S4.F2.10.m4.1\"><semantics id=\"S4.F2.10.m4.1b\"><mi id=\"S4.F2.10.m4.1.1\" xref=\"S4.F2.10.m4.1.1.cmml\">i</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.F2.10.m4.1c\"><ci id=\"S4.F2.10.m4.1.1.cmml\" xref=\"S4.F2.10.m4.1.1\">𝑖</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.F2.10.m4.1d\">i</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.F2.10.m4.1e\">italic_i</annotation></semantics></math>. At generation time (right), the model conditions on all optimized prefixes <math alttext=\"\\{K_{i}^{*},V_{i}^{*}\\}_{i=1}^{k}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.F2.11.m5.2\"><semantics id=\"S4.F2.11.m5.2b\"><msubsup id=\"S4.F2.11.m5.2.2\" xref=\"S4.F2.11.m5.2.2.cmml\"><mrow id=\"S4.F2.11.m5.2.2.2.2.2\" xref=\"S4.F2.11.m5.2.2.2.2.3.cmml\"><mo id=\"S4.F2.11.m5.2.2.2.2.2.3\" stretchy=\"false\" xref=\"S4.F2.11.m5.2.2.2.2.3.cmml\">{</mo><msubsup id=\"S4.F2.11.m5.1.1.1.1.1.1\" xref=\"S4.F2.11.m5.1.1.1.1.1.1.cmml\"><mi id=\"S4.F2.11.m5.1.1.1.1.1.1.2.2\" xref=\"S4.F2.11.m5.1.1.1.1.1.1.2.2.cmml\">K</mi><mi id=\"S4.F2.11.m5.1.1.1.1.1.1.2.3\" xref=\"S4.F2.11.m5.1.1.1.1.1.1.2.3.cmml\">i</mi><mo id=\"S4.F2.11.m5.1.1.1.1.1.1.3\" xref=\"S4.F2.11.m5.1.1.1.1.1.1.3.cmml\">∗</mo></msubsup><mo id=\"S4.F2.11.m5.2.2.2.2.2.4\" xref=\"S4.F2.11.m5.2.2.2.2.3.cmml\">,</mo><msubsup id=\"S4.F2.11.m5.2.2.2.2.2.2\" xref=\"S4.F2.11.m5.2.2.2.2.2.2.cmml\"><mi id=\"S4.F2.11.m5.2.2.2.2.2.2.2.2\" xref=\"S4.F2.11.m5.2.2.2.2.2.2.2.2.cmml\">V</mi><mi id=\"S4.F2.11.m5.2.2.2.2.2.2.2.3\" xref=\"S4.F2.11.m5.2.2.2.2.2.2.2.3.cmml\">i</mi><mo id=\"S4.F2.11.m5.2.2.2.2.2.2.3\" xref=\"S4.F2.11.m5.2.2.2.2.2.2.3.cmml\">∗</mo></msubsup><mo id=\"S4.F2.11.m5.2.2.2.2.2.5\" stretchy=\"false\" xref=\"S4.F2.11.m5.2.2.2.2.3.cmml\">}</mo></mrow><mrow id=\"S4.F2.11.m5.2.2.2.4\" xref=\"S4.F2.11.m5.2.2.2.4.cmml\"><mi id=\"S4.F2.11.m5.2.2.2.4.2\" xref=\"S4.F2.11.m5.2.2.2.4.2.cmml\">i</mi><mo id=\"S4.F2.11.m5.2.2.2.4.1\" xref=\"S4.F2.11.m5.2.2.2.4.1.cmml\">=</mo><mn id=\"S4.F2.11.m5.2.2.2.4.3\" xref=\"S4.F2.11.m5.2.2.2.4.3.cmml\">1</mn></mrow><mi id=\"S4.F2.11.m5.2.2.4\" xref=\"S4.F2.11.m5.2.2.4.cmml\">k</mi></msubsup><annotation-xml encoding=\"MathML-Content\" id=\"S4.F2.11.m5.2c\"><apply id=\"S4.F2.11.m5.2.2.cmml\" xref=\"S4.F2.11.m5.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.11.m5.2.2.3.cmml\" xref=\"S4.F2.11.m5.2.2\">superscript</csymbol><apply id=\"S4.F2.11.m5.2.2.2.cmml\" xref=\"S4.F2.11.m5.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.11.m5.2.2.2.3.cmml\" xref=\"S4.F2.11.m5.2.2\">subscript</csymbol><set id=\"S4.F2.11.m5.2.2.2.2.3.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2\"><apply id=\"S4.F2.11.m5.1.1.1.1.1.1.cmml\" xref=\"S4.F2.11.m5.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.11.m5.1.1.1.1.1.1.1.cmml\" xref=\"S4.F2.11.m5.1.1.1.1.1.1\">superscript</csymbol><apply id=\"S4.F2.11.m5.1.1.1.1.1.1.2.cmml\" xref=\"S4.F2.11.m5.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.11.m5.1.1.1.1.1.1.2.1.cmml\" xref=\"S4.F2.11.m5.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S4.F2.11.m5.1.1.1.1.1.1.2.2.cmml\" xref=\"S4.F2.11.m5.1.1.1.1.1.1.2.2\">𝐾</ci><ci id=\"S4.F2.11.m5.1.1.1.1.1.1.2.3.cmml\" xref=\"S4.F2.11.m5.1.1.1.1.1.1.2.3\">𝑖</ci></apply><times id=\"S4.F2.11.m5.1.1.1.1.1.1.3.cmml\" xref=\"S4.F2.11.m5.1.1.1.1.1.1.3\"></times></apply><apply id=\"S4.F2.11.m5.2.2.2.2.2.2.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.11.m5.2.2.2.2.2.2.1.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2.2\">superscript</csymbol><apply id=\"S4.F2.11.m5.2.2.2.2.2.2.2.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.F2.11.m5.2.2.2.2.2.2.2.1.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2.2\">subscript</csymbol><ci id=\"S4.F2.11.m5.2.2.2.2.2.2.2.2.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2.2.2.2\">𝑉</ci><ci id=\"S4.F2.11.m5.2.2.2.2.2.2.2.3.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2.2.2.3\">𝑖</ci></apply><times id=\"S4.F2.11.m5.2.2.2.2.2.2.3.cmml\" xref=\"S4.F2.11.m5.2.2.2.2.2.2.3\"></times></apply></set><apply id=\"S4.F2.11.m5.2.2.2.4.cmml\" xref=\"S4.F2.11.m5.2.2.2.4\"><eq id=\"S4.F2.11.m5.2.2.2.4.1.cmml\" xref=\"S4.F2.11.m5.2.2.2.4.1\"></eq><ci id=\"S4.F2.11.m5.2.2.2.4.2.cmml\" xref=\"S4.F2.11.m5.2.2.2.4.2\">𝑖</ci><cn id=\"S4.F2.11.m5.2.2.2.4.3.cmml\" type=\"integer\" xref=\"S4.F2.11.m5.2.2.2.4.3\">1</cn></apply></apply><ci id=\"S4.F2.11.m5.2.2.4.cmml\" xref=\"S4.F2.11.m5.2.2.4\">𝑘</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.F2.11.m5.2d\">\\{K_{i}^{*},V_{i}^{*}\\}_{i=1}^{k}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.F2.11.m5.2e\">{ italic_K start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> to solve query <math alttext=\"x_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.F2.12.m6.1\"><semantics id=\"S4.F2.12.m6.1b\"><msub id=\"S4.F2.12.m6.1.1\" xref=\"S4.F2.12.m6.1.1.cmml\"><mi id=\"S4.F2.12.m6.1.1.2\" xref=\"S4.F2.12.m6.1.1.2.cmml\">x</mi><mi id=\"S4.F2.12.m6.1.1.3\" xref=\"S4.F2.12.m6.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.F2.12.m6.1c\"><apply id=\"S4.F2.12.m6.1.1.cmml\" xref=\"S4.F2.12.m6.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.F2.12.m6.1.1.1.cmml\" xref=\"S4.F2.12.m6.1.1\">subscript</csymbol><ci id=\"S4.F2.12.m6.1.1.2.cmml\" xref=\"S4.F2.12.m6.1.1.2\">𝑥</ci><ci id=\"S4.F2.12.m6.1.1.3.cmml\" xref=\"S4.F2.12.m6.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.F2.12.m6.1d\">x_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.F2.12.m6.1e\">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>.\n</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"S4.p1\">\n<p class=\"ltx_p\" id=\"S4.p1.1\">In this section, we introduce the mathematical formulation of <span class=\"ltx_text ltx_font_italic\" id=\"S4.p1.1.1\">In-Context Optimization</span> (<span class=\"ltx_text ltx_font_italic\" id=\"S4.p1.1.2\">ICO</span>), a few-shot adaptation scheme that uses demonstrations in the context and performs gradient-based optimization on either the model parameters or a context representation. We then show that Test-Time Training (TTT) <cite class=\"ltx_cite ltx_citemacro_citep\">(Akyürek et al., <a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite> is an instance of <span class=\"ltx_text ltx_font_italic\" id=\"S4.p1.1.3\">ICO</span>. Finally, we present Context Tuning, formalizing its <span class=\"ltx_text ltx_font_italic\" id=\"S4.p1.1.4\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S4.p1.1.5\">CT-KV</span> variants along with the two additional design choices that drive their strong performance.</p>\n</div>\n<section class=\"ltx_subsection\" id=\"S4.SS1\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">4.1 </span>In-Context Optimization</h3>\n<div class=\"ltx_para\" id=\"S4.SS1.p1\">\n<p class=\"ltx_p\" id=\"S4.SS1.p1.4\">To combine the strengths of supervised fine-tuning and LLMs’ inherent ability to learn from context, <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS1.p1.4.1\">ICO</span> unifies two prevalent techniques for few-shot learning: ICL and gradient-based optimization. Formally, the objective of <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS1.p1.4.2\">ICO</span> to minimize the loss</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S4.E3\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\sum_{i=1}^{k}-\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,\\theta_{\\mathrm{context}}^{(%\ni)}\\,;x_{i}\\,]\\right),\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S4.E3.m1.1\"><semantics id=\"S4.E3.m1.1a\"><mrow id=\"S4.E3.m1.1b\"><munderover id=\"S4.E3.m1.1.2\"><mo id=\"S4.E3.m1.1.2.2.2\" movablelimits=\"false\">∑</mo><mrow id=\"S4.E3.m1.1.2.2.3\"><mi id=\"S4.E3.m1.1.2.2.3.2\">i</mi><mo id=\"S4.E3.m1.1.2.2.3.1\">=</mo><mn id=\"S4.E3.m1.1.2.2.3.3\">1</mn></mrow><mi id=\"S4.E3.m1.1.2.3\">k</mi></munderover><mo id=\"S4.E3.m1.1.3\" lspace=\"0em\">−</mo><mi id=\"S4.E3.m1.1.4\">log</mi><msub id=\"S4.E3.m1.1.5\"><mi id=\"S4.E3.m1.1.5.2\">p</mi><mi id=\"S4.E3.m1.1.5.3\">ϕ</mi></msub><mrow id=\"S4.E3.m1.1.6\"><mo id=\"S4.E3.m1.1.6.1\">(</mo><msub id=\"S4.E3.m1.1.6.2\"><mi id=\"S4.E3.m1.1.6.2.2\">y</mi><mi id=\"S4.E3.m1.1.6.2.3\">i</mi></msub><mo id=\"S4.E3.m1.1.6.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S4.E3.m1.1.6.4\"><mo id=\"S4.E3.m1.1.6.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><msubsup id=\"S4.E3.m1.1.6.4.2\"><mi id=\"S4.E3.m1.1.6.4.2.2.2\">θ</mi><mi id=\"S4.E3.m1.1.6.4.2.2.3\">context</mi><mrow id=\"S4.E3.m1.1.1.1.3\"><mo id=\"S4.E3.m1.1.1.1.3.1\" stretchy=\"false\">(</mo><mi id=\"S4.E3.m1.1.1.1.1\">i</mi><mo id=\"S4.E3.m1.1.1.1.3.2\" stretchy=\"false\">)</mo></mrow></msubsup><mo id=\"S4.E3.m1.1.6.4.3\">;</mo><msub id=\"S4.E3.m1.1.6.4.4\"><mi id=\"S4.E3.m1.1.6.4.4.2\">x</mi><mi id=\"S4.E3.m1.1.6.4.4.3\">i</mi></msub><mo id=\"S4.E3.m1.1.6.4.5\" stretchy=\"false\">]</mo></mrow><mo id=\"S4.E3.m1.1.6.5\">)</mo></mrow><mo id=\"S4.E3.m1.1.7\">,</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S4.E3.m1.1c\">\\sum_{i=1}^{k}-\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,\\theta_{\\mathrm{context}}^{(%\ni)}\\,;x_{i}\\,]\\right),</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.E3.m1.1d\">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - roman_log italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | [ italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ; italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) ,</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n<td class=\"ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right\" rowspan=\"1\"><span class=\"ltx_tag ltx_tag_equation ltx_align_right\">(3)</span></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S4.SS1.p1.3\">where <math alttext=\"\\theta_{\\mathrm{context}}^{(i)}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS1.p1.1.m1.1\"><semantics id=\"S4.SS1.p1.1.m1.1a\"><msubsup id=\"S4.SS1.p1.1.m1.1.2\" xref=\"S4.SS1.p1.1.m1.1.2.cmml\"><mi id=\"S4.SS1.p1.1.m1.1.2.2.2\" xref=\"S4.SS1.p1.1.m1.1.2.2.2.cmml\">θ</mi><mi id=\"S4.SS1.p1.1.m1.1.2.2.3\" xref=\"S4.SS1.p1.1.m1.1.2.2.3.cmml\">context</mi><mrow id=\"S4.SS1.p1.1.m1.1.1.1.3\" xref=\"S4.SS1.p1.1.m1.1.2.cmml\"><mo id=\"S4.SS1.p1.1.m1.1.1.1.3.1\" stretchy=\"false\" xref=\"S4.SS1.p1.1.m1.1.2.cmml\">(</mo><mi id=\"S4.SS1.p1.1.m1.1.1.1.1\" xref=\"S4.SS1.p1.1.m1.1.1.1.1.cmml\">i</mi><mo id=\"S4.SS1.p1.1.m1.1.1.1.3.2\" stretchy=\"false\" xref=\"S4.SS1.p1.1.m1.1.2.cmml\">)</mo></mrow></msubsup><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS1.p1.1.m1.1b\"><apply id=\"S4.SS1.p1.1.m1.1.2.cmml\" xref=\"S4.SS1.p1.1.m1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.SS1.p1.1.m1.1.2.1.cmml\" xref=\"S4.SS1.p1.1.m1.1.2\">superscript</csymbol><apply id=\"S4.SS1.p1.1.m1.1.2.2.cmml\" xref=\"S4.SS1.p1.1.m1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.SS1.p1.1.m1.1.2.2.1.cmml\" xref=\"S4.SS1.p1.1.m1.1.2\">subscript</csymbol><ci id=\"S4.SS1.p1.1.m1.1.2.2.2.cmml\" xref=\"S4.SS1.p1.1.m1.1.2.2.2\">𝜃</ci><ci id=\"S4.SS1.p1.1.m1.1.2.2.3.cmml\" xref=\"S4.SS1.p1.1.m1.1.2.2.3\">context</ci></apply><ci id=\"S4.SS1.p1.1.m1.1.1.1.1.cmml\" xref=\"S4.SS1.p1.1.m1.1.1.1.1\">𝑖</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS1.p1.1.m1.1c\">\\theta_{\\mathrm{context}}^{(i)}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS1.p1.1.m1.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is a context representation derived from the set of demonstration pairs <math alttext=\"\\mathcal{D}=\\{(x_{i},y_{i})\\}_{i=1}^{k}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS1.p1.2.m2.1\"><semantics id=\"S4.SS1.p1.2.m2.1a\"><mrow id=\"S4.SS1.p1.2.m2.1.1\" xref=\"S4.SS1.p1.2.m2.1.1.cmml\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.SS1.p1.2.m2.1.1.3\" xref=\"S4.SS1.p1.2.m2.1.1.3.cmml\">𝒟</mi><mo id=\"S4.SS1.p1.2.m2.1.1.2\" xref=\"S4.SS1.p1.2.m2.1.1.2.cmml\">=</mo><msubsup id=\"S4.SS1.p1.2.m2.1.1.1\" xref=\"S4.SS1.p1.2.m2.1.1.1.cmml\"><mrow id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml\"><mo id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml\">{</mo><mrow id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml\"><mo id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.3\" stretchy=\"false\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml\">(</mo><msub id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.cmml\">x</mi><mi id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml\">i</mi></msub><mo id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.4\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml\">,</mo><msub id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml\"><mi id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.cmml\">y</mi><mi id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml\">i</mi></msub><mo id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.5\" stretchy=\"false\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml\">)</mo></mrow><mo id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml\">}</mo></mrow><mrow id=\"S4.SS1.p1.2.m2.1.1.1.1.3\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3.cmml\"><mi id=\"S4.SS1.p1.2.m2.1.1.1.1.3.2\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3.2.cmml\">i</mi><mo id=\"S4.SS1.p1.2.m2.1.1.1.1.3.1\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3.1.cmml\">=</mo><mn id=\"S4.SS1.p1.2.m2.1.1.1.1.3.3\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3.3.cmml\">1</mn></mrow><mi id=\"S4.SS1.p1.2.m2.1.1.1.3\" xref=\"S4.SS1.p1.2.m2.1.1.1.3.cmml\">k</mi></msubsup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS1.p1.2.m2.1b\"><apply id=\"S4.SS1.p1.2.m2.1.1.cmml\" xref=\"S4.SS1.p1.2.m2.1.1\"><eq id=\"S4.SS1.p1.2.m2.1.1.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.2\"></eq><ci id=\"S4.SS1.p1.2.m2.1.1.3.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.3\">𝒟</ci><apply id=\"S4.SS1.p1.2.m2.1.1.1.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS1.p1.2.m2.1.1.1.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1\">superscript</csymbol><apply id=\"S4.SS1.p1.2.m2.1.1.1.1.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS1.p1.2.m2.1.1.1.1.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1\">subscript</csymbol><set id=\"S4.SS1.p1.2.m2.1.1.1.1.1.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1\"><interval closure=\"open\" id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2\"><apply id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2\">𝑥</ci><ci id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3\">𝑖</ci></apply><apply id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.1.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2\">subscript</csymbol><ci id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2\">𝑦</ci><ci id=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3\">𝑖</ci></apply></interval></set><apply id=\"S4.SS1.p1.2.m2.1.1.1.1.3.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3\"><eq id=\"S4.SS1.p1.2.m2.1.1.1.1.3.1.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3.1\"></eq><ci id=\"S4.SS1.p1.2.m2.1.1.1.1.3.2.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3.2\">𝑖</ci><cn id=\"S4.SS1.p1.2.m2.1.1.1.1.3.3.cmml\" type=\"integer\" xref=\"S4.SS1.p1.2.m2.1.1.1.1.3.3\">1</cn></apply></apply><ci id=\"S4.SS1.p1.2.m2.1.1.1.3.cmml\" xref=\"S4.SS1.p1.2.m2.1.1.1.3\">𝑘</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS1.p1.2.m2.1c\">\\mathcal{D}=\\{(x_{i},y_{i})\\}_{i=1}^{k}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS1.p1.2.m2.1d\">caligraphic_D = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>. One may notice that this objective resembles Equations <a class=\"ltx_ref\" href=\"#S3.E1\" title=\"Equation 1 ‣ Prompt Tuning. ‣ 3 Background ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a> and <a class=\"ltx_ref\" href=\"#S3.E2\" title=\"Equation 2 ‣ Prefix Tuning. ‣ 3 Background ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">2</span></a> because traditional prompt-based adaptation methods also prepend additional contexts to inputs during optimization. Still, these contexts are randomly initialized instead of utilizing the demonstration pairs <math alttext=\"\\mathcal{D}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS1.p1.3.m3.1\"><semantics id=\"S4.SS1.p1.3.m3.1a\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.SS1.p1.3.m3.1.1\" xref=\"S4.SS1.p1.3.m3.1.1.cmml\">𝒟</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS1.p1.3.m3.1b\"><ci id=\"S4.SS1.p1.3.m3.1.1.cmml\" xref=\"S4.SS1.p1.3.m3.1.1\">𝒟</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS1.p1.3.m3.1c\">\\mathcal{D}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS1.p1.3.m3.1d\">caligraphic_D</annotation></semantics></math>. Therefore, Prompt Tuning and Prefix Tuning are not instances of <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS1.p1.3.1\">ICO</span> by definition. Furthermore, since ICL does not perform gradient-based optimization at all, it also does not fall under <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS1.p1.3.2\">ICO</span>.</p>\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S4.SS2\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">4.2 </span>Test-Time Training as ICO</h3>\n<div class=\"ltx_para\" id=\"S4.SS2.p1\">\n<p class=\"ltx_p\" id=\"S4.SS2.p1.1\">TTT <cite class=\"ltx_cite ltx_citemacro_citep\">(Akyürek et al., <a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite> can be viewed as an instance of <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS2.p1.1.1\">ICO</span>. Specifically, TTT minimizes Equation <a class=\"ltx_ref\" href=\"#S4.E3\" title=\"Equation 3 ‣ 4.1 In-Context Optimization ‣ 4 Context Tuning for In-Context Optimization ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">3</span></a> by first initializing the model weights <math alttext=\"\\phi\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS2.p1.1.m1.1\"><semantics id=\"S4.SS2.p1.1.m1.1a\"><mi id=\"S4.SS2.p1.1.m1.1.1\" xref=\"S4.SS2.p1.1.m1.1.1.cmml\">ϕ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS2.p1.1.m1.1b\"><ci id=\"S4.SS2.p1.1.m1.1.1.cmml\" xref=\"S4.SS2.p1.1.m1.1.1\">italic-ϕ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS2.p1.1.m1.1c\">\\phi</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS2.p1.1.m1.1d\">italic_ϕ</annotation></semantics></math> from a pretrained model, then updating them with LoRA layers for parameter efficiency. At each optimization iteration, TTT dynamically sets</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S4.Ex5\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\theta_{\\mathrm{context}}^{(i)}=\\mathcal{C}^{-i},\" class=\"ltx_Math\" display=\"block\" id=\"S4.Ex5.m1.2\"><semantics id=\"S4.Ex5.m1.2a\"><mrow id=\"S4.Ex5.m1.2.2.1\" xref=\"S4.Ex5.m1.2.2.1.1.cmml\"><mrow id=\"S4.Ex5.m1.2.2.1.1\" xref=\"S4.Ex5.m1.2.2.1.1.cmml\"><msubsup id=\"S4.Ex5.m1.2.2.1.1.2\" xref=\"S4.Ex5.m1.2.2.1.1.2.cmml\"><mi id=\"S4.Ex5.m1.2.2.1.1.2.2.2\" xref=\"S4.Ex5.m1.2.2.1.1.2.2.2.cmml\">θ</mi><mi id=\"S4.Ex5.m1.2.2.1.1.2.2.3\" xref=\"S4.Ex5.m1.2.2.1.1.2.2.3.cmml\">context</mi><mrow id=\"S4.Ex5.m1.1.1.1.3\" xref=\"S4.Ex5.m1.2.2.1.1.2.cmml\"><mo id=\"S4.Ex5.m1.1.1.1.3.1\" stretchy=\"false\" xref=\"S4.Ex5.m1.2.2.1.1.2.cmml\">(</mo><mi id=\"S4.Ex5.m1.1.1.1.1\" xref=\"S4.Ex5.m1.1.1.1.1.cmml\">i</mi><mo id=\"S4.Ex5.m1.1.1.1.3.2\" stretchy=\"false\" xref=\"S4.Ex5.m1.2.2.1.1.2.cmml\">)</mo></mrow></msubsup><mo id=\"S4.Ex5.m1.2.2.1.1.1\" xref=\"S4.Ex5.m1.2.2.1.1.1.cmml\">=</mo><msup id=\"S4.Ex5.m1.2.2.1.1.3\" xref=\"S4.Ex5.m1.2.2.1.1.3.cmml\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.Ex5.m1.2.2.1.1.3.2\" xref=\"S4.Ex5.m1.2.2.1.1.3.2.cmml\">𝒞</mi><mrow id=\"S4.Ex5.m1.2.2.1.1.3.3\" xref=\"S4.Ex5.m1.2.2.1.1.3.3.cmml\"><mo id=\"S4.Ex5.m1.2.2.1.1.3.3a\" xref=\"S4.Ex5.m1.2.2.1.1.3.3.cmml\">−</mo><mi id=\"S4.Ex5.m1.2.2.1.1.3.3.2\" xref=\"S4.Ex5.m1.2.2.1.1.3.3.2.cmml\">i</mi></mrow></msup></mrow><mo id=\"S4.Ex5.m1.2.2.1.2\" xref=\"S4.Ex5.m1.2.2.1.1.cmml\">,</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.Ex5.m1.2b\"><apply id=\"S4.Ex5.m1.2.2.1.1.cmml\" xref=\"S4.Ex5.m1.2.2.1\"><eq id=\"S4.Ex5.m1.2.2.1.1.1.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.1\"></eq><apply id=\"S4.Ex5.m1.2.2.1.1.2.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.Ex5.m1.2.2.1.1.2.1.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.2\">superscript</csymbol><apply id=\"S4.Ex5.m1.2.2.1.1.2.2.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.Ex5.m1.2.2.1.1.2.2.1.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.2\">subscript</csymbol><ci id=\"S4.Ex5.m1.2.2.1.1.2.2.2.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.2.2.2\">𝜃</ci><ci id=\"S4.Ex5.m1.2.2.1.1.2.2.3.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.2.2.3\">context</ci></apply><ci id=\"S4.Ex5.m1.1.1.1.1.cmml\" xref=\"S4.Ex5.m1.1.1.1.1\">𝑖</ci></apply><apply id=\"S4.Ex5.m1.2.2.1.1.3.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.3\"><csymbol cd=\"ambiguous\" id=\"S4.Ex5.m1.2.2.1.1.3.1.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.3\">superscript</csymbol><ci id=\"S4.Ex5.m1.2.2.1.1.3.2.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.3.2\">𝒞</ci><apply id=\"S4.Ex5.m1.2.2.1.1.3.3.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.3.3\"><minus id=\"S4.Ex5.m1.2.2.1.1.3.3.1.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.3.3\"></minus><ci id=\"S4.Ex5.m1.2.2.1.1.3.3.2.cmml\" xref=\"S4.Ex5.m1.2.2.1.1.3.3.2\">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.Ex5.m1.2c\">\\theta_{\\mathrm{context}}^{(i)}=\\mathcal{C}^{-i},</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.Ex5.m1.2d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = caligraphic_C start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S4.SS2.p1.3\">where <math alttext=\"\\mathcal{C}^{-i}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS2.p1.2.m1.1\"><semantics id=\"S4.SS2.p1.2.m1.1a\"><msup id=\"S4.SS2.p1.2.m1.1.1\" xref=\"S4.SS2.p1.2.m1.1.1.cmml\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.SS2.p1.2.m1.1.1.2\" xref=\"S4.SS2.p1.2.m1.1.1.2.cmml\">𝒞</mi><mrow id=\"S4.SS2.p1.2.m1.1.1.3\" xref=\"S4.SS2.p1.2.m1.1.1.3.cmml\"><mo id=\"S4.SS2.p1.2.m1.1.1.3a\" xref=\"S4.SS2.p1.2.m1.1.1.3.cmml\">−</mo><mi id=\"S4.SS2.p1.2.m1.1.1.3.2\" xref=\"S4.SS2.p1.2.m1.1.1.3.2.cmml\">i</mi></mrow></msup><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS2.p1.2.m1.1b\"><apply id=\"S4.SS2.p1.2.m1.1.1.cmml\" xref=\"S4.SS2.p1.2.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS2.p1.2.m1.1.1.1.cmml\" xref=\"S4.SS2.p1.2.m1.1.1\">superscript</csymbol><ci id=\"S4.SS2.p1.2.m1.1.1.2.cmml\" xref=\"S4.SS2.p1.2.m1.1.1.2\">𝒞</ci><apply id=\"S4.SS2.p1.2.m1.1.1.3.cmml\" xref=\"S4.SS2.p1.2.m1.1.1.3\"><minus id=\"S4.SS2.p1.2.m1.1.1.3.1.cmml\" xref=\"S4.SS2.p1.2.m1.1.1.3\"></minus><ci id=\"S4.SS2.p1.2.m1.1.1.3.2.cmml\" xref=\"S4.SS2.p1.2.m1.1.1.3.2\">𝑖</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS2.p1.2.m1.1c\">\\mathcal{C}^{-i}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS2.p1.2.m1.1d\">caligraphic_C start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> represents the concatenated tokens of a random permutation of demonstration pairs except for the <math alttext=\"i\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS2.p1.3.m2.1\"><semantics id=\"S4.SS2.p1.3.m2.1a\"><mi id=\"S4.SS2.p1.3.m2.1.1\" xref=\"S4.SS2.p1.3.m2.1.1.cmml\">i</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS2.p1.3.m2.1b\"><ci id=\"S4.SS2.p1.3.m2.1.1.cmml\" xref=\"S4.SS2.p1.3.m2.1.1\">𝑖</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS2.p1.3.m2.1c\">i</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS2.p1.3.m2.1d\">italic_i</annotation></semantics></math>-th pair. Therefore, the optimization equation becomes:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S4.Ex6\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\phi^{*}=\\arg\\min_{\\phi}\\;\\sum_{i=1}^{k}-\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,%\n\\mathcal{C}^{-i}\\,;x_{i}\\,]\\right).\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S4.Ex6.m1.1\"><semantics id=\"S4.Ex6.m1.1a\"><mrow id=\"S4.Ex6.m1.1b\"><msup id=\"S4.Ex6.m1.1.1\"><mi id=\"S4.Ex6.m1.1.1.2\">ϕ</mi><mo id=\"S4.Ex6.m1.1.1.3\">∗</mo></msup><mo id=\"S4.Ex6.m1.1.2\">=</mo><mi id=\"S4.Ex6.m1.1.3\">arg</mi><munder id=\"S4.Ex6.m1.1.4\"><mi id=\"S4.Ex6.m1.1.4.2\">min</mi><mi id=\"S4.Ex6.m1.1.4.3\">ϕ</mi></munder><munderover id=\"S4.Ex6.m1.1.5\"><mo id=\"S4.Ex6.m1.1.5.2.2\" movablelimits=\"false\" rspace=\"0em\">∑</mo><mrow id=\"S4.Ex6.m1.1.5.2.3\"><mi id=\"S4.Ex6.m1.1.5.2.3.2\">i</mi><mo id=\"S4.Ex6.m1.1.5.2.3.1\">=</mo><mn id=\"S4.Ex6.m1.1.5.2.3.3\">1</mn></mrow><mi id=\"S4.Ex6.m1.1.5.3\">k</mi></munderover><mo id=\"S4.Ex6.m1.1.6\" lspace=\"0em\">−</mo><mi id=\"S4.Ex6.m1.1.7\">log</mi><msub id=\"S4.Ex6.m1.1.8\"><mi id=\"S4.Ex6.m1.1.8.2\">p</mi><mi id=\"S4.Ex6.m1.1.8.3\">ϕ</mi></msub><mrow id=\"S4.Ex6.m1.1.9\"><mo id=\"S4.Ex6.m1.1.9.1\">(</mo><msub id=\"S4.Ex6.m1.1.9.2\"><mi id=\"S4.Ex6.m1.1.9.2.2\">y</mi><mi id=\"S4.Ex6.m1.1.9.2.3\">i</mi></msub><mo id=\"S4.Ex6.m1.1.9.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S4.Ex6.m1.1.9.4\"><mo id=\"S4.Ex6.m1.1.9.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><msup id=\"S4.Ex6.m1.1.9.4.2\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.Ex6.m1.1.9.4.2.2\">𝒞</mi><mrow id=\"S4.Ex6.m1.1.9.4.2.3\"><mo id=\"S4.Ex6.m1.1.9.4.2.3a\">−</mo><mi id=\"S4.Ex6.m1.1.9.4.2.3.2\">i</mi></mrow></msup><mo id=\"S4.Ex6.m1.1.9.4.3\">;</mo><msub id=\"S4.Ex6.m1.1.9.4.4\"><mi id=\"S4.Ex6.m1.1.9.4.4.2\">x</mi><mi id=\"S4.Ex6.m1.1.9.4.4.3\">i</mi></msub><mo id=\"S4.Ex6.m1.1.9.4.5\" stretchy=\"false\">]</mo></mrow><mo id=\"S4.Ex6.m1.1.9.5\">)</mo></mrow><mo id=\"S4.Ex6.m1.1.10\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S4.Ex6.m1.1c\">\\phi^{*}=\\arg\\min_{\\phi}\\;\\sum_{i=1}^{k}-\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,%\n\\mathcal{C}^{-i}\\,;x_{i}\\,]\\right).</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.Ex6.m1.1d\">italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - roman_log italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | [ caligraphic_C start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT ; italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S4.SS2.p1.4\">To perform inference on the query input <math alttext=\"x_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS2.p1.4.m1.1\"><semantics id=\"S4.SS2.p1.4.m1.1a\"><msub id=\"S4.SS2.p1.4.m1.1.1\" xref=\"S4.SS2.p1.4.m1.1.1.cmml\"><mi id=\"S4.SS2.p1.4.m1.1.1.2\" xref=\"S4.SS2.p1.4.m1.1.1.2.cmml\">x</mi><mi id=\"S4.SS2.p1.4.m1.1.1.3\" xref=\"S4.SS2.p1.4.m1.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS2.p1.4.m1.1b\"><apply id=\"S4.SS2.p1.4.m1.1.1.cmml\" xref=\"S4.SS2.p1.4.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS2.p1.4.m1.1.1.1.cmml\" xref=\"S4.SS2.p1.4.m1.1.1\">subscript</csymbol><ci id=\"S4.SS2.p1.4.m1.1.1.2.cmml\" xref=\"S4.SS2.p1.4.m1.1.1.2\">𝑥</ci><ci id=\"S4.SS2.p1.4.m1.1.1.3.cmml\" xref=\"S4.SS2.p1.4.m1.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS2.p1.4.m1.1c\">x_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS2.p1.4.m1.1d\">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, TTT uses the optimized model weights and the concatenation of all demonstration pairs as context:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S4.Ex7\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\hat{y}_{q}=\\arg\\max_{y}\\,p_{\\phi^{*}}\\left(y\\bigm{|}[\\,\\mathcal{C}\\,;x_{q}\\,]%\n\\right).\" class=\"ltx_math_unparsed\" display=\"block\" id=\"S4.Ex7.m1.1\"><semantics id=\"S4.Ex7.m1.1a\"><mrow id=\"S4.Ex7.m1.1b\"><msub id=\"S4.Ex7.m1.1.2\"><mover accent=\"true\" id=\"S4.Ex7.m1.1.2.2\"><mi id=\"S4.Ex7.m1.1.2.2.2\">y</mi><mo id=\"S4.Ex7.m1.1.2.2.1\">^</mo></mover><mi id=\"S4.Ex7.m1.1.2.3\">q</mi></msub><mo id=\"S4.Ex7.m1.1.3\">=</mo><mi id=\"S4.Ex7.m1.1.4\">arg</mi><munder id=\"S4.Ex7.m1.1.5\"><mi id=\"S4.Ex7.m1.1.5.2\">max</mi><mi id=\"S4.Ex7.m1.1.5.3\">y</mi></munder><msub id=\"S4.Ex7.m1.1.6\"><mi id=\"S4.Ex7.m1.1.6.2\">p</mi><msup id=\"S4.Ex7.m1.1.6.3\"><mi id=\"S4.Ex7.m1.1.6.3.2\">ϕ</mi><mo id=\"S4.Ex7.m1.1.6.3.3\">∗</mo></msup></msub><mrow id=\"S4.Ex7.m1.1.7\"><mo id=\"S4.Ex7.m1.1.7.1\">(</mo><mi id=\"S4.Ex7.m1.1.7.2\">y</mi><mo id=\"S4.Ex7.m1.1.7.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S4.Ex7.m1.1.7.4\"><mo id=\"S4.Ex7.m1.1.7.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.Ex7.m1.1.1\">𝒞</mi><mo id=\"S4.Ex7.m1.1.7.4.2\" lspace=\"0.170em\">;</mo><msub id=\"S4.Ex7.m1.1.7.4.3\"><mi id=\"S4.Ex7.m1.1.7.4.3.2\">x</mi><mi id=\"S4.Ex7.m1.1.7.4.3.3\">q</mi></msub><mo id=\"S4.Ex7.m1.1.7.4.4\" stretchy=\"false\">]</mo></mrow><mo id=\"S4.Ex7.m1.1.7.5\">)</mo></mrow><mo id=\"S4.Ex7.m1.1.8\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S4.Ex7.m1.1c\">\\hat{y}_{q}=\\arg\\max_{y}\\,p_{\\phi^{*}}\\left(y\\bigm{|}[\\,\\mathcal{C}\\,;x_{q}\\,]%\n\\right).</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.Ex7.m1.1d\">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_ϕ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_y | [ caligraphic_C ; italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S4.SS3\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">4.3 </span>Context Tuning</h3>\n<div class=\"ltx_para\" id=\"S4.SS3.p1\">\n<p class=\"ltx_p\" id=\"S4.SS3.p1.2\">We design our <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.p1.2.1\">Context Tuning</span> approach to be an instantiation of the <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.p1.2.2\">ICO</span> framework. In contrast to TTT, <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.p1.2.3\">Context Tuning</span> freezes model parameters <math alttext=\"\\phi\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.p1.1.m1.1\"><semantics id=\"S4.SS3.p1.1.m1.1a\"><mi id=\"S4.SS3.p1.1.m1.1.1\" xref=\"S4.SS3.p1.1.m1.1.1.cmml\">ϕ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.p1.1.m1.1b\"><ci id=\"S4.SS3.p1.1.m1.1.1.cmml\" xref=\"S4.SS3.p1.1.m1.1.1\">italic-ϕ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.p1.1.m1.1c\">\\phi</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.p1.1.m1.1d\">italic_ϕ</annotation></semantics></math> and instead directly optimizes the lightweight context representation <math alttext=\"\\theta_{\\mathrm{context}}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.p1.2.m2.1\"><semantics id=\"S4.SS3.p1.2.m2.1a\"><msub id=\"S4.SS3.p1.2.m2.1.1\" xref=\"S4.SS3.p1.2.m2.1.1.cmml\"><mi id=\"S4.SS3.p1.2.m2.1.1.2\" xref=\"S4.SS3.p1.2.m2.1.1.2.cmml\">θ</mi><mi id=\"S4.SS3.p1.2.m2.1.1.3\" xref=\"S4.SS3.p1.2.m2.1.1.3.cmml\">context</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.p1.2.m2.1b\"><apply id=\"S4.SS3.p1.2.m2.1.1.cmml\" xref=\"S4.SS3.p1.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.p1.2.m2.1.1.1.cmml\" xref=\"S4.SS3.p1.2.m2.1.1\">subscript</csymbol><ci id=\"S4.SS3.p1.2.m2.1.1.2.cmml\" xref=\"S4.SS3.p1.2.m2.1.1.2\">𝜃</ci><ci id=\"S4.SS3.p1.2.m2.1.1.3.cmml\" xref=\"S4.SS3.p1.2.m2.1.1.3\">context</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.p1.2.m2.1c\">\\theta_{\\mathrm{context}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.p1.2.m2.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT</annotation></semantics></math> of the demonstration pairs.</p>\n<ul class=\"ltx_itemize\" id=\"S4.I1\">\n<li class=\"ltx_item\" id=\"S4.I1.i1\" style=\"list-style-type:none;\">\n<span class=\"ltx_tag ltx_tag_item\">•</span>\n<div class=\"ltx_para\" id=\"S4.I1.i1.p1\">\n<p class=\"ltx_p\" id=\"S4.I1.i1.p1.2\"><span class=\"ltx_text ltx_font_italic\" id=\"S4.I1.i1.p1.2.1\">CT-Prompt</span> initializes <math alttext=\"\\theta_{\\mathrm{context}}=P_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.I1.i1.p1.1.m1.1\"><semantics id=\"S4.I1.i1.p1.1.m1.1a\"><mrow id=\"S4.I1.i1.p1.1.m1.1.1\" xref=\"S4.I1.i1.p1.1.m1.1.1.cmml\"><msub id=\"S4.I1.i1.p1.1.m1.1.1.2\" xref=\"S4.I1.i1.p1.1.m1.1.1.2.cmml\"><mi id=\"S4.I1.i1.p1.1.m1.1.1.2.2\" xref=\"S4.I1.i1.p1.1.m1.1.1.2.2.cmml\">θ</mi><mi id=\"S4.I1.i1.p1.1.m1.1.1.2.3\" xref=\"S4.I1.i1.p1.1.m1.1.1.2.3.cmml\">context</mi></msub><mo id=\"S4.I1.i1.p1.1.m1.1.1.1\" xref=\"S4.I1.i1.p1.1.m1.1.1.1.cmml\">=</mo><msub id=\"S4.I1.i1.p1.1.m1.1.1.3\" xref=\"S4.I1.i1.p1.1.m1.1.1.3.cmml\"><mi id=\"S4.I1.i1.p1.1.m1.1.1.3.2\" xref=\"S4.I1.i1.p1.1.m1.1.1.3.2.cmml\">P</mi><mi id=\"S4.I1.i1.p1.1.m1.1.1.3.3\" xref=\"S4.I1.i1.p1.1.m1.1.1.3.3.cmml\">CT</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.I1.i1.p1.1.m1.1b\"><apply id=\"S4.I1.i1.p1.1.m1.1.1.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1\"><eq id=\"S4.I1.i1.p1.1.m1.1.1.1.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.1\"></eq><apply id=\"S4.I1.i1.p1.1.m1.1.1.2.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i1.p1.1.m1.1.1.2.1.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.2\">subscript</csymbol><ci id=\"S4.I1.i1.p1.1.m1.1.1.2.2.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.2.2\">𝜃</ci><ci id=\"S4.I1.i1.p1.1.m1.1.1.2.3.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.2.3\">context</ci></apply><apply id=\"S4.I1.i1.p1.1.m1.1.1.3.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i1.p1.1.m1.1.1.3.1.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.3\">subscript</csymbol><ci id=\"S4.I1.i1.p1.1.m1.1.1.3.2.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.3.2\">𝑃</ci><ci id=\"S4.I1.i1.p1.1.m1.1.1.3.3.cmml\" xref=\"S4.I1.i1.p1.1.m1.1.1.3.3\">CT</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.I1.i1.p1.1.m1.1c\">\\theta_{\\mathrm{context}}=P_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.I1.i1.p1.1.m1.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT = italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> as the model’s prompt embeddings on <math alttext=\"\\mathcal{C}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.I1.i1.p1.2.m2.1\"><semantics id=\"S4.I1.i1.p1.2.m2.1a\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.I1.i1.p1.2.m2.1.1\" xref=\"S4.I1.i1.p1.2.m2.1.1.cmml\">𝒞</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.I1.i1.p1.2.m2.1b\"><ci id=\"S4.I1.i1.p1.2.m2.1.1.cmml\" xref=\"S4.I1.i1.p1.2.m2.1.1\">𝒞</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.I1.i1.p1.2.m2.1c\">\\mathcal{C}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.I1.i1.p1.2.m2.1d\">caligraphic_C</annotation></semantics></math>, the concatenation of demonstration pairs.</p>\n</div>\n</li>\n<li class=\"ltx_item\" id=\"S4.I1.i2\" style=\"list-style-type:none;\">\n<span class=\"ltx_tag ltx_tag_item\">•</span>\n<div class=\"ltx_para\" id=\"S4.I1.i2.p1\">\n<p class=\"ltx_p\" id=\"S4.I1.i2.p1.3\"><span class=\"ltx_text ltx_font_italic\" id=\"S4.I1.i2.p1.3.1\">CT-KV</span> initializes <math alttext=\"\\theta_{\\mathrm{context}}=\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.I1.i2.p1.1.m1.1\"><semantics id=\"S4.I1.i2.p1.1.m1.1a\"><mrow id=\"S4.I1.i2.p1.1.m1.1.1\" xref=\"S4.I1.i2.p1.1.m1.1.1.cmml\"><msub id=\"S4.I1.i2.p1.1.m1.1.1.2\" xref=\"S4.I1.i2.p1.1.m1.1.1.2.cmml\"><mi id=\"S4.I1.i2.p1.1.m1.1.1.2.2\" xref=\"S4.I1.i2.p1.1.m1.1.1.2.2.cmml\">θ</mi><mi id=\"S4.I1.i2.p1.1.m1.1.1.2.3\" xref=\"S4.I1.i2.p1.1.m1.1.1.2.3.cmml\">context</mi></msub><mo id=\"S4.I1.i2.p1.1.m1.1.1.1\" xref=\"S4.I1.i2.p1.1.m1.1.1.1.cmml\">=</mo><msub id=\"S4.I1.i2.p1.1.m1.1.1.3\" xref=\"S4.I1.i2.p1.1.m1.1.1.3.cmml\"><mi id=\"S4.I1.i2.p1.1.m1.1.1.3.2\" mathvariant=\"normal\" xref=\"S4.I1.i2.p1.1.m1.1.1.3.2.cmml\">Θ</mi><mi id=\"S4.I1.i2.p1.1.m1.1.1.3.3\" xref=\"S4.I1.i2.p1.1.m1.1.1.3.3.cmml\">CT</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.I1.i2.p1.1.m1.1b\"><apply id=\"S4.I1.i2.p1.1.m1.1.1.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1\"><eq id=\"S4.I1.i2.p1.1.m1.1.1.1.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.1\"></eq><apply id=\"S4.I1.i2.p1.1.m1.1.1.2.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i2.p1.1.m1.1.1.2.1.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.2\">subscript</csymbol><ci id=\"S4.I1.i2.p1.1.m1.1.1.2.2.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.2.2\">𝜃</ci><ci id=\"S4.I1.i2.p1.1.m1.1.1.2.3.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.2.3\">context</ci></apply><apply id=\"S4.I1.i2.p1.1.m1.1.1.3.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i2.p1.1.m1.1.1.3.1.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.3\">subscript</csymbol><ci id=\"S4.I1.i2.p1.1.m1.1.1.3.2.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.3.2\">Θ</ci><ci id=\"S4.I1.i2.p1.1.m1.1.1.3.3.cmml\" xref=\"S4.I1.i2.p1.1.m1.1.1.3.3\">CT</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.I1.i2.p1.1.m1.1c\">\\theta_{\\mathrm{context}}=\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.I1.i2.p1.1.m1.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT = roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> as a key-value prefix <math alttext=\"\\Theta_{\\mathrm{CT}}=\\{K_{j},V_{j}\\}_{j=1}^{L}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.I1.i2.p1.2.m2.2\"><semantics id=\"S4.I1.i2.p1.2.m2.2a\"><mrow id=\"S4.I1.i2.p1.2.m2.2.2\" xref=\"S4.I1.i2.p1.2.m2.2.2.cmml\"><msub id=\"S4.I1.i2.p1.2.m2.2.2.4\" xref=\"S4.I1.i2.p1.2.m2.2.2.4.cmml\"><mi id=\"S4.I1.i2.p1.2.m2.2.2.4.2\" mathvariant=\"normal\" xref=\"S4.I1.i2.p1.2.m2.2.2.4.2.cmml\">Θ</mi><mi id=\"S4.I1.i2.p1.2.m2.2.2.4.3\" xref=\"S4.I1.i2.p1.2.m2.2.2.4.3.cmml\">CT</mi></msub><mo id=\"S4.I1.i2.p1.2.m2.2.2.3\" xref=\"S4.I1.i2.p1.2.m2.2.2.3.cmml\">=</mo><msubsup id=\"S4.I1.i2.p1.2.m2.2.2.2\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.cmml\"><mrow id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml\"><mo id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.3\" stretchy=\"false\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml\">{</mo><msub id=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1\" xref=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml\"><mi id=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2\" xref=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2.cmml\">K</mi><mi id=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3\" xref=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3.cmml\">j</mi></msub><mo id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.4\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml\">,</mo><msub id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.cmml\"><mi id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.cmml\">V</mi><mi id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.cmml\">j</mi></msub><mo id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.5\" stretchy=\"false\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml\">}</mo></mrow><mrow id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.cmml\"><mi id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.2\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.2.cmml\">j</mi><mo id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.1\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.1.cmml\">=</mo><mn id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.3\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.3.cmml\">1</mn></mrow><mi id=\"S4.I1.i2.p1.2.m2.2.2.2.4\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.4.cmml\">L</mi></msubsup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.I1.i2.p1.2.m2.2b\"><apply id=\"S4.I1.i2.p1.2.m2.2.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2\"><eq id=\"S4.I1.i2.p1.2.m2.2.2.3.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.3\"></eq><apply id=\"S4.I1.i2.p1.2.m2.2.2.4.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.4\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i2.p1.2.m2.2.2.4.1.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.4\">subscript</csymbol><ci id=\"S4.I1.i2.p1.2.m2.2.2.4.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.4.2\">Θ</ci><ci id=\"S4.I1.i2.p1.2.m2.2.2.4.3.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.4.3\">CT</ci></apply><apply id=\"S4.I1.i2.p1.2.m2.2.2.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i2.p1.2.m2.2.2.2.3.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2\">superscript</csymbol><apply id=\"S4.I1.i2.p1.2.m2.2.2.2.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i2.p1.2.m2.2.2.2.2.3.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2\">subscript</csymbol><set id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.3.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2\"><apply id=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml\" xref=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.cmml\" xref=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2\">𝐾</ci><ci id=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3.cmml\" xref=\"S4.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3\">𝑗</ci></apply><apply id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.1.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2\">subscript</csymbol><ci id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.2\">𝑉</ci><ci id=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.2.2.2.3\">𝑗</ci></apply></set><apply id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4\"><eq id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.1.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.1\"></eq><ci id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.2.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.2\">𝑗</ci><cn id=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.3.cmml\" type=\"integer\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.2.4.3\">1</cn></apply></apply><ci id=\"S4.I1.i2.p1.2.m2.2.2.2.4.cmml\" xref=\"S4.I1.i2.p1.2.m2.2.2.2.4\">𝐿</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.I1.i2.p1.2.m2.2c\">\\Theta_{\\mathrm{CT}}=\\{K_{j},V_{j}\\}_{j=1}^{L}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.I1.i2.p1.2.m2.2d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT = { italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> obtained from the model’s layer-wise activations on <math alttext=\"\\mathcal{C}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.I1.i2.p1.3.m3.1\"><semantics id=\"S4.I1.i2.p1.3.m3.1a\"><mi class=\"ltx_font_mathcaligraphic\" id=\"S4.I1.i2.p1.3.m3.1.1\" xref=\"S4.I1.i2.p1.3.m3.1.1.cmml\">𝒞</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.I1.i2.p1.3.m3.1b\"><ci id=\"S4.I1.i2.p1.3.m3.1.1.cmml\" xref=\"S4.I1.i2.p1.3.m3.1.1\">𝒞</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.I1.i2.p1.3.m3.1c\">\\mathcal{C}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.I1.i2.p1.3.m3.1d\">caligraphic_C</annotation></semantics></math>.</p>\n</div>\n</li>\n</ul>\n<p class=\"ltx_p\" id=\"S4.SS3.p1.3\">Furthermore, we introduce two design choices for both <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.p1.3.1\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.p1.3.2\">CT-KV</span>. We study the performance impact of each in Section <a class=\"ltx_ref\" href=\"#S5.SS5\" title=\"5.5 Ablation Study ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">5.5</span></a>, demonstrating that both are crucial for achieving strong empirical gains.</p>\n</div>\n<section class=\"ltx_paragraph\" id=\"S4.SS3.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Leave-One-Out Masking.</h4>\n<div class=\"ltx_para\" id=\"S4.SS3.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"S4.SS3.SSS0.Px1.p1.4\">To prevent the model from simply retrieving the answer <math alttext=\"y_{i}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.1.m1.1\"><semantics id=\"S4.SS3.SSS0.Px1.p1.1.m1.1a\"><msub id=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.2\" xref=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml\">y</mi><mi id=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.3\" xref=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml\">i</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.1.m1.1b\"><apply id=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.2\">𝑦</ci><ci id=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.1.m1.1.1.3\">𝑖</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.1.m1.1c\">y_{i}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.1.m1.1d\">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of the <math alttext=\"i\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.2.m2.1\"><semantics id=\"S4.SS3.SSS0.Px1.p1.2.m2.1a\"><mi id=\"S4.SS3.SSS0.Px1.p1.2.m2.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml\">i</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.2.m2.1b\"><ci id=\"S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.2.m2.1.1\">𝑖</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.2.m2.1c\">i</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.2.m2.1d\">italic_i</annotation></semantics></math>th demonstration pair embedded in <math alttext=\"\\theta_{\\mathrm{context}}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.3.m3.1\"><semantics id=\"S4.SS3.SSS0.Px1.p1.3.m3.1a\"><msub id=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.2\" xref=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml\">θ</mi><mi id=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.3\" xref=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml\">context</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.3.m3.1b\"><apply id=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.2\">𝜃</ci><ci id=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.3.m3.1.1.3\">context</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.3.m3.1c\">\\theta_{\\mathrm{context}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.3.m3.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT</annotation></semantics></math> when predicting the output for <math alttext=\"x_{i}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.4.m4.1\"><semantics id=\"S4.SS3.SSS0.Px1.p1.4.m4.1a\"><msub id=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.2\" xref=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml\">x</mi><mi id=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.3\" xref=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml\">i</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.4.m4.1b\"><apply id=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.2\">𝑥</ci><ci id=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.4.m4.1.1.3\">𝑖</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.4.m4.1c\">x_{i}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.4.m4.1d\">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we construct</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"S4.Ex8\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\theta_{\\mathrm{context}}^{(i)}=\\begin{cases}P_{\\mathrm{CT}}^{-i}&amp;\\text{for {%\n\\it CT-Prompt}{}},\\\\\n\\Theta_{\\mathrm{CT}}^{-i}&amp;\\text{for {\\it CT-KV}{}},\\end{cases}\" class=\"ltx_Math\" display=\"block\" id=\"S4.Ex8.m1.5\"><semantics id=\"S4.Ex8.m1.5a\"><mrow id=\"S4.Ex8.m1.5.6\" xref=\"S4.Ex8.m1.5.6.cmml\"><msubsup id=\"S4.Ex8.m1.5.6.2\" xref=\"S4.Ex8.m1.5.6.2.cmml\"><mi id=\"S4.Ex8.m1.5.6.2.2.2\" xref=\"S4.Ex8.m1.5.6.2.2.2.cmml\">θ</mi><mi id=\"S4.Ex8.m1.5.6.2.2.3\" xref=\"S4.Ex8.m1.5.6.2.2.3.cmml\">context</mi><mrow id=\"S4.Ex8.m1.5.5.1.3\" xref=\"S4.Ex8.m1.5.6.2.cmml\"><mo id=\"S4.Ex8.m1.5.5.1.3.1\" stretchy=\"false\" xref=\"S4.Ex8.m1.5.6.2.cmml\">(</mo><mi id=\"S4.Ex8.m1.5.5.1.1\" xref=\"S4.Ex8.m1.5.5.1.1.cmml\">i</mi><mo id=\"S4.Ex8.m1.5.5.1.3.2\" stretchy=\"false\" xref=\"S4.Ex8.m1.5.6.2.cmml\">)</mo></mrow></msubsup><mo id=\"S4.Ex8.m1.5.6.1\" xref=\"S4.Ex8.m1.5.6.1.cmml\">=</mo><mrow id=\"S4.Ex8.m1.4.4\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><mo id=\"S4.Ex8.m1.4.4.5\" xref=\"S4.Ex8.m1.5.6.3.1.1.cmml\">{</mo><mtable columnspacing=\"5pt\" displaystyle=\"true\" id=\"S4.Ex8.m1.4.4.4\" rowspacing=\"0pt\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><mtr id=\"S4.Ex8.m1.4.4.4a\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><mtd class=\"ltx_align_left\" columnalign=\"left\" id=\"S4.Ex8.m1.4.4.4b\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><msubsup id=\"S4.Ex8.m1.1.1.1.1.1.1\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.cmml\"><mi id=\"S4.Ex8.m1.1.1.1.1.1.1.2.2\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.2.2.cmml\">P</mi><mi id=\"S4.Ex8.m1.1.1.1.1.1.1.2.3\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.2.3.cmml\">CT</mi><mrow id=\"S4.Ex8.m1.1.1.1.1.1.1.3\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.3.cmml\"><mo id=\"S4.Ex8.m1.1.1.1.1.1.1.3a\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.3.cmml\">−</mo><mi id=\"S4.Ex8.m1.1.1.1.1.1.1.3.2\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.3.2.cmml\">i</mi></mrow></msubsup></mtd><mtd class=\"ltx_align_left\" columnalign=\"left\" id=\"S4.Ex8.m1.4.4.4c\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><mrow id=\"S4.Ex8.m1.2.2.2.2.2.1.3\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.1c.cmml\"><mrow id=\"S4.Ex8.m1.2.2.2.2.2.1.1\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.1c.cmml\"><mtext id=\"S4.Ex8.m1.2.2.2.2.2.1.1a\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.1a.cmml\">for </mtext><mtext class=\"ltx_mathvariant_italic\" id=\"S4.Ex8.m1.2.2.2.2.2.1.1b\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.1a.cmml\">CT-Prompt</mtext></mrow><mo id=\"S4.Ex8.m1.2.2.2.2.2.1.3.1\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.1c.cmml\">,</mo></mrow></mtd></mtr><mtr id=\"S4.Ex8.m1.4.4.4d\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><mtd class=\"ltx_align_left\" columnalign=\"left\" id=\"S4.Ex8.m1.4.4.4e\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><msubsup id=\"S4.Ex8.m1.3.3.3.3.1.1\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.cmml\"><mi id=\"S4.Ex8.m1.3.3.3.3.1.1.2.2\" mathvariant=\"normal\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.2.2.cmml\">Θ</mi><mi id=\"S4.Ex8.m1.3.3.3.3.1.1.2.3\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.2.3.cmml\">CT</mi><mrow id=\"S4.Ex8.m1.3.3.3.3.1.1.3\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.3.cmml\"><mo id=\"S4.Ex8.m1.3.3.3.3.1.1.3a\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.3.cmml\">−</mo><mi id=\"S4.Ex8.m1.3.3.3.3.1.1.3.2\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.3.2.cmml\">i</mi></mrow></msubsup></mtd><mtd class=\"ltx_align_left\" columnalign=\"left\" id=\"S4.Ex8.m1.4.4.4f\" xref=\"S4.Ex8.m1.5.6.3.1.cmml\"><mrow id=\"S4.Ex8.m1.4.4.4.4.2.1.3\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.1c.cmml\"><mrow id=\"S4.Ex8.m1.4.4.4.4.2.1.1\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.1c.cmml\"><mtext id=\"S4.Ex8.m1.4.4.4.4.2.1.1a\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.1a.cmml\">for </mtext><mtext class=\"ltx_mathvariant_italic\" id=\"S4.Ex8.m1.4.4.4.4.2.1.1b\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.1a.cmml\">CT-KV</mtext></mrow><mo id=\"S4.Ex8.m1.4.4.4.4.2.1.3.1\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.1c.cmml\">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.Ex8.m1.5b\"><apply id=\"S4.Ex8.m1.5.6.cmml\" xref=\"S4.Ex8.m1.5.6\"><eq id=\"S4.Ex8.m1.5.6.1.cmml\" xref=\"S4.Ex8.m1.5.6.1\"></eq><apply id=\"S4.Ex8.m1.5.6.2.cmml\" xref=\"S4.Ex8.m1.5.6.2\"><csymbol cd=\"ambiguous\" id=\"S4.Ex8.m1.5.6.2.1.cmml\" xref=\"S4.Ex8.m1.5.6.2\">superscript</csymbol><apply id=\"S4.Ex8.m1.5.6.2.2.cmml\" xref=\"S4.Ex8.m1.5.6.2\"><csymbol cd=\"ambiguous\" id=\"S4.Ex8.m1.5.6.2.2.1.cmml\" xref=\"S4.Ex8.m1.5.6.2\">subscript</csymbol><ci id=\"S4.Ex8.m1.5.6.2.2.2.cmml\" xref=\"S4.Ex8.m1.5.6.2.2.2\">𝜃</ci><ci id=\"S4.Ex8.m1.5.6.2.2.3.cmml\" xref=\"S4.Ex8.m1.5.6.2.2.3\">context</ci></apply><ci id=\"S4.Ex8.m1.5.5.1.1.cmml\" xref=\"S4.Ex8.m1.5.5.1.1\">𝑖</ci></apply><apply id=\"S4.Ex8.m1.5.6.3.1.cmml\" xref=\"S4.Ex8.m1.4.4\"><csymbol cd=\"latexml\" id=\"S4.Ex8.m1.5.6.3.1.1.cmml\" xref=\"S4.Ex8.m1.4.4.5\">cases</csymbol><apply id=\"S4.Ex8.m1.1.1.1.1.1.1.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.Ex8.m1.1.1.1.1.1.1.1.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1\">superscript</csymbol><apply id=\"S4.Ex8.m1.1.1.1.1.1.1.2.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.Ex8.m1.1.1.1.1.1.1.2.1.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1\">subscript</csymbol><ci id=\"S4.Ex8.m1.1.1.1.1.1.1.2.2.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.2.2\">𝑃</ci><ci id=\"S4.Ex8.m1.1.1.1.1.1.1.2.3.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.2.3\">CT</ci></apply><apply id=\"S4.Ex8.m1.1.1.1.1.1.1.3.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.3\"><minus id=\"S4.Ex8.m1.1.1.1.1.1.1.3.1.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.3\"></minus><ci id=\"S4.Ex8.m1.1.1.1.1.1.1.3.2.cmml\" xref=\"S4.Ex8.m1.1.1.1.1.1.1.3.2\">𝑖</ci></apply></apply><ci id=\"S4.Ex8.m1.2.2.2.2.2.1.1c.cmml\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.3\"><mrow id=\"S4.Ex8.m1.2.2.2.2.2.1.1.cmml\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.3\"><mtext id=\"S4.Ex8.m1.2.2.2.2.2.1.1a.cmml\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.1a\">for </mtext><mtext class=\"ltx_mathvariant_italic\" id=\"S4.Ex8.m1.2.2.2.2.2.1.1b.cmml\" xref=\"S4.Ex8.m1.2.2.2.2.2.1.1a\">CT-Prompt</mtext></mrow></ci><apply id=\"S4.Ex8.m1.3.3.3.3.1.1.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.Ex8.m1.3.3.3.3.1.1.1.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1\">superscript</csymbol><apply id=\"S4.Ex8.m1.3.3.3.3.1.1.2.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.Ex8.m1.3.3.3.3.1.1.2.1.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1\">subscript</csymbol><ci id=\"S4.Ex8.m1.3.3.3.3.1.1.2.2.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.2.2\">Θ</ci><ci id=\"S4.Ex8.m1.3.3.3.3.1.1.2.3.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.2.3\">CT</ci></apply><apply id=\"S4.Ex8.m1.3.3.3.3.1.1.3.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.3\"><minus id=\"S4.Ex8.m1.3.3.3.3.1.1.3.1.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.3\"></minus><ci id=\"S4.Ex8.m1.3.3.3.3.1.1.3.2.cmml\" xref=\"S4.Ex8.m1.3.3.3.3.1.1.3.2\">𝑖</ci></apply></apply><ci id=\"S4.Ex8.m1.4.4.4.4.2.1.1c.cmml\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.3\"><mrow id=\"S4.Ex8.m1.4.4.4.4.2.1.1.cmml\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.3\"><mtext id=\"S4.Ex8.m1.4.4.4.4.2.1.1a.cmml\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.1a\">for </mtext><mtext class=\"ltx_mathvariant_italic\" id=\"S4.Ex8.m1.4.4.4.4.2.1.1b.cmml\" xref=\"S4.Ex8.m1.4.4.4.4.2.1.1a\">CT-KV</mtext></mrow></ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.Ex8.m1.5c\">\\theta_{\\mathrm{context}}^{(i)}=\\begin{cases}P_{\\mathrm{CT}}^{-i}&amp;\\text{for {%\n\\it CT-Prompt}{}},\\\\\n\\Theta_{\\mathrm{CT}}^{-i}&amp;\\text{for {\\it CT-KV}{}},\\end{cases}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.Ex8.m1.5d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = { start_ROW start_CELL italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT end_CELL start_CELL for italic_CT-Prompt , end_CELL end_ROW start_ROW start_CELL roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT end_CELL start_CELL for italic_CT-KV , end_CELL end_ROW</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"S4.SS3.SSS0.Px1.p1.8\">and use it instead of <math alttext=\"\\theta_{\\mathrm{context}}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.5.m1.1\"><semantics id=\"S4.SS3.SSS0.Px1.p1.5.m1.1a\"><msub id=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.2\" xref=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.2.cmml\">θ</mi><mi id=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.3\" xref=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.3.cmml\">context</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.5.m1.1b\"><apply id=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.2\">𝜃</ci><ci id=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.5.m1.1.1.3\">context</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.5.m1.1c\">\\theta_{\\mathrm{context}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.5.m1.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT</annotation></semantics></math> in optimization. When conditioning on <math alttext=\"P_{\\mathrm{CT}}^{-i}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.6.m2.1\"><semantics id=\"S4.SS3.SSS0.Px1.p1.6.m2.1a\"><msubsup id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.2\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.2.cmml\">P</mi><mi id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.3\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.3.cmml\">CT</mi><mrow id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.cmml\"><mo id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3a\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.cmml\">−</mo><mi id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.2\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.2.cmml\">i</mi></mrow></msubsup><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.6.m2.1b\"><apply id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1\">superscript</csymbol><apply id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.2\">𝑃</ci><ci id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.2.3\">CT</ci></apply><apply id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3\"><minus id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3\"></minus><ci id=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.6.m2.1.1.3.2\">𝑖</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.6.m2.1c\">P_{\\mathrm{CT}}^{-i}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.6.m2.1d\">italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> or <math alttext=\"\\Theta_{\\mathrm{CT}}^{-i}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.7.m3.1\"><semantics id=\"S4.SS3.SSS0.Px1.p1.7.m3.1a\"><msubsup id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.2\" mathvariant=\"normal\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.2.cmml\">Θ</mi><mi id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.3\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.3.cmml\">CT</mi><mrow id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.cmml\"><mo id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3a\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.cmml\">−</mo><mi id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.2\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.2.cmml\">i</mi></mrow></msubsup><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.7.m3.1b\"><apply id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1\">superscript</csymbol><apply id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.2\">Θ</ci><ci id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.2.3\">CT</ci></apply><apply id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3\"><minus id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3\"></minus><ci id=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.7.m3.1.1.3.2\">𝑖</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.7.m3.1c\">\\Theta_{\\mathrm{CT}}^{-i}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.7.m3.1d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, the trainable soft prompt tokens in <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px1.p1.8.1\">CT-Prompt</span> or prefix tokens in <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px1.p1.8.2\">CT-KV</span> corresponding to the in-context demonstration pair <math alttext=\"(x_{i},y_{i})\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px1.p1.8.m4.2\"><semantics id=\"S4.SS3.SSS0.Px1.p1.8.m4.2a\"><mrow id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.3.cmml\"><mo id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.3\" stretchy=\"false\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.3.cmml\">(</mo><msub id=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.2\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.2.cmml\">x</mi><mi id=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.3\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.3.cmml\">i</mi></msub><mo id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.4\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.3.cmml\">,</mo><msub id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.cmml\"><mi id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.2\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.2.cmml\">y</mi><mi id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.3\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.3.cmml\">i</mi></msub><mo id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.5\" stretchy=\"false\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.3.cmml\">)</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px1.p1.8.m4.2b\"><interval closure=\"open\" id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2\"><apply id=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.2\">𝑥</ci><ci id=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.1.1.1.1.3\">𝑖</ci></apply><apply id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.1.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.2.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.2\">𝑦</ci><ci id=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.3.cmml\" xref=\"S4.SS3.SSS0.Px1.p1.8.m4.2.2.2.2.3\">𝑖</ci></apply></interval></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px1.p1.8.m4.2c\">(x_{i},y_{i})</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px1.p1.8.m4.2d\">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> are masked out from the attention view of the model. In contrast to TTT’s leave-one-out technique, which omits one demonstration pair in the context to update the model weights, our Leave-One-Out Masking operates on the derived context vectors with the model parameters frozen, ensuring that the optimization refines the context representation itself rather than relying on weight updates.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S4.SS3.SSS0.Px2\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Token Dropout.</h4>\n<div class=\"ltx_para\" id=\"S4.SS3.SSS0.Px2.p1\">\n<p class=\"ltx_p\" id=\"S4.SS3.SSS0.Px2.p1.2\">Since <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p1.2.1\">Context Tuning</span> generally introduces a larger number of prompt or prefix tokens than traditional prompt-based adaptation techniques, we regularize training by randomly dropping tokens in <math alttext=\"\\theta_{\\mathrm{context}}^{(i)}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px2.p1.1.m1.1\"><semantics id=\"S4.SS3.SSS0.Px2.p1.1.m1.1a\"><msubsup id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.cmml\"><mi id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.2\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.2.cmml\">θ</mi><mi id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.3\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.3.cmml\">context</mi><mrow id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.3\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.cmml\"><mo id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.3.1\" stretchy=\"false\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.cmml\">(</mo><mi id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.cmml\">i</mi><mo id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.3.2\" stretchy=\"false\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.cmml\">)</mo></mrow></msubsup><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px2.p1.1.m1.1b\"><apply id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2\">superscript</csymbol><apply id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.2.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.2\">𝜃</ci><ci id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.3.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.2.2.3\">context</ci></apply><ci id=\"S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1\">𝑖</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px2.p1.1.m1.1c\">\\theta_{\\mathrm{context}}^{(i)}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px2.p1.1.m1.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> with a fixed probability, denoted as <math alttext=\"\\mathrm{TokenDrop}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px2.p1.2.m2.1\"><semantics id=\"S4.SS3.SSS0.Px2.p1.2.m2.1a\"><mi id=\"S4.SS3.SSS0.Px2.p1.2.m2.1.1\" xref=\"S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml\">TokenDrop</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px2.p1.2.m2.1b\"><ci id=\"S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p1.2.m2.1.1\">TokenDrop</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px2.p1.2.m2.1c\">\\mathrm{TokenDrop}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px2.p1.2.m2.1d\">roman_TokenDrop</annotation></semantics></math>. During optimization, the loss is computed in the expectation over these stochastic dropout masks, encouraging the learned context to avoid overfitting to any single token.</p>\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS3.SSS0.Px2.p2\">\n<p class=\"ltx_p\" id=\"S4.SS3.SSS0.Px2.p2.1\">Altogether, we arrive at the optimization equations for <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p2.1.1\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p2.1.2\">CT-KV</span>:</p>\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table\" id=\"A7.EGx1\">\n<tbody id=\"S4.Ex9\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><span class=\"ltx_text ltx_markedasmath\" id=\"S4.Ex9.2.1.1.1\"><span class=\"ltx_text ltx_font_italic\" id=\"S4.Ex9.2.1.1.1.1\">CT-Prompt</span>:</span></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle P_{\\mathrm{CT}}^{*}=\\arg\\min_{P_{\\mathrm{CT}}}\\sum_{i=1}^{k}-%\n\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,\\mathrm{TokenDrop}\\left(P_{\\mathrm{CT}}^{-i%\n}\\right)\\,;x_{i}]\\right),\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"S4.Ex9.m2.1\"><semantics id=\"S4.Ex9.m2.1a\"><mrow id=\"S4.Ex9.m2.1b\"><msubsup id=\"S4.Ex9.m2.1.1\"><mi id=\"S4.Ex9.m2.1.1.2.2\">P</mi><mi id=\"S4.Ex9.m2.1.1.2.3\">CT</mi><mo id=\"S4.Ex9.m2.1.1.3\">∗</mo></msubsup><mo id=\"S4.Ex9.m2.1.2\">=</mo><mi id=\"S4.Ex9.m2.1.3\">arg</mi><munder id=\"S4.Ex9.m2.1.4\"><mi id=\"S4.Ex9.m2.1.4.2\">min</mi><msub id=\"S4.Ex9.m2.1.4.3\"><mi id=\"S4.Ex9.m2.1.4.3.2\">P</mi><mi id=\"S4.Ex9.m2.1.4.3.3\">CT</mi></msub></munder><mstyle displaystyle=\"true\" id=\"S4.Ex9.m2.1.5\"><munderover id=\"S4.Ex9.m2.1.5a\"><mo id=\"S4.Ex9.m2.1.5.2.2\" movablelimits=\"false\">∑</mo><mrow id=\"S4.Ex9.m2.1.5.2.3\"><mi id=\"S4.Ex9.m2.1.5.2.3.2\">i</mi><mo id=\"S4.Ex9.m2.1.5.2.3.1\">=</mo><mn id=\"S4.Ex9.m2.1.5.2.3.3\">1</mn></mrow><mi id=\"S4.Ex9.m2.1.5.3\">k</mi></munderover></mstyle><mo id=\"S4.Ex9.m2.1.6\">−</mo><mi id=\"S4.Ex9.m2.1.7\">log</mi><msub id=\"S4.Ex9.m2.1.8\"><mi id=\"S4.Ex9.m2.1.8.2\">p</mi><mi id=\"S4.Ex9.m2.1.8.3\">ϕ</mi></msub><mrow id=\"S4.Ex9.m2.1.9\"><mo id=\"S4.Ex9.m2.1.9.1\">(</mo><msub id=\"S4.Ex9.m2.1.9.2\"><mi id=\"S4.Ex9.m2.1.9.2.2\">y</mi><mi id=\"S4.Ex9.m2.1.9.2.3\">i</mi></msub><mo id=\"S4.Ex9.m2.1.9.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S4.Ex9.m2.1.9.4\"><mo id=\"S4.Ex9.m2.1.9.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><mi id=\"S4.Ex9.m2.1.9.4.2\">TokenDrop</mi><mrow id=\"S4.Ex9.m2.1.9.4.3\"><mo id=\"S4.Ex9.m2.1.9.4.3.1\">(</mo><msubsup id=\"S4.Ex9.m2.1.9.4.3.2\"><mi id=\"S4.Ex9.m2.1.9.4.3.2.2.2\">P</mi><mi id=\"S4.Ex9.m2.1.9.4.3.2.2.3\">CT</mi><mrow id=\"S4.Ex9.m2.1.9.4.3.2.3\"><mo id=\"S4.Ex9.m2.1.9.4.3.2.3a\">−</mo><mi id=\"S4.Ex9.m2.1.9.4.3.2.3.2\">i</mi></mrow></msubsup><mo id=\"S4.Ex9.m2.1.9.4.3.3\" rspace=\"0.170em\">)</mo></mrow><mo id=\"S4.Ex9.m2.1.9.4.4\">;</mo><msub id=\"S4.Ex9.m2.1.9.4.5\"><mi id=\"S4.Ex9.m2.1.9.4.5.2\">x</mi><mi id=\"S4.Ex9.m2.1.9.4.5.3\">i</mi></msub><mo id=\"S4.Ex9.m2.1.9.4.6\" stretchy=\"false\">]</mo></mrow><mo id=\"S4.Ex9.m2.1.9.5\">)</mo></mrow><mo id=\"S4.Ex9.m2.1.10\">,</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S4.Ex9.m2.1c\">\\displaystyle P_{\\mathrm{CT}}^{*}=\\arg\\min_{P_{\\mathrm{CT}}}\\sum_{i=1}^{k}-%\n\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,\\mathrm{TokenDrop}\\left(P_{\\mathrm{CT}}^{-i%\n}\\right)\\,;x_{i}]\\right),</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.Ex9.m2.1d\">italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - roman_log italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | [ roman_TokenDrop ( italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT ) ; italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) ,</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n<tbody id=\"S4.Ex10\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><span class=\"ltx_text ltx_markedasmath\" id=\"S4.Ex10.2.1.1.1\"><span class=\"ltx_text ltx_font_italic\" id=\"S4.Ex10.2.1.1.1.1\">CT-KV</span>:</span></td>\n<td class=\"ltx_td ltx_align_left ltx_eqn_cell\"><math alttext=\"\\displaystyle\\Theta_{\\mathrm{CT}}^{*}=\\arg\\min_{\\Theta_{\\mathrm{CT}}}\\sum_{i=1%\n}^{k}-\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,\\mathrm{TokenDrop}\\left(\\Theta_{%\n\\mathrm{CT}}^{-i}\\right)\\,;x_{i}]\\right).\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"S4.Ex10.m2.1\"><semantics id=\"S4.Ex10.m2.1a\"><mrow id=\"S4.Ex10.m2.1b\"><msubsup id=\"S4.Ex10.m2.1.1\"><mi id=\"S4.Ex10.m2.1.1.2.2\" mathvariant=\"normal\">Θ</mi><mi id=\"S4.Ex10.m2.1.1.2.3\">CT</mi><mo id=\"S4.Ex10.m2.1.1.3\">∗</mo></msubsup><mo id=\"S4.Ex10.m2.1.2\">=</mo><mi id=\"S4.Ex10.m2.1.3\">arg</mi><munder id=\"S4.Ex10.m2.1.4\"><mi id=\"S4.Ex10.m2.1.4.2\">min</mi><msub id=\"S4.Ex10.m2.1.4.3\"><mi id=\"S4.Ex10.m2.1.4.3.2\" mathvariant=\"normal\">Θ</mi><mi id=\"S4.Ex10.m2.1.4.3.3\">CT</mi></msub></munder><mstyle displaystyle=\"true\" id=\"S4.Ex10.m2.1.5\"><munderover id=\"S4.Ex10.m2.1.5a\"><mo id=\"S4.Ex10.m2.1.5.2.2\" movablelimits=\"false\">∑</mo><mrow id=\"S4.Ex10.m2.1.5.2.3\"><mi id=\"S4.Ex10.m2.1.5.2.3.2\">i</mi><mo id=\"S4.Ex10.m2.1.5.2.3.1\">=</mo><mn id=\"S4.Ex10.m2.1.5.2.3.3\">1</mn></mrow><mi id=\"S4.Ex10.m2.1.5.3\">k</mi></munderover></mstyle><mo id=\"S4.Ex10.m2.1.6\">−</mo><mi id=\"S4.Ex10.m2.1.7\">log</mi><msub id=\"S4.Ex10.m2.1.8\"><mi id=\"S4.Ex10.m2.1.8.2\">p</mi><mi id=\"S4.Ex10.m2.1.8.3\">ϕ</mi></msub><mrow id=\"S4.Ex10.m2.1.9\"><mo id=\"S4.Ex10.m2.1.9.1\">(</mo><msub id=\"S4.Ex10.m2.1.9.2\"><mi id=\"S4.Ex10.m2.1.9.2.2\">y</mi><mi id=\"S4.Ex10.m2.1.9.2.3\">i</mi></msub><mo id=\"S4.Ex10.m2.1.9.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S4.Ex10.m2.1.9.4\"><mo id=\"S4.Ex10.m2.1.9.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><mi id=\"S4.Ex10.m2.1.9.4.2\">TokenDrop</mi><mrow id=\"S4.Ex10.m2.1.9.4.3\"><mo id=\"S4.Ex10.m2.1.9.4.3.1\">(</mo><msubsup id=\"S4.Ex10.m2.1.9.4.3.2\"><mi id=\"S4.Ex10.m2.1.9.4.3.2.2.2\" mathvariant=\"normal\">Θ</mi><mi id=\"S4.Ex10.m2.1.9.4.3.2.2.3\">CT</mi><mrow id=\"S4.Ex10.m2.1.9.4.3.2.3\"><mo id=\"S4.Ex10.m2.1.9.4.3.2.3a\">−</mo><mi id=\"S4.Ex10.m2.1.9.4.3.2.3.2\">i</mi></mrow></msubsup><mo id=\"S4.Ex10.m2.1.9.4.3.3\" rspace=\"0.170em\">)</mo></mrow><mo id=\"S4.Ex10.m2.1.9.4.4\">;</mo><msub id=\"S4.Ex10.m2.1.9.4.5\"><mi id=\"S4.Ex10.m2.1.9.4.5.2\">x</mi><mi id=\"S4.Ex10.m2.1.9.4.5.3\">i</mi></msub><mo id=\"S4.Ex10.m2.1.9.4.6\" stretchy=\"false\">]</mo></mrow><mo id=\"S4.Ex10.m2.1.9.5\">)</mo></mrow><mo id=\"S4.Ex10.m2.1.10\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"S4.Ex10.m2.1c\">\\displaystyle\\Theta_{\\mathrm{CT}}^{*}=\\arg\\min_{\\Theta_{\\mathrm{CT}}}\\sum_{i=1%\n}^{k}-\\log p_{\\phi}\\left(y_{i}\\bigm{|}[\\,\\mathrm{TokenDrop}\\left(\\Theta_{%\n\\mathrm{CT}}^{-i}\\right)\\,;x_{i}]\\right).</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.Ex10.m2.1d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT - roman_log italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | [ roman_TokenDrop ( roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - italic_i end_POSTSUPERSCRIPT ) ; italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n<div class=\"ltx_para ltx_noindent\" id=\"S4.SS3.SSS0.Px2.p3\">\n<p class=\"ltx_p\" id=\"S4.SS3.SSS0.Px2.p3.1\">To perform inference on the query <math alttext=\"x_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px2.p3.1.m1.1\"><semantics id=\"S4.SS3.SSS0.Px2.p3.1.m1.1a\"><msub id=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1\" xref=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.2\" xref=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.2.cmml\">x</mi><mi id=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.3\" xref=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px2.p3.1.m1.1b\"><apply id=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.2\">𝑥</ci><ci id=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px2.p3.1.m1.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px2.p3.1.m1.1c\">x_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px2.p3.1.m1.1d\">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p3.1.1\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p3.1.2\">CT-KV</span> use their respective optimized contexts:</p>\n<table class=\"ltx_equationgroup ltx_eqn_align ltx_eqn_table\" id=\"A7.EGx2\">\n<tbody id=\"S4.Ex11\"><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_td ltx_align_right ltx_eqn_cell\"><math alttext=\"\\displaystyle\\begin{aligned} \\text{{\\it CT-Prompt}{}:}\\quad&amp;\\hat{y}_{q}=\\arg%\n\\max_{y}\\,p_{\\phi}\\left(y\\bigm{|}[\\,P_{\\mathrm{CT}}^{*}\\,;x_{q}\\,]\\right),\\\\\n\\text{{\\it CT-KV}{}:}\\quad&amp;\\hat{y}_{q}=\\arg\\max_{y}\\,p_{\\phi}\\left(y\\bigm{|}[%\n\\,\\Theta_{\\mathrm{CT}}^{*}\\,;x_{q}\\,]\\right).\\end{aligned}\" class=\"ltx_math_unparsed\" display=\"inline\" id=\"S4.Ex11.m1.1\"><semantics id=\"S4.Ex11.m1.1a\"><mtable columnspacing=\"0pt\" id=\"S4.Ex11.m1.1.1\" rowspacing=\"0pt\"><mtr id=\"S4.Ex11.m1.1.1a\"><mtd class=\"ltx_align_right\" columnalign=\"right\" id=\"S4.Ex11.m1.1.1b\"><mrow id=\"S4.Ex11.m1.1.1.1.1.1\"><mtext class=\"ltx_mathvariant_italic\" id=\"S4.Ex11.m1.1.1.1.1.1a\">CT-Prompt</mtext><mtext id=\"S4.Ex11.m1.1.1.1.1.1b\">:</mtext></mrow></mtd><mtd class=\"ltx_align_left\" columnalign=\"left\" id=\"S4.Ex11.m1.1.1c\"><mrow id=\"S4.Ex11.m1.1.1.1.2.1\"><msub id=\"S4.Ex11.m1.1.1.1.2.1.1\"><mover accent=\"true\" id=\"S4.Ex11.m1.1.1.1.2.1.1.2\"><mi id=\"S4.Ex11.m1.1.1.1.2.1.1.2.2\">y</mi><mo id=\"S4.Ex11.m1.1.1.1.2.1.1.2.1\">^</mo></mover><mi id=\"S4.Ex11.m1.1.1.1.2.1.1.3\">q</mi></msub><mo id=\"S4.Ex11.m1.1.1.1.2.1.2\">=</mo><mi id=\"S4.Ex11.m1.1.1.1.2.1.3\">arg</mi><munder id=\"S4.Ex11.m1.1.1.1.2.1.4\"><mi id=\"S4.Ex11.m1.1.1.1.2.1.4.2\">max</mi><mi id=\"S4.Ex11.m1.1.1.1.2.1.4.3\">y</mi></munder><msub id=\"S4.Ex11.m1.1.1.1.2.1.5\"><mi id=\"S4.Ex11.m1.1.1.1.2.1.5.2\">p</mi><mi id=\"S4.Ex11.m1.1.1.1.2.1.5.3\">ϕ</mi></msub><mrow id=\"S4.Ex11.m1.1.1.1.2.1.6\"><mo id=\"S4.Ex11.m1.1.1.1.2.1.6.1\">(</mo><mi id=\"S4.Ex11.m1.1.1.1.2.1.6.2\">y</mi><mo id=\"S4.Ex11.m1.1.1.1.2.1.6.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S4.Ex11.m1.1.1.1.2.1.6.4\"><mo id=\"S4.Ex11.m1.1.1.1.2.1.6.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><msubsup id=\"S4.Ex11.m1.1.1.1.2.1.6.4.2\"><mi id=\"S4.Ex11.m1.1.1.1.2.1.6.4.2.2.2\">P</mi><mi id=\"S4.Ex11.m1.1.1.1.2.1.6.4.2.2.3\">CT</mi><mo id=\"S4.Ex11.m1.1.1.1.2.1.6.4.2.3\">∗</mo></msubsup><mo id=\"S4.Ex11.m1.1.1.1.2.1.6.4.3\">;</mo><msub id=\"S4.Ex11.m1.1.1.1.2.1.6.4.4\"><mi id=\"S4.Ex11.m1.1.1.1.2.1.6.4.4.2\">x</mi><mi id=\"S4.Ex11.m1.1.1.1.2.1.6.4.4.3\">q</mi></msub><mo id=\"S4.Ex11.m1.1.1.1.2.1.6.4.5\" stretchy=\"false\">]</mo></mrow><mo id=\"S4.Ex11.m1.1.1.1.2.1.6.5\">)</mo></mrow><mo id=\"S4.Ex11.m1.1.1.1.2.1.7\">,</mo></mrow></mtd></mtr><mtr id=\"S4.Ex11.m1.1.1d\"><mtd class=\"ltx_align_right\" columnalign=\"right\" id=\"S4.Ex11.m1.1.1e\"><mrow id=\"S4.Ex11.m1.1.1.2.1.1\"><mtext class=\"ltx_mathvariant_italic\" id=\"S4.Ex11.m1.1.1.2.1.1a\">CT-KV</mtext><mtext id=\"S4.Ex11.m1.1.1.2.1.1b\">:</mtext></mrow></mtd><mtd class=\"ltx_align_left\" columnalign=\"left\" id=\"S4.Ex11.m1.1.1f\"><mrow id=\"S4.Ex11.m1.1.1.2.2.1\"><msub id=\"S4.Ex11.m1.1.1.2.2.1.1\"><mover accent=\"true\" id=\"S4.Ex11.m1.1.1.2.2.1.1.2\"><mi id=\"S4.Ex11.m1.1.1.2.2.1.1.2.2\">y</mi><mo id=\"S4.Ex11.m1.1.1.2.2.1.1.2.1\">^</mo></mover><mi id=\"S4.Ex11.m1.1.1.2.2.1.1.3\">q</mi></msub><mo id=\"S4.Ex11.m1.1.1.2.2.1.2\">=</mo><mi id=\"S4.Ex11.m1.1.1.2.2.1.3\">arg</mi><munder id=\"S4.Ex11.m1.1.1.2.2.1.4\"><mi id=\"S4.Ex11.m1.1.1.2.2.1.4.2\">max</mi><mi id=\"S4.Ex11.m1.1.1.2.2.1.4.3\">y</mi></munder><msub id=\"S4.Ex11.m1.1.1.2.2.1.5\"><mi id=\"S4.Ex11.m1.1.1.2.2.1.5.2\">p</mi><mi id=\"S4.Ex11.m1.1.1.2.2.1.5.3\">ϕ</mi></msub><mrow id=\"S4.Ex11.m1.1.1.2.2.1.6\"><mo id=\"S4.Ex11.m1.1.1.2.2.1.6.1\">(</mo><mi id=\"S4.Ex11.m1.1.1.2.2.1.6.2\">y</mi><mo id=\"S4.Ex11.m1.1.1.2.2.1.6.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><mrow id=\"S4.Ex11.m1.1.1.2.2.1.6.4\"><mo id=\"S4.Ex11.m1.1.1.2.2.1.6.4.1\" rspace=\"0.170em\" stretchy=\"false\">[</mo><msubsup id=\"S4.Ex11.m1.1.1.2.2.1.6.4.2\"><mi id=\"S4.Ex11.m1.1.1.2.2.1.6.4.2.2.2\" mathvariant=\"normal\">Θ</mi><mi id=\"S4.Ex11.m1.1.1.2.2.1.6.4.2.2.3\">CT</mi><mo id=\"S4.Ex11.m1.1.1.2.2.1.6.4.2.3\">∗</mo></msubsup><mo id=\"S4.Ex11.m1.1.1.2.2.1.6.4.3\">;</mo><msub id=\"S4.Ex11.m1.1.1.2.2.1.6.4.4\"><mi id=\"S4.Ex11.m1.1.1.2.2.1.6.4.4.2\">x</mi><mi id=\"S4.Ex11.m1.1.1.2.2.1.6.4.4.3\">q</mi></msub><mo id=\"S4.Ex11.m1.1.1.2.2.1.6.4.5\" stretchy=\"false\">]</mo></mrow><mo id=\"S4.Ex11.m1.1.1.2.2.1.6.5\">)</mo></mrow><mo id=\"S4.Ex11.m1.1.1.2.2.1.7\" lspace=\"0em\">.</mo></mrow></mtd></mtr></mtable><annotation encoding=\"application/x-tex\" id=\"S4.Ex11.m1.1b\">\\displaystyle\\begin{aligned} \\text{{\\it CT-Prompt}{}:}\\quad&amp;\\hat{y}_{q}=\\arg%\n\\max_{y}\\,p_{\\phi}\\left(y\\bigm{|}[\\,P_{\\mathrm{CT}}^{*}\\,;x_{q}\\,]\\right),\\\\\n\\text{{\\it CT-KV}{}:}\\quad&amp;\\hat{y}_{q}=\\arg\\max_{y}\\,p_{\\phi}\\left(y\\bigm{|}[%\n\\,\\Theta_{\\mathrm{CT}}^{*}\\,;x_{q}\\,]\\right).\\end{aligned}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.Ex11.m1.1c\">start_ROW start_CELL italic_CT-Prompt : end_CELL start_CELL over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y | [ italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ; italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] ) , end_CELL end_ROW start_ROW start_CELL italic_CT-KV : end_CELL start_CELL over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y | [ roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ; italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] ) . end_CELL end_ROW</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n<div class=\"ltx_para\" id=\"S4.SS3.SSS0.Px2.p4\">\n<p class=\"ltx_p\" id=\"S4.SS3.SSS0.Px2.p4.3\">In practice, <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p4.3.1\">CT-Prompt</span> requires recomputing layer-wise keys and values corresponding to <math alttext=\"P_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px2.p4.1.m1.1\"><semantics id=\"S4.SS3.SSS0.Px2.p4.1.m1.1a\"><msub id=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1\" xref=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.2\" xref=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.2.cmml\">P</mi><mi id=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.3\" xref=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.3.cmml\">CT</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px2.p4.1.m1.1b\"><apply id=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.2\">𝑃</ci><ci id=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.1.m1.1.1.3\">CT</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px2.p4.1.m1.1c\">P_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px2.p4.1.m1.1d\">italic_P start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math>, while <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p4.3.2\">CT-KV</span> does not for <math alttext=\"\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px2.p4.2.m2.1\"><semantics id=\"S4.SS3.SSS0.Px2.p4.2.m2.1a\"><msub id=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1\" xref=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.cmml\"><mi id=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.2\" mathvariant=\"normal\" xref=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.2.cmml\">Θ</mi><mi id=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.3\" xref=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.3.cmml\">CT</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px2.p4.2.m2.1b\"><apply id=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1\">subscript</csymbol><ci id=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.2.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.2\">Θ</ci><ci id=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.3.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.2.m2.1.1.3\">CT</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px2.p4.2.m2.1c\">\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px2.p4.2.m2.1d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math>. In the Appendix, we formally prove that for each optimization step, <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p4.3.3\">CT-KV</span> has lower time complexity than both TTT and <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p4.3.4\">CT-Prompt</span> with respect to the number of demonstration pairs. Finally, we introduce TTT+<span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p4.3.5\">CT-KV</span>, which first performs TTT to update model weights <math alttext=\"\\phi\" class=\"ltx_Math\" display=\"inline\" id=\"S4.SS3.SSS0.Px2.p4.3.m3.1\"><semantics id=\"S4.SS3.SSS0.Px2.p4.3.m3.1a\"><mi id=\"S4.SS3.SSS0.Px2.p4.3.m3.1.1\" xref=\"S4.SS3.SSS0.Px2.p4.3.m3.1.1.cmml\">ϕ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S4.SS3.SSS0.Px2.p4.3.m3.1b\"><ci id=\"S4.SS3.SSS0.Px2.p4.3.m3.1.1.cmml\" xref=\"S4.SS3.SSS0.Px2.p4.3.m3.1.1\">italic-ϕ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S4.SS3.SSS0.Px2.p4.3.m3.1c\">\\phi</annotation><annotation encoding=\"application/x-llamapun\" id=\"S4.SS3.SSS0.Px2.p4.3.m3.1d\">italic_ϕ</annotation></semantics></math>, then applies <span class=\"ltx_text ltx_font_italic\" id=\"S4.SS3.SSS0.Px2.p4.3.6\">CT-KV</span> to refine the model’s demonstration context for improved performance.</p>\n</div>\n</section>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"S5\">\n<h2 class=\"ltx_title ltx_title_section\">\n<span class=\"ltx_tag ltx_tag_section\">5 </span>Experiments</h2>\n<section class=\"ltx_subsection\" id=\"S5.SS1\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">5.1 </span>Datasets</h3>\n<div class=\"ltx_para\" id=\"S5.SS1.p1\">\n<p class=\"ltx_p\" id=\"S5.SS1.p1.1\">We evaluate on a diverse set of challenging datasets for pretrained LLMs. We show a representative task example for each dataset in Figure <a class=\"ltx_ref\" href=\"#S5.F3\" title=\"Figure 3 ‣ 5.1 Datasets ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">3</span></a>.</p>\n<ul class=\"ltx_itemize\" id=\"S5.I1\">\n<li class=\"ltx_item\" id=\"S5.I1.i1\" style=\"list-style-type:none;\">\n<span class=\"ltx_tag ltx_tag_item\">•</span>\n<div class=\"ltx_para\" id=\"S5.I1.i1.p1\">\n<p class=\"ltx_p\" id=\"S5.I1.i1.p1.1\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.I1.i1.p1.1.1\">NLP-LR</span> is the low-resource dataset split introduced by <cite class=\"ltx_cite ltx_citemacro_citet\">Min et al., <a class=\"ltx_ref\" href=\"#bib.bib36\" title=\"\">2022a</a> </cite>, encompassing over 26 NLP tasks from CrossFit <cite class=\"ltx_cite ltx_citemacro_citep\">(Ye et al., <a class=\"ltx_ref\" href=\"#bib.bib50\" title=\"\">2021</a>)</cite> and UnifiedQA <cite class=\"ltx_cite ltx_citemacro_citep\">(Khashabi et al., <a class=\"ltx_ref\" href=\"#bib.bib25\" title=\"\">2020</a>)</cite>, such as sentiment analysis and paraphrasing. Following <cite class=\"ltx_cite ltx_citemacro_citet\">Min et al., <a class=\"ltx_ref\" href=\"#bib.bib36\" title=\"\">2022a</a> </cite>, we sample <math alttext=\"k=16\" class=\"ltx_Math\" display=\"inline\" id=\"S5.I1.i1.p1.1.m1.1\"><semantics id=\"S5.I1.i1.p1.1.m1.1a\"><mrow id=\"S5.I1.i1.p1.1.m1.1.1\" xref=\"S5.I1.i1.p1.1.m1.1.1.cmml\"><mi id=\"S5.I1.i1.p1.1.m1.1.1.2\" xref=\"S5.I1.i1.p1.1.m1.1.1.2.cmml\">k</mi><mo id=\"S5.I1.i1.p1.1.m1.1.1.1\" xref=\"S5.I1.i1.p1.1.m1.1.1.1.cmml\">=</mo><mn id=\"S5.I1.i1.p1.1.m1.1.1.3\" xref=\"S5.I1.i1.p1.1.m1.1.1.3.cmml\">16</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.I1.i1.p1.1.m1.1b\"><apply id=\"S5.I1.i1.p1.1.m1.1.1.cmml\" xref=\"S5.I1.i1.p1.1.m1.1.1\"><eq id=\"S5.I1.i1.p1.1.m1.1.1.1.cmml\" xref=\"S5.I1.i1.p1.1.m1.1.1.1\"></eq><ci id=\"S5.I1.i1.p1.1.m1.1.1.2.cmml\" xref=\"S5.I1.i1.p1.1.m1.1.1.2\">𝑘</ci><cn id=\"S5.I1.i1.p1.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"S5.I1.i1.p1.1.m1.1.1.3\">16</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.I1.i1.p1.1.m1.1c\">k=16</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.I1.i1.p1.1.m1.1d\">italic_k = 16</annotation></semantics></math> demonstration pairs per task and evaluate task instances as multiple-choice problems.</p>\n</div>\n</li>\n<li class=\"ltx_item\" id=\"S5.I1.i2\" style=\"list-style-type:none;\">\n<span class=\"ltx_tag ltx_tag_item\">•</span>\n<div class=\"ltx_para\" id=\"S5.I1.i2.p1\">\n<p class=\"ltx_p\" id=\"S5.I1.i2.p1.1\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.I1.i2.p1.1.1\">Massive Multitask Language Understanding (MMLU)</span> is a diverse benchmark consisting of 57 subject-specific tasks, including mathematics, history, law, and various other domains <cite class=\"ltx_cite ltx_citemacro_citep\">(Hendrycks et al., <a class=\"ltx_ref\" href=\"#bib.bib19\" title=\"\">2021</a>)</cite>. We sample <math alttext=\"k=16\" class=\"ltx_Math\" display=\"inline\" id=\"S5.I1.i2.p1.1.m1.1\"><semantics id=\"S5.I1.i2.p1.1.m1.1a\"><mrow id=\"S5.I1.i2.p1.1.m1.1.1\" xref=\"S5.I1.i2.p1.1.m1.1.1.cmml\"><mi id=\"S5.I1.i2.p1.1.m1.1.1.2\" xref=\"S5.I1.i2.p1.1.m1.1.1.2.cmml\">k</mi><mo id=\"S5.I1.i2.p1.1.m1.1.1.1\" xref=\"S5.I1.i2.p1.1.m1.1.1.1.cmml\">=</mo><mn id=\"S5.I1.i2.p1.1.m1.1.1.3\" xref=\"S5.I1.i2.p1.1.m1.1.1.3.cmml\">16</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.I1.i2.p1.1.m1.1b\"><apply id=\"S5.I1.i2.p1.1.m1.1.1.cmml\" xref=\"S5.I1.i2.p1.1.m1.1.1\"><eq id=\"S5.I1.i2.p1.1.m1.1.1.1.cmml\" xref=\"S5.I1.i2.p1.1.m1.1.1.1\"></eq><ci id=\"S5.I1.i2.p1.1.m1.1.1.2.cmml\" xref=\"S5.I1.i2.p1.1.m1.1.1.2\">𝑘</ci><cn id=\"S5.I1.i2.p1.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"S5.I1.i2.p1.1.m1.1.1.3\">16</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.I1.i2.p1.1.m1.1c\">k=16</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.I1.i2.p1.1.m1.1d\">italic_k = 16</annotation></semantics></math> demonstration pairs per task and evaluate task instances as multiple-choice problems.</p>\n</div>\n</li>\n<li class=\"ltx_item\" id=\"S5.I1.i3\" style=\"list-style-type:none;\">\n<span class=\"ltx_tag ltx_tag_item\">•</span>\n<div class=\"ltx_para\" id=\"S5.I1.i3.p1\">\n<p class=\"ltx_p\" id=\"S5.I1.i3.p1.1\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.I1.i3.p1.1.1\">BIG-Bench Hard (BBH)</span> is a curated subset of BIG-Bench, consisting of 27 tasks across 23 task types that challenge pretrained LLMs with questions involving algorithmic puzzles, symbolic manipulation, and other complex reasoning domains <cite class=\"ltx_cite ltx_citemacro_citep\">(Srivastava et al., <a class=\"ltx_ref\" href=\"#bib.bib44\" title=\"\">2023</a>; Suzgun et al., <a class=\"ltx_ref\" href=\"#bib.bib46\" title=\"\">2022</a>)</cite>. Following <cite class=\"ltx_cite ltx_citemacro_citet\">Akyürek et al., (<a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite>, we sample <math alttext=\"k=10\" class=\"ltx_Math\" display=\"inline\" id=\"S5.I1.i3.p1.1.m1.1\"><semantics id=\"S5.I1.i3.p1.1.m1.1a\"><mrow id=\"S5.I1.i3.p1.1.m1.1.1\" xref=\"S5.I1.i3.p1.1.m1.1.1.cmml\"><mi id=\"S5.I1.i3.p1.1.m1.1.1.2\" xref=\"S5.I1.i3.p1.1.m1.1.1.2.cmml\">k</mi><mo id=\"S5.I1.i3.p1.1.m1.1.1.1\" xref=\"S5.I1.i3.p1.1.m1.1.1.1.cmml\">=</mo><mn id=\"S5.I1.i3.p1.1.m1.1.1.3\" xref=\"S5.I1.i3.p1.1.m1.1.1.3.cmml\">10</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.I1.i3.p1.1.m1.1b\"><apply id=\"S5.I1.i3.p1.1.m1.1.1.cmml\" xref=\"S5.I1.i3.p1.1.m1.1.1\"><eq id=\"S5.I1.i3.p1.1.m1.1.1.1.cmml\" xref=\"S5.I1.i3.p1.1.m1.1.1.1\"></eq><ci id=\"S5.I1.i3.p1.1.m1.1.1.2.cmml\" xref=\"S5.I1.i3.p1.1.m1.1.1.2\">𝑘</ci><cn id=\"S5.I1.i3.p1.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"S5.I1.i3.p1.1.m1.1.1.3\">10</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.I1.i3.p1.1.m1.1c\">k=10</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.I1.i3.p1.1.m1.1d\">italic_k = 10</annotation></semantics></math> demonstration pairs per task and prepend trainable instructions to all of our methods. We evaluate these tasks as question-answering problems.</p>\n</div>\n</li>\n<li class=\"ltx_item\" id=\"S5.I1.i4\" style=\"list-style-type:none;\">\n<span class=\"ltx_tag ltx_tag_item\">•</span>\n<div class=\"ltx_para\" id=\"S5.I1.i4.p1\">\n<p class=\"ltx_p\" id=\"S5.I1.i4.p1.1\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.I1.i4.p1.1.1\">Abstraction and Reasoning Corpus (ARC)</span> is a challenging symbolic reasoning benchmark with 400 evaluation tasks, each defined by a few grid transformation pairs and one or more query input grids <cite class=\"ltx_cite ltx_citemacro_citep\">(Chollet, <a class=\"ltx_ref\" href=\"#bib.bib6\" title=\"\">2019b</a>)</cite>. Since the average number of available demonstration pairs is fewer than 4, we use all of them in context. Tasks are evaluated as question-answering problems.</p>\n</div>\n</li>\n</ul>\n</div>\n<div class=\"ltx_para\" id=\"S5.SS1.p2\">\n<p class=\"ltx_p\" id=\"S5.SS1.p2.1\">Each dataset is formatted either as a multiple-choice task or a question-answering task. For multiple-choice problems, where the LLM must select an output from a predefined set of answers, we follow <cite class=\"ltx_cite ltx_citemacro_citet\">Min et al., <a class=\"ltx_ref\" href=\"#bib.bib36\" title=\"\">2022a</a> </cite> and choose the option with the lowest loss. For question-answering tasks, the LLM has to generate an answer that matches the ground-truth output.</p>\n</div>\n<figure class=\"ltx_figure\" id=\"S5.F3\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"335\" id=\"S5.F3.g1\" src=\"./assets/x3.png\" width=\"598\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 3: </span>\nOne test pair from BBH, NLP-LR, and MMLU each, and 3 demonstration pairs followed by a test pair from ARC. BBH contains instructions that we prepend to model inputs. NLP-LR and MMLU contain multiple-choice options for the model to select. To avoid clutter, we show demonstration pairs from BBH, NLP-LR, and MMLU in the Appendix.\n</figcaption>\n</figure>\n</section>\n<section class=\"ltx_subsection\" id=\"S5.SS2\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">5.2 </span>Models</h3>\n<div class=\"ltx_para\" id=\"S5.SS2.p1\">\n<p class=\"ltx_p\" id=\"S5.SS2.p1.1\">Following <cite class=\"ltx_cite ltx_citemacro_citet\">Min et al., <a class=\"ltx_ref\" href=\"#bib.bib36\" title=\"\">2022a</a> </cite> and <cite class=\"ltx_cite ltx_citemacro_citet\">Akyürek et al., (<a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite>, we use GPT-2 and Llama3-8B for NLP-LR and BBH, respectively. To demonstrate that <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS2.p1.1.1\">Context Tuning</span> performs well across different model sizes, we select Llama3.2-3B for MMLU. Due to computational constraints, we use Llama3.2-1B for ARC, which requires handling long input sequences. Since the pretrained Llama3.2-1B model cannot solve any of the 400 ARC evaluation tasks, we follow <cite class=\"ltx_cite ltx_citemacro_citet\">Akyürek et al., (<a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite> and <cite class=\"ltx_cite ltx_citemacro_citet\">Franzen et al., (<a class=\"ltx_ref\" href=\"#bib.bib13\" title=\"\">2024</a>)</cite> by fine-tuning it on the ARC training split, which contains 400 tasks that do not overlap with the evaluation split. While the works of <cite class=\"ltx_cite ltx_citemacro_citet\">Franzen et al., (<a class=\"ltx_ref\" href=\"#bib.bib13\" title=\"\">2024</a>)</cite> and <cite class=\"ltx_cite ltx_citemacro_citet\">Akyürek et al., (<a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite> focus on achieving high scores in the ARC competition <cite class=\"ltx_cite ltx_citemacro_citep\">(Chollet et al., <a class=\"ltx_ref\" href=\"#bib.bib7\" title=\"\">2025</a>)</cite>, our goal is to develop a method applicable across general few-shot problems. Therefore, we do not perform augmentation or voting for ARC. All pretrained model checkpoints were obtained from HuggingFace.</p>\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S5.SS3\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">5.3 </span>Experiment Setup</h3>\n<div class=\"ltx_para\" id=\"S5.SS3.p1\">\n<p class=\"ltx_p\" id=\"S5.SS3.p1.1\">On top of zero-shot inference and ICL, we compare a variety of few-shot learning techniques to conduct a broad investigation of prompt-based adaptation strategies and methods under the <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS3.p1.1.1\">In-Context Optimization</span> framework: Prompt Tuning, Prefix Tuning, TTT, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS3.p1.1.2\">CT-Prompt</span>, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS3.p1.1.3\">CT-KV</span>, and TTT+<span class=\"ltx_text ltx_font_italic\" id=\"S5.SS3.p1.1.4\">CT-KV</span>. We use greedy decoding for all question-answering tasks. All experiments in Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a> are run over 5 different sets of randomly selected demonstration pairs, except for ARC, which has a fixed set of demonstration pairs for each task.</p>\n</div>\n<div class=\"ltx_para\" id=\"S5.SS3.p2\">\n<p class=\"ltx_p\" id=\"S5.SS3.p2.1\">For Prompt Tuning and Prefix Tuning, we either set the number of trainable tokens <math alttext=\"m\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS3.p2.1.m1.1\"><semantics id=\"S5.SS3.p2.1.m1.1a\"><mi id=\"S5.SS3.p2.1.m1.1.1\" xref=\"S5.SS3.p2.1.m1.1.1.cmml\">m</mi><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS3.p2.1.m1.1b\"><ci id=\"S5.SS3.p2.1.m1.1.1.cmml\" xref=\"S5.SS3.p2.1.m1.1.1\">𝑚</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS3.p2.1.m1.1c\">m</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS3.p2.1.m1.1d\">italic_m</annotation></semantics></math> to 32, or match it to the number of tokens that are in the demonstration pairs used by <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS3.p2.1.1\">Context Tuning</span>. Trainable soft prompts and prefixes are initialized using sampled token embeddings from the model, which we find yields the best baseline performance.</p>\n</div>\n<div class=\"ltx_para\" id=\"S5.SS3.p3\">\n<p class=\"ltx_p\" id=\"S5.SS3.p3.1\">For ARC, we fine-tune our Llama3.2-1B checkpoint following the setup of <cite class=\"ltx_cite ltx_citemacro_citet\">Franzen et al., (<a class=\"ltx_ref\" href=\"#bib.bib13\" title=\"\">2024</a>)</cite>, using 2 A100 GPUs for 24 epochs with a learning rate of <math alttext=\"2\\times 10^{-4}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS3.p3.1.m1.1\"><semantics id=\"S5.SS3.p3.1.m1.1a\"><mrow id=\"S5.SS3.p3.1.m1.1.1\" xref=\"S5.SS3.p3.1.m1.1.1.cmml\"><mn id=\"S5.SS3.p3.1.m1.1.1.2\" xref=\"S5.SS3.p3.1.m1.1.1.2.cmml\">2</mn><mo id=\"S5.SS3.p3.1.m1.1.1.1\" lspace=\"0.222em\" rspace=\"0.222em\" xref=\"S5.SS3.p3.1.m1.1.1.1.cmml\">×</mo><msup id=\"S5.SS3.p3.1.m1.1.1.3\" xref=\"S5.SS3.p3.1.m1.1.1.3.cmml\"><mn id=\"S5.SS3.p3.1.m1.1.1.3.2\" xref=\"S5.SS3.p3.1.m1.1.1.3.2.cmml\">10</mn><mrow id=\"S5.SS3.p3.1.m1.1.1.3.3\" xref=\"S5.SS3.p3.1.m1.1.1.3.3.cmml\"><mo id=\"S5.SS3.p3.1.m1.1.1.3.3a\" xref=\"S5.SS3.p3.1.m1.1.1.3.3.cmml\">−</mo><mn id=\"S5.SS3.p3.1.m1.1.1.3.3.2\" xref=\"S5.SS3.p3.1.m1.1.1.3.3.2.cmml\">4</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS3.p3.1.m1.1b\"><apply id=\"S5.SS3.p3.1.m1.1.1.cmml\" xref=\"S5.SS3.p3.1.m1.1.1\"><times id=\"S5.SS3.p3.1.m1.1.1.1.cmml\" xref=\"S5.SS3.p3.1.m1.1.1.1\"></times><cn id=\"S5.SS3.p3.1.m1.1.1.2.cmml\" type=\"integer\" xref=\"S5.SS3.p3.1.m1.1.1.2\">2</cn><apply id=\"S5.SS3.p3.1.m1.1.1.3.cmml\" xref=\"S5.SS3.p3.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"S5.SS3.p3.1.m1.1.1.3.1.cmml\" xref=\"S5.SS3.p3.1.m1.1.1.3\">superscript</csymbol><cn id=\"S5.SS3.p3.1.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"S5.SS3.p3.1.m1.1.1.3.2\">10</cn><apply id=\"S5.SS3.p3.1.m1.1.1.3.3.cmml\" xref=\"S5.SS3.p3.1.m1.1.1.3.3\"><minus id=\"S5.SS3.p3.1.m1.1.1.3.3.1.cmml\" xref=\"S5.SS3.p3.1.m1.1.1.3.3\"></minus><cn id=\"S5.SS3.p3.1.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"S5.SS3.p3.1.m1.1.1.3.3.2\">4</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS3.p3.1.m1.1c\">2\\times 10^{-4}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS3.p3.1.m1.1d\">2 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, cosine learning rate scheduler, 1 warmup epoch, and a global batch size of 32 (after gradient accumulation). All other experiments are conducted on a single A100 GPU, except NLP-LR, which is run on an RTX8000. For <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS3.p3.1.1\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS3.p3.1.2\">CT-KV</span>, we apply Leave-One-Out Masking from Section <a class=\"ltx_ref\" href=\"#S4\" title=\"4 Context Tuning for In-Context Optimization ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">4</span></a> across all datasets, except ARC, where performance improves without it. We elaborate on this decision in Section <a class=\"ltx_ref\" href=\"#S5.SS5\" title=\"5.5 Ablation Study ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">5.5</span></a>.</p>\n</div>\n<div class=\"ltx_para\" id=\"S5.SS3.p4\">\n<p class=\"ltx_p\" id=\"S5.SS3.p4.2\">For completeness, we also compare alternative setups for both Prompt Tuning and Prefix Tuning. In the Appendix, we report results using uniformly initialized trainable parameters for both methods. We also include results for Prefix Tuning with an MLP parameterization, along with details of our hyperparameter search to support reproducibility. Overall, our evaluation spans a wide range of challenging tasks, model sizes from 1B to 8B parameters, varied numbers of demonstration pairs per task (<math alttext=\"k=2\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS3.p4.1.m1.1\"><semantics id=\"S5.SS3.p4.1.m1.1a\"><mrow id=\"S5.SS3.p4.1.m1.1.1\" xref=\"S5.SS3.p4.1.m1.1.1.cmml\"><mi id=\"S5.SS3.p4.1.m1.1.1.2\" xref=\"S5.SS3.p4.1.m1.1.1.2.cmml\">k</mi><mo id=\"S5.SS3.p4.1.m1.1.1.1\" xref=\"S5.SS3.p4.1.m1.1.1.1.cmml\">=</mo><mn id=\"S5.SS3.p4.1.m1.1.1.3\" xref=\"S5.SS3.p4.1.m1.1.1.3.cmml\">2</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS3.p4.1.m1.1b\"><apply id=\"S5.SS3.p4.1.m1.1.1.cmml\" xref=\"S5.SS3.p4.1.m1.1.1\"><eq id=\"S5.SS3.p4.1.m1.1.1.1.cmml\" xref=\"S5.SS3.p4.1.m1.1.1.1\"></eq><ci id=\"S5.SS3.p4.1.m1.1.1.2.cmml\" xref=\"S5.SS3.p4.1.m1.1.1.2\">𝑘</ci><cn id=\"S5.SS3.p4.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"S5.SS3.p4.1.m1.1.1.3\">2</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS3.p4.1.m1.1c\">k=2</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS3.p4.1.m1.1d\">italic_k = 2</annotation></semantics></math> to <math alttext=\"k=16\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS3.p4.2.m2.1\"><semantics id=\"S5.SS3.p4.2.m2.1a\"><mrow id=\"S5.SS3.p4.2.m2.1.1\" xref=\"S5.SS3.p4.2.m2.1.1.cmml\"><mi id=\"S5.SS3.p4.2.m2.1.1.2\" xref=\"S5.SS3.p4.2.m2.1.1.2.cmml\">k</mi><mo id=\"S5.SS3.p4.2.m2.1.1.1\" xref=\"S5.SS3.p4.2.m2.1.1.1.cmml\">=</mo><mn id=\"S5.SS3.p4.2.m2.1.1.3\" xref=\"S5.SS3.p4.2.m2.1.1.3.cmml\">16</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS3.p4.2.m2.1b\"><apply id=\"S5.SS3.p4.2.m2.1.1.cmml\" xref=\"S5.SS3.p4.2.m2.1.1\"><eq id=\"S5.SS3.p4.2.m2.1.1.1.cmml\" xref=\"S5.SS3.p4.2.m2.1.1.1\"></eq><ci id=\"S5.SS3.p4.2.m2.1.1.2.cmml\" xref=\"S5.SS3.p4.2.m2.1.1.2\">𝑘</ci><cn id=\"S5.SS3.p4.2.m2.1.1.3.cmml\" type=\"integer\" xref=\"S5.SS3.p4.2.m2.1.1.3\">16</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS3.p4.2.m2.1c\">k=16</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS3.p4.2.m2.1d\">italic_k = 16</annotation></semantics></math>), and benchmarks with and without task instructions (e.g., BBH includes instructions, while the others do not).</p>\n</div>\n</section>\n<section class=\"ltx_subsection\" id=\"S5.SS4\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">5.4 </span>Comparing Context Tuning to Baselines</h3>\n<figure class=\"ltx_table\" id=\"S5.T1\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"S5.T1.80\">\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"S5.T1.80.81.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt\" id=\"S5.T1.80.81.1.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.81.1.1.1\" style=\"font-size:90%;\">Method</span></th>\n<td class=\"ltx_td ltx_align_center ltx_border_r ltx_border_tt\" colspan=\"2\" id=\"S5.T1.80.81.1.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.81.1.2.1\" style=\"font-size:90%;\">NLP-LR</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_r ltx_border_tt\" colspan=\"2\" id=\"S5.T1.80.81.1.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.81.1.3.1\" style=\"font-size:90%;\">MMLU</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_r ltx_border_tt\" colspan=\"2\" id=\"S5.T1.80.81.1.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.81.1.4.1\" style=\"font-size:90%;\">BBH</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_tt\" colspan=\"2\" id=\"S5.T1.80.81.1.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.81.1.5.1\" style=\"font-size:90%;\">ARC</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.80.82.2\">\n<th class=\"ltx_td ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.80.82.2.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"></th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"S5.T1.80.82.2.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.2.1\" style=\"font-size:70%;\">Acc. (%)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_r ltx_border_t\" id=\"S5.T1.80.82.2.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.3.1\" style=\"font-size:70%;\">T (s)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"S5.T1.80.82.2.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.4.1\" style=\"font-size:70%;\">Acc. (%)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_r ltx_border_t\" id=\"S5.T1.80.82.2.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.5.1\" style=\"font-size:70%;\">T (s)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"S5.T1.80.82.2.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.6.1\" style=\"font-size:70%;\">Acc. (%)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_r ltx_border_t\" id=\"S5.T1.80.82.2.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.7.1\" style=\"font-size:70%;\">T (s)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"S5.T1.80.82.2.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.8.1\" style=\"font-size:70%;\">Acc. (%)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"S5.T1.80.82.2.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.82.2.9.1\" style=\"font-size:70%;\">T (s)</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.80.83.3\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" colspan=\"9\" id=\"S5.T1.80.83.3.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.83.3.1.1\" style=\"font-size:90%;\">Baselines</span></th>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.8.8\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.8.8.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text\" id=\"S5.T1.8.8.9.1\" style=\"font-size:90%;\">Zero-Shot</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.1.1.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"34.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.62}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.1.1.1.m1.1\"><semantics id=\"S5.T1.1.1.1.m1.1a\"><mrow id=\"S5.T1.1.1.1.m1.1.1\" xref=\"S5.T1.1.1.1.m1.1.1.cmml\"><mn id=\"S5.T1.1.1.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.1.1.1.m1.1.1.2.cmml\">34.9</mn><mo id=\"S5.T1.1.1.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.1.1.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.1.1.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.1.1.1.m1.1.1.3.cmml\"> 0.62</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.1.1.1.m1.1b\"><apply id=\"S5.T1.1.1.1.m1.1.1.cmml\" xref=\"S5.T1.1.1.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.1.1.1.m1.1.1.1.cmml\" xref=\"S5.T1.1.1.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.1.1.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.1.1.1.m1.1.1.2\">34.9</cn><cn id=\"S5.T1.1.1.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.1.1.1.m1.1.1.3\">0.62</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.1.1.1.m1.1c\">34.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.62}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.1.1.1.m1.1d\">34.9 ± 0.62</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.2.2.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.2.2.2.m1.1\"><semantics id=\"S5.T1.2.2.2.m1.1a\"><mn id=\"S5.T1.2.2.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.2.2.2.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.2.2.2.m1.1b\"><cn id=\"S5.T1.2.2.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.2.2.2.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.3.3.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"35.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.71}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.3.3.3.m1.1\"><semantics id=\"S5.T1.3.3.3.m1.1a\"><mrow id=\"S5.T1.3.3.3.m1.1.1\" xref=\"S5.T1.3.3.3.m1.1.1.cmml\"><mn id=\"S5.T1.3.3.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.3.3.3.m1.1.1.2.cmml\">35.8</mn><mo id=\"S5.T1.3.3.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.3.3.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.3.3.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.3.3.3.m1.1.1.3.cmml\"> 0.71</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.3.3.3.m1.1b\"><apply id=\"S5.T1.3.3.3.m1.1.1.cmml\" xref=\"S5.T1.3.3.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.3.3.3.m1.1.1.1.cmml\" xref=\"S5.T1.3.3.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.3.3.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.3.3.3.m1.1.1.2\">35.8</cn><cn id=\"S5.T1.3.3.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.3.3.3.m1.1.1.3\">0.71</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.3.3.3.m1.1c\">35.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.71}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.3.3.3.m1.1d\">35.8 ± 0.71</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.4.4.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.4.4.4.m1.1\"><semantics id=\"S5.T1.4.4.4.m1.1a\"><mn id=\"S5.T1.4.4.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.4.4.4.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.4.4.4.m1.1b\"><cn id=\"S5.T1.4.4.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.4.4.4.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.5.5.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"40.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.43}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.5.5.5.m1.1\"><semantics id=\"S5.T1.5.5.5.m1.1a\"><mrow id=\"S5.T1.5.5.5.m1.1.1\" xref=\"S5.T1.5.5.5.m1.1.1.cmml\"><mn id=\"S5.T1.5.5.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.5.5.5.m1.1.1.2.cmml\">40.9</mn><mo id=\"S5.T1.5.5.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.5.5.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.5.5.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.5.5.5.m1.1.1.3.cmml\"> 0.43</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.5.5.5.m1.1b\"><apply id=\"S5.T1.5.5.5.m1.1.1.cmml\" xref=\"S5.T1.5.5.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.5.5.5.m1.1.1.1.cmml\" xref=\"S5.T1.5.5.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.5.5.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.5.5.5.m1.1.1.2\">40.9</cn><cn id=\"S5.T1.5.5.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.5.5.5.m1.1.1.3\">0.43</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.5.5.5.m1.1c\">40.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.43}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.5.5.5.m1.1d\">40.9 ± 0.43</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.6.6.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.6.6.6.m1.1\"><semantics id=\"S5.T1.6.6.6.m1.1a\"><mn id=\"S5.T1.6.6.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.6.6.6.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.6.6.6.m1.1b\"><cn id=\"S5.T1.6.6.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.6.6.6.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.7.7.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"1.0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.7.7.7.m1.1\"><semantics id=\"S5.T1.7.7.7.m1.1a\"><mn id=\"S5.T1.7.7.7.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.7.7.7.m1.1.1.cmml\">1.0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.7.7.7.m1.1b\"><cn id=\"S5.T1.7.7.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.7.7.7.m1.1.1\">1.0</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.7.7.7.m1.1c\">1.0</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.7.7.7.m1.1d\">1.0</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.8.8.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.8.8.8.m1.1\"><semantics id=\"S5.T1.8.8.8.m1.1a\"><mn id=\"S5.T1.8.8.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.8.8.8.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.8.8.8.m1.1b\"><cn id=\"S5.T1.8.8.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.8.8.8.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.16.16\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.16.16.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text\" id=\"S5.T1.16.16.9.1\" style=\"font-size:90%;\">ICL</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.9.9.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"35.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.65}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.9.9.1.m1.1\"><semantics id=\"S5.T1.9.9.1.m1.1a\"><mrow id=\"S5.T1.9.9.1.m1.1.1\" xref=\"S5.T1.9.9.1.m1.1.1.cmml\"><mn id=\"S5.T1.9.9.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.9.9.1.m1.1.1.2.cmml\">35.6</mn><mo id=\"S5.T1.9.9.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.9.9.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.9.9.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.9.9.1.m1.1.1.3.cmml\"> 0.65</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.9.9.1.m1.1b\"><apply id=\"S5.T1.9.9.1.m1.1.1.cmml\" xref=\"S5.T1.9.9.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.9.9.1.m1.1.1.1.cmml\" xref=\"S5.T1.9.9.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.9.9.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.9.9.1.m1.1.1.2\">35.6</cn><cn id=\"S5.T1.9.9.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.9.9.1.m1.1.1.3\">0.65</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.9.9.1.m1.1c\">35.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.65}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.9.9.1.m1.1d\">35.6 ± 0.65</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.10.10.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.10.10.2.m1.1\"><semantics id=\"S5.T1.10.10.2.m1.1a\"><mn id=\"S5.T1.10.10.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.10.10.2.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.10.10.2.m1.1b\"><cn id=\"S5.T1.10.10.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.10.10.2.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.11.11.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"41.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.57}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.11.11.3.m1.1\"><semantics id=\"S5.T1.11.11.3.m1.1a\"><mrow id=\"S5.T1.11.11.3.m1.1.1\" xref=\"S5.T1.11.11.3.m1.1.1.cmml\"><mn id=\"S5.T1.11.11.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.11.11.3.m1.1.1.2.cmml\">41.2</mn><mo id=\"S5.T1.11.11.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.11.11.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.11.11.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.11.11.3.m1.1.1.3.cmml\"> 0.57</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.11.11.3.m1.1b\"><apply id=\"S5.T1.11.11.3.m1.1.1.cmml\" xref=\"S5.T1.11.11.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.11.11.3.m1.1.1.1.cmml\" xref=\"S5.T1.11.11.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.11.11.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.11.11.3.m1.1.1.2\">41.2</cn><cn id=\"S5.T1.11.11.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.11.11.3.m1.1.1.3\">0.57</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.11.11.3.m1.1c\">41.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.57}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.11.11.3.m1.1d\">41.2 ± 0.57</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.12.12.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.12.12.4.m1.1\"><semantics id=\"S5.T1.12.12.4.m1.1a\"><mn id=\"S5.T1.12.12.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.12.12.4.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.12.12.4.m1.1b\"><cn id=\"S5.T1.12.12.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.12.12.4.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.13.13.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"50.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.78}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.13.13.5.m1.1\"><semantics id=\"S5.T1.13.13.5.m1.1a\"><mrow id=\"S5.T1.13.13.5.m1.1.1\" xref=\"S5.T1.13.13.5.m1.1.1.cmml\"><mn id=\"S5.T1.13.13.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.13.13.5.m1.1.1.2.cmml\">50.4</mn><mo id=\"S5.T1.13.13.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.13.13.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.13.13.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.13.13.5.m1.1.1.3.cmml\"> 0.78</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.13.13.5.m1.1b\"><apply id=\"S5.T1.13.13.5.m1.1.1.cmml\" xref=\"S5.T1.13.13.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.13.13.5.m1.1.1.1.cmml\" xref=\"S5.T1.13.13.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.13.13.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.13.13.5.m1.1.1.2\">50.4</cn><cn id=\"S5.T1.13.13.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.13.13.5.m1.1.1.3\">0.78</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.13.13.5.m1.1c\">50.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.78}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.13.13.5.m1.1d\">50.4 ± 0.78</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.14.14.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.14.14.6.m1.1\"><semantics id=\"S5.T1.14.14.6.m1.1a\"><mn id=\"S5.T1.14.14.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.14.14.6.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.14.14.6.m1.1b\"><cn id=\"S5.T1.14.14.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.14.14.6.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.15.15.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"13.3\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.15.15.7.m1.1\"><semantics id=\"S5.T1.15.15.7.m1.1a\"><mn id=\"S5.T1.15.15.7.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.15.15.7.m1.1.1.cmml\">13.3</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.15.15.7.m1.1b\"><cn id=\"S5.T1.15.15.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.15.15.7.m1.1.1\">13.3</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.15.15.7.m1.1c\">13.3</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.15.15.7.m1.1d\">13.3</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.16.16.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.16.16.8.m1.1\"><semantics id=\"S5.T1.16.16.8.m1.1a\"><mn id=\"S5.T1.16.16.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.16.16.8.m1.1.1.cmml\">0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.16.16.8.m1.1b\"><cn id=\"S5.T1.16.16.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.16.16.8.m1.1.1\">0</cn></annotation-xml></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.24.24\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.24.24.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text\" id=\"S5.T1.24.24.9.1\" style=\"font-size:90%;\">Prompt Tuning (m = 32)</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.17.17.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"41.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.02}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.17.17.1.m1.1\"><semantics id=\"S5.T1.17.17.1.m1.1a\"><mrow id=\"S5.T1.17.17.1.m1.1.1\" xref=\"S5.T1.17.17.1.m1.1.1.cmml\"><mn id=\"S5.T1.17.17.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.17.17.1.m1.1.1.2.cmml\">41.4</mn><mo id=\"S5.T1.17.17.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.17.17.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.17.17.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.17.17.1.m1.1.1.3.cmml\"> 1.02</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.17.17.1.m1.1b\"><apply id=\"S5.T1.17.17.1.m1.1.1.cmml\" xref=\"S5.T1.17.17.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.17.17.1.m1.1.1.1.cmml\" xref=\"S5.T1.17.17.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.17.17.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.17.17.1.m1.1.1.2\">41.4</cn><cn id=\"S5.T1.17.17.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.17.17.1.m1.1.1.3\">1.02</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.17.17.1.m1.1c\">41.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.02}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.17.17.1.m1.1d\">41.4 ± 1.02</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.18.18.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"147\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.18.18.2.m1.1\"><semantics id=\"S5.T1.18.18.2.m1.1a\"><mn id=\"S5.T1.18.18.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.18.18.2.m1.1.1.cmml\">147</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.18.18.2.m1.1b\"><cn id=\"S5.T1.18.18.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.18.18.2.m1.1.1\">147</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.18.18.2.m1.1c\">147</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.18.18.2.m1.1d\">147</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.19.19.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"39.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.04}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.19.19.3.m1.1\"><semantics id=\"S5.T1.19.19.3.m1.1a\"><mrow id=\"S5.T1.19.19.3.m1.1.1\" xref=\"S5.T1.19.19.3.m1.1.1.cmml\"><mn id=\"S5.T1.19.19.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.19.19.3.m1.1.1.2.cmml\">39.2</mn><mo id=\"S5.T1.19.19.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.19.19.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.19.19.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.19.19.3.m1.1.1.3.cmml\"> 1.04</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.19.19.3.m1.1b\"><apply id=\"S5.T1.19.19.3.m1.1.1.cmml\" xref=\"S5.T1.19.19.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.19.19.3.m1.1.1.1.cmml\" xref=\"S5.T1.19.19.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.19.19.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.19.19.3.m1.1.1.2\">39.2</cn><cn id=\"S5.T1.19.19.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.19.19.3.m1.1.1.3\">1.04</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.19.19.3.m1.1c\">39.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.04}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.19.19.3.m1.1d\">39.2 ± 1.04</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.20.20.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"15\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.20.20.4.m1.1\"><semantics id=\"S5.T1.20.20.4.m1.1a\"><mn id=\"S5.T1.20.20.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.20.20.4.m1.1.1.cmml\">15</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.20.20.4.m1.1b\"><cn id=\"S5.T1.20.20.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.20.20.4.m1.1.1\">15</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.20.20.4.m1.1c\">15</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.20.20.4.m1.1d\">15</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.21.21.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"50.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.59}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.21.21.5.m1.1\"><semantics id=\"S5.T1.21.21.5.m1.1a\"><mrow id=\"S5.T1.21.21.5.m1.1.1\" xref=\"S5.T1.21.21.5.m1.1.1.cmml\"><mn id=\"S5.T1.21.21.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.21.21.5.m1.1.1.2.cmml\">50.8</mn><mo id=\"S5.T1.21.21.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.21.21.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.21.21.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.21.21.5.m1.1.1.3.cmml\"> 1.59</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.21.21.5.m1.1b\"><apply id=\"S5.T1.21.21.5.m1.1.1.cmml\" xref=\"S5.T1.21.21.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.21.21.5.m1.1.1.1.cmml\" xref=\"S5.T1.21.21.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.21.21.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.21.21.5.m1.1.1.2\">50.8</cn><cn id=\"S5.T1.21.21.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.21.21.5.m1.1.1.3\">1.59</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.21.21.5.m1.1c\">50.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.59}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.21.21.5.m1.1d\">50.8 ± 1.59</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.22.22.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"7\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.22.22.6.m1.1\"><semantics id=\"S5.T1.22.22.6.m1.1a\"><mn id=\"S5.T1.22.22.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.22.22.6.m1.1.1.cmml\">7</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.22.22.6.m1.1b\"><cn id=\"S5.T1.22.22.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.22.22.6.m1.1.1\">7</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.22.22.6.m1.1c\">7</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.22.22.6.m1.1d\">7</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.23.23.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"12.0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.23.23.7.m1.1\"><semantics id=\"S5.T1.23.23.7.m1.1a\"><mn id=\"S5.T1.23.23.7.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.23.23.7.m1.1.1.cmml\">12.0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.23.23.7.m1.1b\"><cn id=\"S5.T1.23.23.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.23.23.7.m1.1.1\">12.0</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.23.23.7.m1.1c\">12.0</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.23.23.7.m1.1d\">12.0</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.24.24.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"13\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.24.24.8.m1.1\"><semantics id=\"S5.T1.24.24.8.m1.1a\"><mn id=\"S5.T1.24.24.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.24.24.8.m1.1.1.cmml\">13</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.24.24.8.m1.1b\"><cn id=\"S5.T1.24.24.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.24.24.8.m1.1.1\">13</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.24.24.8.m1.1c\">13</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.24.24.8.m1.1d\">13</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.32.32\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.32.32.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text\" id=\"S5.T1.32.32.9.1\" style=\"font-size:90%;\">Prompt Tuning (m = # demo)</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.25.25.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"38.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.23}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.25.25.1.m1.1\"><semantics id=\"S5.T1.25.25.1.m1.1a\"><mrow id=\"S5.T1.25.25.1.m1.1.1\" xref=\"S5.T1.25.25.1.m1.1.1.cmml\"><mn id=\"S5.T1.25.25.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.25.25.1.m1.1.1.2.cmml\">38.8</mn><mo id=\"S5.T1.25.25.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.25.25.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.25.25.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.25.25.1.m1.1.1.3.cmml\"> 1.23</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.25.25.1.m1.1b\"><apply id=\"S5.T1.25.25.1.m1.1.1.cmml\" xref=\"S5.T1.25.25.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.25.25.1.m1.1.1.1.cmml\" xref=\"S5.T1.25.25.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.25.25.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.25.25.1.m1.1.1.2\">38.8</cn><cn id=\"S5.T1.25.25.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.25.25.1.m1.1.1.3\">1.23</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.25.25.1.m1.1c\">38.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.23}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.25.25.1.m1.1d\">38.8 ± 1.23</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.26.26.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"231\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.26.26.2.m1.1\"><semantics id=\"S5.T1.26.26.2.m1.1a\"><mn id=\"S5.T1.26.26.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.26.26.2.m1.1.1.cmml\">231</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.26.26.2.m1.1b\"><cn id=\"S5.T1.26.26.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.26.26.2.m1.1.1\">231</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.26.26.2.m1.1c\">231</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.26.26.2.m1.1d\">231</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.27.27.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"37.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.23}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.27.27.3.m1.1\"><semantics id=\"S5.T1.27.27.3.m1.1a\"><mrow id=\"S5.T1.27.27.3.m1.1.1\" xref=\"S5.T1.27.27.3.m1.1.1.cmml\"><mn id=\"S5.T1.27.27.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.27.27.3.m1.1.1.2.cmml\">37.3</mn><mo id=\"S5.T1.27.27.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.27.27.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.27.27.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.27.27.3.m1.1.1.3.cmml\"> 1.23</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.27.27.3.m1.1b\"><apply id=\"S5.T1.27.27.3.m1.1.1.cmml\" xref=\"S5.T1.27.27.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.27.27.3.m1.1.1.1.cmml\" xref=\"S5.T1.27.27.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.27.27.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.27.27.3.m1.1.1.2\">37.3</cn><cn id=\"S5.T1.27.27.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.27.27.3.m1.1.1.3\">1.23</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.27.27.3.m1.1c\">37.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.23}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.27.27.3.m1.1d\">37.3 ± 1.23</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.28.28.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"29\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.28.28.4.m1.1\"><semantics id=\"S5.T1.28.28.4.m1.1a\"><mn id=\"S5.T1.28.28.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.28.28.4.m1.1.1.cmml\">29</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.28.28.4.m1.1b\"><cn id=\"S5.T1.28.28.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.28.28.4.m1.1.1\">29</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.28.28.4.m1.1c\">29</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.28.28.4.m1.1d\">29</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.29.29.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"47.5{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.84}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.29.29.5.m1.1\"><semantics id=\"S5.T1.29.29.5.m1.1a\"><mrow id=\"S5.T1.29.29.5.m1.1.1\" xref=\"S5.T1.29.29.5.m1.1.1.cmml\"><mn id=\"S5.T1.29.29.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.29.29.5.m1.1.1.2.cmml\">47.5</mn><mo id=\"S5.T1.29.29.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.29.29.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.29.29.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.29.29.5.m1.1.1.3.cmml\"> 1.84</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.29.29.5.m1.1b\"><apply id=\"S5.T1.29.29.5.m1.1.1.cmml\" xref=\"S5.T1.29.29.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.29.29.5.m1.1.1.1.cmml\" xref=\"S5.T1.29.29.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.29.29.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.29.29.5.m1.1.1.2\">47.5</cn><cn id=\"S5.T1.29.29.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.29.29.5.m1.1.1.3\">1.84</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.29.29.5.m1.1c\">47.5{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.84}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.29.29.5.m1.1d\">47.5 ± 1.84</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.30.30.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"16\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.30.30.6.m1.1\"><semantics id=\"S5.T1.30.30.6.m1.1a\"><mn id=\"S5.T1.30.30.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.30.30.6.m1.1.1.cmml\">16</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.30.30.6.m1.1b\"><cn id=\"S5.T1.30.30.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.30.30.6.m1.1.1\">16</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.30.30.6.m1.1c\">16</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.30.30.6.m1.1d\">16</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.31.31.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"14.5\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.31.31.7.m1.1\"><semantics id=\"S5.T1.31.31.7.m1.1a\"><mn id=\"S5.T1.31.31.7.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.31.31.7.m1.1.1.cmml\">14.5</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.31.31.7.m1.1b\"><cn id=\"S5.T1.31.31.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.31.31.7.m1.1.1\">14.5</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.31.31.7.m1.1c\">14.5</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.31.31.7.m1.1d\">14.5</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.32.32.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"49\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.32.32.8.m1.1\"><semantics id=\"S5.T1.32.32.8.m1.1a\"><mn id=\"S5.T1.32.32.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.32.32.8.m1.1.1.cmml\">49</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.32.32.8.m1.1b\"><cn id=\"S5.T1.32.32.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.32.32.8.m1.1.1\">49</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.32.32.8.m1.1c\">49</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.32.32.8.m1.1d\">49</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.40.40\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.40.40.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text\" id=\"S5.T1.40.40.9.1\" style=\"font-size:90%;\">Prefix Tuning (m = 32)</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.33.33.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"42.0{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.85}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.33.33.1.m1.1\"><semantics id=\"S5.T1.33.33.1.m1.1a\"><mrow id=\"S5.T1.33.33.1.m1.1.1\" xref=\"S5.T1.33.33.1.m1.1.1.cmml\"><mn id=\"S5.T1.33.33.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.33.33.1.m1.1.1.2.cmml\">42.0</mn><mo id=\"S5.T1.33.33.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.33.33.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.33.33.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.33.33.1.m1.1.1.3.cmml\"> 0.85</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.33.33.1.m1.1b\"><apply id=\"S5.T1.33.33.1.m1.1.1.cmml\" xref=\"S5.T1.33.33.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.33.33.1.m1.1.1.1.cmml\" xref=\"S5.T1.33.33.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.33.33.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.33.33.1.m1.1.1.2\">42.0</cn><cn id=\"S5.T1.33.33.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.33.33.1.m1.1.1.3\">0.85</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.33.33.1.m1.1c\">42.0{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.85}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.33.33.1.m1.1d\">42.0 ± 0.85</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.34.34.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"123\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.34.34.2.m1.1\"><semantics id=\"S5.T1.34.34.2.m1.1a\"><mn id=\"S5.T1.34.34.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.34.34.2.m1.1.1.cmml\">123</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.34.34.2.m1.1b\"><cn id=\"S5.T1.34.34.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.34.34.2.m1.1.1\">123</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.34.34.2.m1.1c\">123</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.34.34.2.m1.1d\">123</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.35.35.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"39.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.94}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.35.35.3.m1.1\"><semantics id=\"S5.T1.35.35.3.m1.1a\"><mrow id=\"S5.T1.35.35.3.m1.1.1\" xref=\"S5.T1.35.35.3.m1.1.1.cmml\"><mn id=\"S5.T1.35.35.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.35.35.3.m1.1.1.2.cmml\">39.9</mn><mo id=\"S5.T1.35.35.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.35.35.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.35.35.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.35.35.3.m1.1.1.3.cmml\"> 0.94</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.35.35.3.m1.1b\"><apply id=\"S5.T1.35.35.3.m1.1.1.cmml\" xref=\"S5.T1.35.35.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.35.35.3.m1.1.1.1.cmml\" xref=\"S5.T1.35.35.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.35.35.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.35.35.3.m1.1.1.2\">39.9</cn><cn id=\"S5.T1.35.35.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.35.35.3.m1.1.1.3\">0.94</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.35.35.3.m1.1c\">39.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.94}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.35.35.3.m1.1d\">39.9 ± 0.94</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.36.36.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"5\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.36.36.4.m1.1\"><semantics id=\"S5.T1.36.36.4.m1.1a\"><mn id=\"S5.T1.36.36.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.36.36.4.m1.1.1.cmml\">5</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.36.36.4.m1.1b\"><cn id=\"S5.T1.36.36.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.36.36.4.m1.1.1\">5</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.36.36.4.m1.1c\">5</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.36.36.4.m1.1d\">5</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.37.37.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"52.7{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.12}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.37.37.5.m1.1\"><semantics id=\"S5.T1.37.37.5.m1.1a\"><mrow id=\"S5.T1.37.37.5.m1.1.1\" xref=\"S5.T1.37.37.5.m1.1.1.cmml\"><mn id=\"S5.T1.37.37.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.37.37.5.m1.1.1.2.cmml\">52.7</mn><mo id=\"S5.T1.37.37.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.37.37.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.37.37.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.37.37.5.m1.1.1.3.cmml\"> 1.12</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.37.37.5.m1.1b\"><apply id=\"S5.T1.37.37.5.m1.1.1.cmml\" xref=\"S5.T1.37.37.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.37.37.5.m1.1.1.1.cmml\" xref=\"S5.T1.37.37.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.37.37.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.37.37.5.m1.1.1.2\">52.7</cn><cn id=\"S5.T1.37.37.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.37.37.5.m1.1.1.3\">1.12</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.37.37.5.m1.1c\">52.7{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.12}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.37.37.5.m1.1d\">52.7 ± 1.12</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.38.38.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"7\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.38.38.6.m1.1\"><semantics id=\"S5.T1.38.38.6.m1.1a\"><mn id=\"S5.T1.38.38.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.38.38.6.m1.1.1.cmml\">7</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.38.38.6.m1.1b\"><cn id=\"S5.T1.38.38.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.38.38.6.m1.1.1\">7</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.38.38.6.m1.1c\">7</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.38.38.6.m1.1d\">7</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.39.39.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"9.3\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.39.39.7.m1.1\"><semantics id=\"S5.T1.39.39.7.m1.1a\"><mn id=\"S5.T1.39.39.7.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.39.39.7.m1.1.1.cmml\">9.3</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.39.39.7.m1.1b\"><cn id=\"S5.T1.39.39.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.39.39.7.m1.1.1\">9.3</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.39.39.7.m1.1c\">9.3</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.39.39.7.m1.1d\">9.3</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.40.40.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"14\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.40.40.8.m1.1\"><semantics id=\"S5.T1.40.40.8.m1.1a\"><mn id=\"S5.T1.40.40.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.40.40.8.m1.1.1.cmml\">14</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.40.40.8.m1.1b\"><cn id=\"S5.T1.40.40.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.40.40.8.m1.1.1\">14</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.40.40.8.m1.1c\">14</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.40.40.8.m1.1d\">14</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.48.48\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.48.48.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text\" id=\"S5.T1.48.48.9.1\" style=\"font-size:90%;\">Prefix Tuning (m = # demo)</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.41.41.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"41.1{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.89}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.41.41.1.m1.1\"><semantics id=\"S5.T1.41.41.1.m1.1a\"><mrow id=\"S5.T1.41.41.1.m1.1.1\" xref=\"S5.T1.41.41.1.m1.1.1.cmml\"><mn id=\"S5.T1.41.41.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.41.41.1.m1.1.1.2.cmml\">41.1</mn><mo id=\"S5.T1.41.41.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.41.41.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.41.41.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.41.41.1.m1.1.1.3.cmml\"> 0.89</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.41.41.1.m1.1b\"><apply id=\"S5.T1.41.41.1.m1.1.1.cmml\" xref=\"S5.T1.41.41.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.41.41.1.m1.1.1.1.cmml\" xref=\"S5.T1.41.41.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.41.41.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.41.41.1.m1.1.1.2\">41.1</cn><cn id=\"S5.T1.41.41.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.41.41.1.m1.1.1.3\">0.89</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.41.41.1.m1.1c\">41.1{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.89}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.41.41.1.m1.1d\">41.1 ± 0.89</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.42.42.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"144\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.42.42.2.m1.1\"><semantics id=\"S5.T1.42.42.2.m1.1a\"><mn id=\"S5.T1.42.42.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.42.42.2.m1.1.1.cmml\">144</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.42.42.2.m1.1b\"><cn id=\"S5.T1.42.42.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.42.42.2.m1.1.1\">144</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.42.42.2.m1.1c\">144</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.42.42.2.m1.1d\">144</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.43.43.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"38.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.81}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.43.43.3.m1.1\"><semantics id=\"S5.T1.43.43.3.m1.1a\"><mrow id=\"S5.T1.43.43.3.m1.1.1\" xref=\"S5.T1.43.43.3.m1.1.1.cmml\"><mn id=\"S5.T1.43.43.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.43.43.3.m1.1.1.2.cmml\">38.8</mn><mo id=\"S5.T1.43.43.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.43.43.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.43.43.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.43.43.3.m1.1.1.3.cmml\"> 0.81</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.43.43.3.m1.1b\"><apply id=\"S5.T1.43.43.3.m1.1.1.cmml\" xref=\"S5.T1.43.43.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.43.43.3.m1.1.1.1.cmml\" xref=\"S5.T1.43.43.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.43.43.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.43.43.3.m1.1.1.2\">38.8</cn><cn id=\"S5.T1.43.43.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.43.43.3.m1.1.1.3\">0.81</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.43.43.3.m1.1c\">38.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.81}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.43.43.3.m1.1d\">38.8 ± 0.81</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.44.44.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"8\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.44.44.4.m1.1\"><semantics id=\"S5.T1.44.44.4.m1.1a\"><mn id=\"S5.T1.44.44.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.44.44.4.m1.1.1.cmml\">8</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.44.44.4.m1.1b\"><cn id=\"S5.T1.44.44.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.44.44.4.m1.1.1\">8</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.44.44.4.m1.1c\">8</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.44.44.4.m1.1d\">8</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.45.45.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"52.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.15}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.45.45.5.m1.1\"><semantics id=\"S5.T1.45.45.5.m1.1a\"><mrow id=\"S5.T1.45.45.5.m1.1.1\" xref=\"S5.T1.45.45.5.m1.1.1.cmml\"><mn id=\"S5.T1.45.45.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.45.45.5.m1.1.1.2.cmml\">52.8</mn><mo id=\"S5.T1.45.45.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.45.45.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.45.45.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.45.45.5.m1.1.1.3.cmml\"> 1.15</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.45.45.5.m1.1b\"><apply id=\"S5.T1.45.45.5.m1.1.1.cmml\" xref=\"S5.T1.45.45.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.45.45.5.m1.1.1.1.cmml\" xref=\"S5.T1.45.45.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.45.45.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.45.45.5.m1.1.1.2\">52.8</cn><cn id=\"S5.T1.45.45.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.45.45.5.m1.1.1.3\">1.15</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.45.45.5.m1.1c\">52.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.15}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.45.45.5.m1.1d\">52.8 ± 1.15</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.46.46.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"9\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.46.46.6.m1.1\"><semantics id=\"S5.T1.46.46.6.m1.1a\"><mn id=\"S5.T1.46.46.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.46.46.6.m1.1.1.cmml\">9</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.46.46.6.m1.1b\"><cn id=\"S5.T1.46.46.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.46.46.6.m1.1.1\">9</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.46.46.6.m1.1c\">9</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.46.46.6.m1.1d\">9</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.47.47.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"20.5\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.47.47.7.m1.1\"><semantics id=\"S5.T1.47.47.7.m1.1a\"><mn id=\"S5.T1.47.47.7.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.47.47.7.m1.1.1.cmml\">20.5</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.47.47.7.m1.1b\"><cn id=\"S5.T1.47.47.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.47.47.7.m1.1.1\">20.5</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.47.47.7.m1.1c\">20.5</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.47.47.7.m1.1d\">20.5</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.48.48.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"24\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.48.48.8.m1.1\"><semantics id=\"S5.T1.48.48.8.m1.1a\"><mn id=\"S5.T1.48.48.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.48.48.8.m1.1.1.cmml\">24</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.48.48.8.m1.1b\"><cn id=\"S5.T1.48.48.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.48.48.8.m1.1.1\">24</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.48.48.8.m1.1c\">24</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.48.48.8.m1.1d\">24</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.56.56\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.56.56.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text\" id=\"S5.T1.56.56.9.1\" style=\"font-size:90%;\">TTT</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.49.49.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"44.1{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.65}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.49.49.1.m1.1\"><semantics id=\"S5.T1.49.49.1.m1.1a\"><mrow id=\"S5.T1.49.49.1.m1.1.1\" xref=\"S5.T1.49.49.1.m1.1.1.cmml\"><mn id=\"S5.T1.49.49.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.49.49.1.m1.1.1.2.cmml\">44.1</mn><mo id=\"S5.T1.49.49.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.49.49.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.49.49.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.49.49.1.m1.1.1.3.cmml\"> 0.65</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.49.49.1.m1.1b\"><apply id=\"S5.T1.49.49.1.m1.1.1.cmml\" xref=\"S5.T1.49.49.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.49.49.1.m1.1.1.1.cmml\" xref=\"S5.T1.49.49.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.49.49.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.49.49.1.m1.1.1.2\">44.1</cn><cn id=\"S5.T1.49.49.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.49.49.1.m1.1.1.3\">0.65</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.49.49.1.m1.1c\">44.1{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.65}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.49.49.1.m1.1d\">44.1 ± 0.65</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.50.50.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"342\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.50.50.2.m1.1\"><semantics id=\"S5.T1.50.50.2.m1.1a\"><mn id=\"S5.T1.50.50.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.50.50.2.m1.1.1.cmml\">342</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.50.50.2.m1.1b\"><cn id=\"S5.T1.50.50.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.50.50.2.m1.1.1\">342</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.50.50.2.m1.1c\">342</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.50.50.2.m1.1d\">342</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.51.51.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"43.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.55}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.51.51.3.m1.1\"><semantics id=\"S5.T1.51.51.3.m1.1a\"><mrow id=\"S5.T1.51.51.3.m1.1.1\" xref=\"S5.T1.51.51.3.m1.1.1.cmml\"><mn id=\"S5.T1.51.51.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.51.51.3.m1.1.1.2.cmml\">43.6</mn><mo id=\"S5.T1.51.51.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.51.51.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.51.51.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.51.51.3.m1.1.1.3.cmml\"> 0.55</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.51.51.3.m1.1b\"><apply id=\"S5.T1.51.51.3.m1.1.1.cmml\" xref=\"S5.T1.51.51.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.51.51.3.m1.1.1.1.cmml\" xref=\"S5.T1.51.51.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.51.51.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.51.51.3.m1.1.1.2\">43.6</cn><cn id=\"S5.T1.51.51.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.51.51.3.m1.1.1.3\">0.55</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.51.51.3.m1.1c\">43.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.55}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.51.51.3.m1.1d\">43.6 ± 0.55</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.52.52.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"30\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.52.52.4.m1.1\"><semantics id=\"S5.T1.52.52.4.m1.1a\"><mn id=\"S5.T1.52.52.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.52.52.4.m1.1.1.cmml\">30</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.52.52.4.m1.1b\"><cn id=\"S5.T1.52.52.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.52.52.4.m1.1.1\">30</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.52.52.4.m1.1c\">30</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.52.52.4.m1.1d\">30</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.53.53.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"57.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.13}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.53.53.5.m1.1\"><semantics id=\"S5.T1.53.53.5.m1.1a\"><mrow id=\"S5.T1.53.53.5.m1.1.1\" xref=\"S5.T1.53.53.5.m1.1.1.cmml\"><mn id=\"S5.T1.53.53.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.53.53.5.m1.1.1.2.cmml\">57.8</mn><mo id=\"S5.T1.53.53.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.53.53.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.53.53.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.53.53.5.m1.1.1.3.cmml\"> 1.13</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.53.53.5.m1.1b\"><apply id=\"S5.T1.53.53.5.m1.1.1.cmml\" xref=\"S5.T1.53.53.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.53.53.5.m1.1.1.1.cmml\" xref=\"S5.T1.53.53.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.53.53.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.53.53.5.m1.1.1.2\">57.8</cn><cn id=\"S5.T1.53.53.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.53.53.5.m1.1.1.3\">1.13</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.53.53.5.m1.1c\">57.8{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}1.13}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.53.53.5.m1.1d\">57.8 ± 1.13</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.54.54.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"14\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.54.54.6.m1.1\"><semantics id=\"S5.T1.54.54.6.m1.1a\"><mn id=\"S5.T1.54.54.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.54.54.6.m1.1.1.cmml\">14</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.54.54.6.m1.1b\"><cn id=\"S5.T1.54.54.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.54.54.6.m1.1.1\">14</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.54.54.6.m1.1c\">14</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.54.54.6.m1.1d\">14</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.55.55.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\underline{23.8}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.55.55.7.m1.1\"><semantics id=\"S5.T1.55.55.7.m1.1a\"><munder accentunder=\"true\" id=\"S5.T1.55.55.7.m1.1.1\" xref=\"S5.T1.55.55.7.m1.1.1.cmml\"><mn id=\"S5.T1.55.55.7.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.55.55.7.m1.1.1.2.cmml\">23.8</mn><mo id=\"S5.T1.55.55.7.m1.1.1.1\" mathsize=\"90%\" xref=\"S5.T1.55.55.7.m1.1.1.1.cmml\">¯</mo></munder><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.55.55.7.m1.1b\"><apply id=\"S5.T1.55.55.7.m1.1.1.cmml\" xref=\"S5.T1.55.55.7.m1.1.1\"><ci id=\"S5.T1.55.55.7.m1.1.1.1.cmml\" xref=\"S5.T1.55.55.7.m1.1.1.1\">¯</ci><cn id=\"S5.T1.55.55.7.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.55.55.7.m1.1.1.2\">23.8</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.55.55.7.m1.1c\">\\underline{23.8}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.55.55.7.m1.1d\">under¯ start_ARG 23.8 end_ARG</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.56.56.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"56\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.56.56.8.m1.1\"><semantics id=\"S5.T1.56.56.8.m1.1a\"><mn id=\"S5.T1.56.56.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.56.56.8.m1.1.1.cmml\">56</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.56.56.8.m1.1b\"><cn id=\"S5.T1.56.56.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.56.56.8.m1.1.1\">56</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.56.56.8.m1.1c\">56</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.56.56.8.m1.1d\">56</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.80.84.4\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" colspan=\"9\" id=\"S5.T1.80.84.4.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.80.84.4.1.1\" style=\"font-size:90%;\">Our Methods</span></th>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.64.64\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.64.64.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_italic\" id=\"S5.T1.64.64.9.1\" style=\"font-size:90%;\">CT-Prompt</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.57.57.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"43.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.61}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.57.57.1.m1.1\"><semantics id=\"S5.T1.57.57.1.m1.1a\"><mrow id=\"S5.T1.57.57.1.m1.1.1\" xref=\"S5.T1.57.57.1.m1.1.1.cmml\"><mn id=\"S5.T1.57.57.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.57.57.1.m1.1.1.2.cmml\">43.2</mn><mo id=\"S5.T1.57.57.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.57.57.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.57.57.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.57.57.1.m1.1.1.3.cmml\"> 0.61</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.57.57.1.m1.1b\"><apply id=\"S5.T1.57.57.1.m1.1.1.cmml\" xref=\"S5.T1.57.57.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.57.57.1.m1.1.1.1.cmml\" xref=\"S5.T1.57.57.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.57.57.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.57.57.1.m1.1.1.2\">43.2</cn><cn id=\"S5.T1.57.57.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.57.57.1.m1.1.1.3\">0.61</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.57.57.1.m1.1c\">43.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.61}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.57.57.1.m1.1d\">43.2 ± 0.61</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.58.58.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"228\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.58.58.2.m1.1\"><semantics id=\"S5.T1.58.58.2.m1.1a\"><mn id=\"S5.T1.58.58.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.58.58.2.m1.1.1.cmml\">228</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.58.58.2.m1.1b\"><cn id=\"S5.T1.58.58.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.58.58.2.m1.1.1\">228</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.58.58.2.m1.1c\">228</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.58.58.2.m1.1d\">228</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.59.59.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"43.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.67}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.59.59.3.m1.1\"><semantics id=\"S5.T1.59.59.3.m1.1a\"><mrow id=\"S5.T1.59.59.3.m1.1.1\" xref=\"S5.T1.59.59.3.m1.1.1.cmml\"><mn id=\"S5.T1.59.59.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.59.59.3.m1.1.1.2.cmml\">43.6</mn><mo id=\"S5.T1.59.59.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.59.59.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.59.59.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.59.59.3.m1.1.1.3.cmml\"> 0.67</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.59.59.3.m1.1b\"><apply id=\"S5.T1.59.59.3.m1.1.1.cmml\" xref=\"S5.T1.59.59.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.59.59.3.m1.1.1.1.cmml\" xref=\"S5.T1.59.59.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.59.59.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.59.59.3.m1.1.1.2\">43.6</cn><cn id=\"S5.T1.59.59.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.59.59.3.m1.1.1.3\">0.67</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.59.59.3.m1.1c\">43.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.67}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.59.59.3.m1.1d\">43.6 ± 0.67</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.60.60.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"33\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.60.60.4.m1.1\"><semantics id=\"S5.T1.60.60.4.m1.1a\"><mn id=\"S5.T1.60.60.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.60.60.4.m1.1.1.cmml\">33</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.60.60.4.m1.1b\"><cn id=\"S5.T1.60.60.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.60.60.4.m1.1.1\">33</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.60.60.4.m1.1c\">33</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.60.60.4.m1.1d\">33</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.61.61.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"56.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.98}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.61.61.5.m1.1\"><semantics id=\"S5.T1.61.61.5.m1.1a\"><mrow id=\"S5.T1.61.61.5.m1.1.1\" xref=\"S5.T1.61.61.5.m1.1.1.cmml\"><mn id=\"S5.T1.61.61.5.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.61.61.5.m1.1.1.2.cmml\">56.3</mn><mo id=\"S5.T1.61.61.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.61.61.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.61.61.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.61.61.5.m1.1.1.3.cmml\"> 0.98</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.61.61.5.m1.1b\"><apply id=\"S5.T1.61.61.5.m1.1.1.cmml\" xref=\"S5.T1.61.61.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.61.61.5.m1.1.1.1.cmml\" xref=\"S5.T1.61.61.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.61.61.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.61.61.5.m1.1.1.2\">56.3</cn><cn id=\"S5.T1.61.61.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.61.61.5.m1.1.1.3\">0.98</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.61.61.5.m1.1c\">56.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.98}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.61.61.5.m1.1d\">56.3 ± 0.98</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.62.62.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"14\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.62.62.6.m1.1\"><semantics id=\"S5.T1.62.62.6.m1.1a\"><mn id=\"S5.T1.62.62.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.62.62.6.m1.1.1.cmml\">14</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.62.62.6.m1.1b\"><cn id=\"S5.T1.62.62.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.62.62.6.m1.1.1\">14</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.62.62.6.m1.1c\">14</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.62.62.6.m1.1d\">14</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.63.63.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"22.5\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.63.63.7.m1.1\"><semantics id=\"S5.T1.63.63.7.m1.1a\"><mn id=\"S5.T1.63.63.7.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.63.63.7.m1.1.1.cmml\">22.5</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.63.63.7.m1.1b\"><cn id=\"S5.T1.63.63.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.63.63.7.m1.1.1\">22.5</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.63.63.7.m1.1c\">22.5</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.63.63.7.m1.1d\">22.5</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.64.64.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"52\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.64.64.8.m1.1\"><semantics id=\"S5.T1.64.64.8.m1.1a\"><mn id=\"S5.T1.64.64.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.64.64.8.m1.1.1.cmml\">52</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.64.64.8.m1.1b\"><cn id=\"S5.T1.64.64.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.64.64.8.m1.1.1\">52</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.64.64.8.m1.1c\">52</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.64.64.8.m1.1d\">52</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.72.72\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T1.72.72.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><span class=\"ltx_text ltx_font_italic\" id=\"S5.T1.72.72.9.1\" style=\"font-size:90%;\">CT-KV</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.65.65.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\underline{44.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.55}}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.65.65.1.m1.1\"><semantics id=\"S5.T1.65.65.1.m1.1a\"><munder accentunder=\"true\" id=\"S5.T1.65.65.1.m1.1.1\" xref=\"S5.T1.65.65.1.m1.1.1.cmml\"><mrow id=\"S5.T1.65.65.1.m1.1.1.2\" xref=\"S5.T1.65.65.1.m1.1.1.2.cmml\"><mn id=\"S5.T1.65.65.1.m1.1.1.2.2\" mathsize=\"90%\" xref=\"S5.T1.65.65.1.m1.1.1.2.2.cmml\">44.2</mn><mo id=\"S5.T1.65.65.1.m1.1.1.2.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.65.65.1.m1.1.1.2.1.cmml\">±</mo><mn id=\"S5.T1.65.65.1.m1.1.1.2.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.65.65.1.m1.1.1.2.3.cmml\"> 0.55</mn></mrow><mo id=\"S5.T1.65.65.1.m1.1.1.1\" mathsize=\"90%\" xref=\"S5.T1.65.65.1.m1.1.1.1.cmml\">¯</mo></munder><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.65.65.1.m1.1b\"><apply id=\"S5.T1.65.65.1.m1.1.1.cmml\" xref=\"S5.T1.65.65.1.m1.1.1\"><ci id=\"S5.T1.65.65.1.m1.1.1.1.cmml\" xref=\"S5.T1.65.65.1.m1.1.1.1\">¯</ci><apply id=\"S5.T1.65.65.1.m1.1.1.2.cmml\" xref=\"S5.T1.65.65.1.m1.1.1.2\"><csymbol cd=\"latexml\" id=\"S5.T1.65.65.1.m1.1.1.2.1.cmml\" xref=\"S5.T1.65.65.1.m1.1.1.2.1\">plus-or-minus</csymbol><cn id=\"S5.T1.65.65.1.m1.1.1.2.2.cmml\" type=\"float\" xref=\"S5.T1.65.65.1.m1.1.1.2.2\">44.2</cn><cn id=\"S5.T1.65.65.1.m1.1.1.2.3.cmml\" type=\"float\" xref=\"S5.T1.65.65.1.m1.1.1.2.3\">0.55</cn></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.65.65.1.m1.1c\">\\underline{44.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.55}}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.65.65.1.m1.1d\">under¯ start_ARG 44.2 ± 0.55 end_ARG</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.66.66.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"145\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.66.66.2.m1.1\"><semantics id=\"S5.T1.66.66.2.m1.1a\"><mn id=\"S5.T1.66.66.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.66.66.2.m1.1.1.cmml\">145</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.66.66.2.m1.1b\"><cn id=\"S5.T1.66.66.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.66.66.2.m1.1.1\">145</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.66.66.2.m1.1c\">145</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.66.66.2.m1.1d\">145</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.67.67.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\underline{43.7{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.54}}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.67.67.3.m1.1\"><semantics id=\"S5.T1.67.67.3.m1.1a\"><munder accentunder=\"true\" id=\"S5.T1.67.67.3.m1.1.1\" xref=\"S5.T1.67.67.3.m1.1.1.cmml\"><mrow id=\"S5.T1.67.67.3.m1.1.1.2\" xref=\"S5.T1.67.67.3.m1.1.1.2.cmml\"><mn id=\"S5.T1.67.67.3.m1.1.1.2.2\" mathsize=\"90%\" xref=\"S5.T1.67.67.3.m1.1.1.2.2.cmml\">43.7</mn><mo id=\"S5.T1.67.67.3.m1.1.1.2.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.67.67.3.m1.1.1.2.1.cmml\">±</mo><mn id=\"S5.T1.67.67.3.m1.1.1.2.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.67.67.3.m1.1.1.2.3.cmml\"> 0.54</mn></mrow><mo id=\"S5.T1.67.67.3.m1.1.1.1\" mathsize=\"90%\" xref=\"S5.T1.67.67.3.m1.1.1.1.cmml\">¯</mo></munder><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.67.67.3.m1.1b\"><apply id=\"S5.T1.67.67.3.m1.1.1.cmml\" xref=\"S5.T1.67.67.3.m1.1.1\"><ci id=\"S5.T1.67.67.3.m1.1.1.1.cmml\" xref=\"S5.T1.67.67.3.m1.1.1.1\">¯</ci><apply id=\"S5.T1.67.67.3.m1.1.1.2.cmml\" xref=\"S5.T1.67.67.3.m1.1.1.2\"><csymbol cd=\"latexml\" id=\"S5.T1.67.67.3.m1.1.1.2.1.cmml\" xref=\"S5.T1.67.67.3.m1.1.1.2.1\">plus-or-minus</csymbol><cn id=\"S5.T1.67.67.3.m1.1.1.2.2.cmml\" type=\"float\" xref=\"S5.T1.67.67.3.m1.1.1.2.2\">43.7</cn><cn id=\"S5.T1.67.67.3.m1.1.1.2.3.cmml\" type=\"float\" xref=\"S5.T1.67.67.3.m1.1.1.2.3\">0.54</cn></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.67.67.3.m1.1c\">\\underline{43.7{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.54}}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.67.67.3.m1.1d\">under¯ start_ARG 43.7 ± 0.54 end_ARG</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.68.68.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"9\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.68.68.4.m1.1\"><semantics id=\"S5.T1.68.68.4.m1.1a\"><mn id=\"S5.T1.68.68.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.68.68.4.m1.1.1.cmml\">9</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.68.68.4.m1.1b\"><cn id=\"S5.T1.68.68.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.68.68.4.m1.1.1\">9</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.68.68.4.m1.1c\">9</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.68.68.4.m1.1d\">9</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.69.69.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\underline{57.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.78}}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.69.69.5.m1.1\"><semantics id=\"S5.T1.69.69.5.m1.1a\"><munder accentunder=\"true\" id=\"S5.T1.69.69.5.m1.1.1\" xref=\"S5.T1.69.69.5.m1.1.1.cmml\"><mrow id=\"S5.T1.69.69.5.m1.1.1.2\" xref=\"S5.T1.69.69.5.m1.1.1.2.cmml\"><mn id=\"S5.T1.69.69.5.m1.1.1.2.2\" mathsize=\"90%\" xref=\"S5.T1.69.69.5.m1.1.1.2.2.cmml\">57.9</mn><mo id=\"S5.T1.69.69.5.m1.1.1.2.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.69.69.5.m1.1.1.2.1.cmml\">±</mo><mn id=\"S5.T1.69.69.5.m1.1.1.2.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.69.69.5.m1.1.1.2.3.cmml\"> 0.78</mn></mrow><mo id=\"S5.T1.69.69.5.m1.1.1.1\" mathsize=\"90%\" xref=\"S5.T1.69.69.5.m1.1.1.1.cmml\">¯</mo></munder><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.69.69.5.m1.1b\"><apply id=\"S5.T1.69.69.5.m1.1.1.cmml\" xref=\"S5.T1.69.69.5.m1.1.1\"><ci id=\"S5.T1.69.69.5.m1.1.1.1.cmml\" xref=\"S5.T1.69.69.5.m1.1.1.1\">¯</ci><apply id=\"S5.T1.69.69.5.m1.1.1.2.cmml\" xref=\"S5.T1.69.69.5.m1.1.1.2\"><csymbol cd=\"latexml\" id=\"S5.T1.69.69.5.m1.1.1.2.1.cmml\" xref=\"S5.T1.69.69.5.m1.1.1.2.1\">plus-or-minus</csymbol><cn id=\"S5.T1.69.69.5.m1.1.1.2.2.cmml\" type=\"float\" xref=\"S5.T1.69.69.5.m1.1.1.2.2\">57.9</cn><cn id=\"S5.T1.69.69.5.m1.1.1.2.3.cmml\" type=\"float\" xref=\"S5.T1.69.69.5.m1.1.1.2.3\">0.78</cn></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.69.69.5.m1.1c\">\\underline{57.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.78}}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.69.69.5.m1.1d\">under¯ start_ARG 57.9 ± 0.78 end_ARG</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_r\" id=\"S5.T1.70.70.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"7\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.70.70.6.m1.1\"><semantics id=\"S5.T1.70.70.6.m1.1a\"><mn id=\"S5.T1.70.70.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.70.70.6.m1.1.1.cmml\">7</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.70.70.6.m1.1b\"><cn id=\"S5.T1.70.70.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.70.70.6.m1.1.1\">7</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.70.70.6.m1.1c\">7</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.70.70.6.m1.1d\">7</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.71.71.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\underline{23.8}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.71.71.7.m1.1\"><semantics id=\"S5.T1.71.71.7.m1.1a\"><munder accentunder=\"true\" id=\"S5.T1.71.71.7.m1.1.1\" xref=\"S5.T1.71.71.7.m1.1.1.cmml\"><mn id=\"S5.T1.71.71.7.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T1.71.71.7.m1.1.1.2.cmml\">23.8</mn><mo id=\"S5.T1.71.71.7.m1.1.1.1\" mathsize=\"90%\" xref=\"S5.T1.71.71.7.m1.1.1.1.cmml\">¯</mo></munder><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.71.71.7.m1.1b\"><apply id=\"S5.T1.71.71.7.m1.1.1.cmml\" xref=\"S5.T1.71.71.7.m1.1.1\"><ci id=\"S5.T1.71.71.7.m1.1.1.1.cmml\" xref=\"S5.T1.71.71.7.m1.1.1.1\">¯</ci><cn id=\"S5.T1.71.71.7.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.71.71.7.m1.1.1.2\">23.8</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.71.71.7.m1.1c\">\\underline{23.8}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.71.71.7.m1.1d\">under¯ start_ARG 23.8 end_ARG</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T1.72.72.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"26\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.72.72.8.m1.1\"><semantics id=\"S5.T1.72.72.8.m1.1a\"><mn id=\"S5.T1.72.72.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.72.72.8.m1.1.1.cmml\">26</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.72.72.8.m1.1b\"><cn id=\"S5.T1.72.72.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.72.72.8.m1.1.1\">26</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.72.72.8.m1.1c\">26</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.72.72.8.m1.1d\">26</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T1.80.80\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r\" id=\"S5.T1.80.80.9\" style=\"padding-left:2.0pt;padding-right:2.0pt;\">\n<span class=\"ltx_text\" id=\"S5.T1.80.80.9.1\" style=\"font-size:90%;\">TTT+</span><span class=\"ltx_text ltx_font_italic\" id=\"S5.T1.80.80.9.2\" style=\"font-size:90%;\">CT-KV</span>\n</th>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T1.73.73.1\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\mathbf{47.6}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.53}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.73.73.1.m1.1\"><semantics id=\"S5.T1.73.73.1.m1.1a\"><mrow id=\"S5.T1.73.73.1.m1.1.1\" xref=\"S5.T1.73.73.1.m1.1.1.cmml\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T1.73.73.1.m1.1.1.2\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T1.73.73.1.m1.1.1.2.cmml\">47.6</mn><mo id=\"S5.T1.73.73.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.73.73.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.73.73.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.73.73.1.m1.1.1.3.cmml\"> 0.53</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.73.73.1.m1.1b\"><apply id=\"S5.T1.73.73.1.m1.1.1.cmml\" xref=\"S5.T1.73.73.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.73.73.1.m1.1.1.1.cmml\" xref=\"S5.T1.73.73.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.73.73.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.73.73.1.m1.1.1.2\">47.6</cn><cn id=\"S5.T1.73.73.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.73.73.1.m1.1.1.3\">0.53</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.73.73.1.m1.1c\">\\mathbf{47.6}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.53}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.73.73.1.m1.1d\">bold_47.6 ± 0.53</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb ltx_border_r\" id=\"S5.T1.74.74.2\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"372\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.74.74.2.m1.1\"><semantics id=\"S5.T1.74.74.2.m1.1a\"><mn id=\"S5.T1.74.74.2.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.74.74.2.m1.1.1.cmml\">372</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.74.74.2.m1.1b\"><cn id=\"S5.T1.74.74.2.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.74.74.2.m1.1.1\">372</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.74.74.2.m1.1c\">372</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.74.74.2.m1.1d\">372</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T1.75.75.3\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\mathbf{44.1}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.38}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.75.75.3.m1.1\"><semantics id=\"S5.T1.75.75.3.m1.1a\"><mrow id=\"S5.T1.75.75.3.m1.1.1\" xref=\"S5.T1.75.75.3.m1.1.1.cmml\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T1.75.75.3.m1.1.1.2\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T1.75.75.3.m1.1.1.2.cmml\">44.1</mn><mo id=\"S5.T1.75.75.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.75.75.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.75.75.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.75.75.3.m1.1.1.3.cmml\"> 0.38</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.75.75.3.m1.1b\"><apply id=\"S5.T1.75.75.3.m1.1.1.cmml\" xref=\"S5.T1.75.75.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.75.75.3.m1.1.1.1.cmml\" xref=\"S5.T1.75.75.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.75.75.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.75.75.3.m1.1.1.2\">44.1</cn><cn id=\"S5.T1.75.75.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.75.75.3.m1.1.1.3\">0.38</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.75.75.3.m1.1c\">\\mathbf{44.1}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.38}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.75.75.3.m1.1d\">bold_44.1 ± 0.38</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb ltx_border_r\" id=\"S5.T1.76.76.4\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"34\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.76.76.4.m1.1\"><semantics id=\"S5.T1.76.76.4.m1.1a\"><mn id=\"S5.T1.76.76.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.76.76.4.m1.1.1.cmml\">34</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.76.76.4.m1.1b\"><cn id=\"S5.T1.76.76.4.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.76.76.4.m1.1.1\">34</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.76.76.4.m1.1c\">34</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.76.76.4.m1.1d\">34</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T1.77.77.5\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\mathbf{58.2}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.73}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.77.77.5.m1.1\"><semantics id=\"S5.T1.77.77.5.m1.1a\"><mrow id=\"S5.T1.77.77.5.m1.1.1\" xref=\"S5.T1.77.77.5.m1.1.1.cmml\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T1.77.77.5.m1.1.1.2\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T1.77.77.5.m1.1.1.2.cmml\">58.2</mn><mo id=\"S5.T1.77.77.5.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T1.77.77.5.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T1.77.77.5.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T1.77.77.5.m1.1.1.3.cmml\"> 0.73</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.77.77.5.m1.1b\"><apply id=\"S5.T1.77.77.5.m1.1.1.cmml\" xref=\"S5.T1.77.77.5.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T1.77.77.5.m1.1.1.1.cmml\" xref=\"S5.T1.77.77.5.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T1.77.77.5.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T1.77.77.5.m1.1.1.2\">58.2</cn><cn id=\"S5.T1.77.77.5.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T1.77.77.5.m1.1.1.3\">0.73</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.77.77.5.m1.1c\">\\mathbf{58.2}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.73}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.77.77.5.m1.1d\">bold_58.2 ± 0.73</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb ltx_border_r\" id=\"S5.T1.78.78.6\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"17\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.78.78.6.m1.1\"><semantics id=\"S5.T1.78.78.6.m1.1a\"><mn id=\"S5.T1.78.78.6.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.78.78.6.m1.1.1.cmml\">17</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.78.78.6.m1.1b\"><cn id=\"S5.T1.78.78.6.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.78.78.6.m1.1.1\">17</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.78.78.6.m1.1c\">17</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.78.78.6.m1.1d\">17</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T1.79.79.7\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"\\mathbf{25.8}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.79.79.7.m1.1\"><semantics id=\"S5.T1.79.79.7.m1.1a\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T1.79.79.7.m1.1.1\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T1.79.79.7.m1.1.1.cmml\">25.8</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.79.79.7.m1.1b\"><cn id=\"S5.T1.79.79.7.m1.1.1.cmml\" type=\"float\" xref=\"S5.T1.79.79.7.m1.1.1\">25.8</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.79.79.7.m1.1c\">\\mathbf{25.8}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.79.79.7.m1.1d\">bold_25.8</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T1.80.80.8\" style=\"padding-left:2.0pt;padding-right:2.0pt;\"><math alttext=\"63\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T1.80.80.8.m1.1\"><semantics id=\"S5.T1.80.80.8.m1.1a\"><mn id=\"S5.T1.80.80.8.m1.1.1\" mathsize=\"90%\" xref=\"S5.T1.80.80.8.m1.1.1.cmml\">63</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T1.80.80.8.m1.1b\"><cn id=\"S5.T1.80.80.8.m1.1.1.cmml\" type=\"integer\" xref=\"S5.T1.80.80.8.m1.1.1\">63</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T1.80.80.8.m1.1c\">63</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T1.80.80.8.m1.1d\">63</annotation></semantics></math></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 1: </span>\nFew-shot learning performance on NLP-LR, MMLU, BBH, and ARC benchmarks. Each cell contains the accuracy (%) and training time per task (seconds), delimited by <span class=\"ltx_text ltx_font_typewriter\" id=\"S5.T1.91.1\">/</span>. We show the means and <span class=\"ltx_text\" id=\"S5.T1.92.2\" style=\"color:#808080;\">standard deviations</span> of accuracies over 5 seeds with different sets of demonstration pairs per task (except ARC because it has fixed demonstration pairs). The best accuracy is <span class=\"ltx_text ltx_font_bold\" id=\"S5.T1.93.3\">bolded</span> and second best is <span class=\"ltx_text ltx_framed ltx_framed_underline\" id=\"S5.T1.94.4\">underlined</span> for each benchmark.\n</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"S5.SS4.p1\">\n<p class=\"ltx_p\" id=\"S5.SS4.p1.1\">Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a> reports the performance and training time per task for our baselines and methods across the four benchmarks. To fairly compare Prompt Tuning and Prefix Tuning with <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.p1.1.1\">Context Tuning</span>, “Prompt Tuning (m = # demo)” and “Prefix Tuning (m = # demo)” are configured to match the number of trainable parameters in <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.p1.1.2\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.p1.1.3\">CT-KV</span>, respectively, by setting <math alttext=\"m\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS4.p1.1.m1.1\"><semantics id=\"S5.SS4.p1.1.m1.1a\"><mi id=\"S5.SS4.p1.1.m1.1.1\" xref=\"S5.SS4.p1.1.m1.1.1.cmml\">m</mi><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS4.p1.1.m1.1b\"><ci id=\"S5.SS4.p1.1.m1.1.1.cmml\" xref=\"S5.SS4.p1.1.m1.1.1\">𝑚</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS4.p1.1.m1.1c\">m</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS4.p1.1.m1.1d\">italic_m</annotation></semantics></math> to the number demonstration pair tokens. We report each method’s number of trainable parameters in the Appendix.</p>\n</div>\n<section class=\"ltx_paragraph\" id=\"S5.SS4.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Context Tuning outperforms Prompt Tuning and Prefix Tuning.</h4>\n<div class=\"ltx_para\" id=\"S5.SS4.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"S5.SS4.SSS0.Px1.p1.1\"><span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px1.p1.1.1\">CT-Prompt</span> outperforms Prompt Tuning (m = 32), and <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px1.p1.1.2\">CT-KV</span> outperforms Prefix Tuning (m = 32), both by a wide margin across all benchmarks. Moreover, increasing <math alttext=\"m\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS4.SSS0.Px1.p1.1.m1.1\"><semantics id=\"S5.SS4.SSS0.Px1.p1.1.m1.1a\"><mi id=\"S5.SS4.SSS0.Px1.p1.1.m1.1.1\" xref=\"S5.SS4.SSS0.Px1.p1.1.m1.1.1.cmml\">m</mi><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS4.SSS0.Px1.p1.1.m1.1b\"><ci id=\"S5.SS4.SSS0.Px1.p1.1.m1.1.1.cmml\" xref=\"S5.SS4.SSS0.Px1.p1.1.m1.1.1\">𝑚</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS4.SSS0.Px1.p1.1.m1.1c\">m</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS4.SSS0.Px1.p1.1.m1.1d\">italic_m</annotation></semantics></math> to match the number of demonstration tokens does not yield consistent improvements in Prompt Tuning or Prefix Tuning. Despite tuning the same number of parameters, these variants still underperform compared to <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px1.p1.1.3\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px1.p1.1.4\">CT-KV</span>. This highlights the effectiveness of leveraging the model’s ICL capabilities by initializing the prompt or prefix with demonstration tokens.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S5.SS4.SSS0.Px2\">\n<h4 class=\"ltx_title ltx_title_paragraph\">CT-KV is more efficient than CT-Prompt.</h4>\n<div class=\"ltx_para\" id=\"S5.SS4.SSS0.Px2.p1\">\n<p class=\"ltx_p\" id=\"S5.SS4.SSS0.Px2.p1.1\"><span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px2.p1.1.1\">CT-KV</span> exhibits significantly lower training time per task compared to <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px2.p1.1.2\">CT-Prompt</span>. This observation aligns with the time complexity discussion in the Appendix: <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px2.p1.1.3\">CT-Prompt</span> incurs quadratic scaling in training time with the number of demonstration pairs, while <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px2.p1.1.4\">CT-KV</span> scales linearly. In addition to being faster, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px2.p1.1.5\">CT-KV</span> also outperforms <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px2.p1.1.6\">CT-Prompt</span> in accuracy by conditioning each transformer layer’s activations with layer-specific key and value vectors, rather than relying solely on input-level soft prompts.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S5.SS4.SSS0.Px3\">\n<h4 class=\"ltx_title ltx_title_paragraph\">CT-KV offers an efficient alternative to TTT, and the two are complementary.</h4>\n<div class=\"ltx_para\" id=\"S5.SS4.SSS0.Px3.p1\">\n<p class=\"ltx_p\" id=\"S5.SS4.SSS0.Px3.p1.1\"><span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px3.p1.1.1\">CT-KV</span> achieves performance comparable to TTT across NLP-LR, MMLU, and BBH, and solves the same number of ARC tasks. However, it requires at most half the training time per task compared to TTT on all benchmarks. This demonstrates that while the two methods converge to similar performance levels, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px3.p1.1.2\">CT-KV</span> is more efficient due to its linear time complexity to the number of demonstration pairs, in contrast to TTT’s quadratic time complexity. Furthermore, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px3.p1.1.3\">CT-KV</span> can be applied as a refinement step after TTT training of model weights, leading to higher performance on all benchmarks with minimal additional training time. This suggests that context and model-based adaptation methods within the <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px3.p1.1.4\">In-Context Optimization</span> framework are complementary and can be effectively combined for few-shot learning.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S5.SS4.SSS0.Px4\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Initialization from demonstration pairs lowers standard deviation in performance.</h4>\n<div class=\"ltx_para\" id=\"S5.SS4.SSS0.Px4.p1\">\n<p class=\"ltx_p\" id=\"S5.SS4.SSS0.Px4.p1.1\">Initializing the trainable prompt or prefix from demonstration pairs, rather than from random tokens, reduces sensitivity to random seeds in both <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px4.p1.1.1\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px4.p1.1.2\">CT-KV</span>. This leads to more stable performance compared to Prompt Tuning and Prefix Tuning.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S5.SS4.SSS0.Px5\">\n<h4 class=\"ltx_title ltx_title_paragraph\">CT-KV outperforms MetaICL on NLP-LR.</h4>\n<div class=\"ltx_para\" id=\"S5.SS4.SSS0.Px5.p1\">\n<p class=\"ltx_p\" id=\"S5.SS4.SSS0.Px5.p1.1\"><span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px5.p1.1.1\">CT-KV</span> achieves 44.2% accuracy on NLP-LR, surpassing the reported 43.3% accuracy of MetaICL <cite class=\"ltx_cite ltx_citemacro_citep\">(Min et al., <a class=\"ltx_ref\" href=\"#bib.bib36\" title=\"\">2022a</a>)</cite>. This demonstrates that inference-time, single-task optimization with <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS4.SSS0.Px5.p1.1.2\">CT-KV</span> can rival the performance of approaches that fine-tune model weights across many tasks.</p>\n</div>\n</section>\n</section>\n<section class=\"ltx_subsection\" id=\"S5.SS5\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">5.5 </span>Ablation Study</h3>\n<div class=\"ltx_para\" id=\"S5.SS5.p1\">\n<p class=\"ltx_p\" id=\"S5.SS5.p1.2\">We perform ablations on our design choices for <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS5.p1.2.1\">CT-KV</span>, namely Leave-One-Out Masking and Token Dropout. Table <a class=\"ltx_ref\" href=\"#S5.T2\" title=\"Table 2 ‣ 5.5 Ablation Study ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">2</span></a> shows that across all benchmarks, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS5.p1.2.2\">CT-KV</span> without Token Dropout performs marginally worse than <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS5.p1.2.3\">CT-KV</span> with both components. This suggests that when tuning more parameters than traditional Prefix Tuning, applying dropout along the token dimension of <math alttext=\"\\Theta\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS5.p1.1.m1.1\"><semantics id=\"S5.SS5.p1.1.m1.1a\"><mi id=\"S5.SS5.p1.1.m1.1.1\" mathvariant=\"normal\" xref=\"S5.SS5.p1.1.m1.1.1.cmml\">Θ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS5.p1.1.m1.1b\"><ci id=\"S5.SS5.p1.1.m1.1.1.cmml\" xref=\"S5.SS5.p1.1.m1.1.1\">Θ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS5.p1.1.m1.1c\">\\Theta</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS5.p1.1.m1.1d\">roman_Θ</annotation></semantics></math> serves as an effective regularization technique for improving generalization. For NLP-LR, BBH, and MMLU, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS5.p1.2.4\">CT-KV</span> performs significantly worse when Leave-One-Out Masking is not applied. This indicates that during training, it is crucial to mask out the portion of <math alttext=\"\\theta_{\\mathrm{context}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS5.p1.2.m2.1\"><semantics id=\"S5.SS5.p1.2.m2.1a\"><msub id=\"S5.SS5.p1.2.m2.1.1\" xref=\"S5.SS5.p1.2.m2.1.1.cmml\"><mi id=\"S5.SS5.p1.2.m2.1.1.2\" xref=\"S5.SS5.p1.2.m2.1.1.2.cmml\">θ</mi><mi id=\"S5.SS5.p1.2.m2.1.1.3\" xref=\"S5.SS5.p1.2.m2.1.1.3.cmml\">context</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS5.p1.2.m2.1b\"><apply id=\"S5.SS5.p1.2.m2.1.1.cmml\" xref=\"S5.SS5.p1.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S5.SS5.p1.2.m2.1.1.1.cmml\" xref=\"S5.SS5.p1.2.m2.1.1\">subscript</csymbol><ci id=\"S5.SS5.p1.2.m2.1.1.2.cmml\" xref=\"S5.SS5.p1.2.m2.1.1.2\">𝜃</ci><ci id=\"S5.SS5.p1.2.m2.1.1.3.cmml\" xref=\"S5.SS5.p1.2.m2.1.1.3\">context</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS5.p1.2.m2.1c\">\\theta_{\\mathrm{context}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS5.p1.2.m2.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT</annotation></semantics></math> corresponding to the demonstration pair being solved, as it prevents the model from cheating by retrieving the target output directly from the prefix initialization. However, on ARC, the model performs better without Leave-One-Out Masking. We hypothesize this is because ARC evaluation tasks typically include very few demonstration pairs (fewer than 4), so masking out even one pair during training can meaningfully reduce the effectiveness of the prompt or prefix in ICL. We also observe that when neither Leave-One-Out Masking nor Token Dropout is applied, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS5.p1.2.5\">CT-KV</span> performs worse than ICL on MMLU and only marginally better on BBH, highlighting that these two design choices are essential to its overall performance.</p>\n</div>\n<figure class=\"ltx_table\" id=\"S5.T2\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"S5.T2.16\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"S5.T2.16.17.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt\" id=\"S5.T2.16.17.1.1\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T2.16.17.1.1.1\" style=\"font-size:90%;\">Method</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T2.16.17.1.2\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T2.16.17.1.2.1\" style=\"font-size:90%;\">NLP-LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T2.16.17.1.3\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T2.16.17.1.3.1\" style=\"font-size:90%;\">MMLU</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T2.16.17.1.4\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T2.16.17.1.4.1\" style=\"font-size:90%;\">BBH</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T2.16.17.1.5\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T2.16.17.1.5.1\" style=\"font-size:90%;\">ARC</span></th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"S5.T2.4.4\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t\" id=\"S5.T2.4.4.5\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text\" id=\"S5.T2.4.4.5.1\" style=\"font-size:90%;\">Neither</span></th>\n<td class=\"ltx_td ltx_align_right ltx_border_t\" id=\"S5.T2.1.1.1\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"41.0{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.75}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.1.1.1.m1.1\"><semantics id=\"S5.T2.1.1.1.m1.1a\"><mrow id=\"S5.T2.1.1.1.m1.1.1\" xref=\"S5.T2.1.1.1.m1.1.1.cmml\"><mn id=\"S5.T2.1.1.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.1.1.1.m1.1.1.2.cmml\">41.0</mn><mo id=\"S5.T2.1.1.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.1.1.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.1.1.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.1.1.1.m1.1.1.3.cmml\"> 0.75</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.1.1.1.m1.1b\"><apply id=\"S5.T2.1.1.1.m1.1.1.cmml\" xref=\"S5.T2.1.1.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.1.1.1.m1.1.1.1.cmml\" xref=\"S5.T2.1.1.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.1.1.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.1.1.1.m1.1.1.2\">41.0</cn><cn id=\"S5.T2.1.1.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.1.1.1.m1.1.1.3\">0.75</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.1.1.1.m1.1c\">41.0{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.75}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.1.1.1.m1.1d\">41.0 ± 0.75</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_t\" id=\"S5.T2.2.2.2\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"40.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.73}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.2.2.2.m1.1\"><semantics id=\"S5.T2.2.2.2.m1.1a\"><mrow id=\"S5.T2.2.2.2.m1.1.1\" xref=\"S5.T2.2.2.2.m1.1.1.cmml\"><mn id=\"S5.T2.2.2.2.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.2.2.2.m1.1.1.2.cmml\">40.2</mn><mo id=\"S5.T2.2.2.2.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.2.2.2.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.2.2.2.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.2.2.2.m1.1.1.3.cmml\"> 0.73</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.2.2.2.m1.1b\"><apply id=\"S5.T2.2.2.2.m1.1.1.cmml\" xref=\"S5.T2.2.2.2.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.2.2.2.m1.1.1.1.cmml\" xref=\"S5.T2.2.2.2.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.2.2.2.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.2.2.2.m1.1.1.2\">40.2</cn><cn id=\"S5.T2.2.2.2.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.2.2.2.m1.1.1.3\">0.73</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.2.2.2.m1.1c\">40.2{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.73}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.2.2.2.m1.1d\">40.2 ± 0.73</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_t\" id=\"S5.T2.3.3.3\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"51.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.76}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.3.3.3.m1.1\"><semantics id=\"S5.T2.3.3.3.m1.1a\"><mrow id=\"S5.T2.3.3.3.m1.1.1\" xref=\"S5.T2.3.3.3.m1.1.1.cmml\"><mn id=\"S5.T2.3.3.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.3.3.3.m1.1.1.2.cmml\">51.4</mn><mo id=\"S5.T2.3.3.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.3.3.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.3.3.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.3.3.3.m1.1.1.3.cmml\"> 0.76</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.3.3.3.m1.1b\"><apply id=\"S5.T2.3.3.3.m1.1.1.cmml\" xref=\"S5.T2.3.3.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.3.3.3.m1.1.1.1.cmml\" xref=\"S5.T2.3.3.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.3.3.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.3.3.3.m1.1.1.2\">51.4</cn><cn id=\"S5.T2.3.3.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.3.3.3.m1.1.1.3\">0.76</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.3.3.3.m1.1c\">51.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.76}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.3.3.3.m1.1d\">51.4 ± 0.76</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_t\" id=\"S5.T2.4.4.4\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"21.0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.4.4.4.m1.1\"><semantics id=\"S5.T2.4.4.4.m1.1a\"><mn id=\"S5.T2.4.4.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T2.4.4.4.m1.1.1.cmml\">21.0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.4.4.4.m1.1b\"><cn id=\"S5.T2.4.4.4.m1.1.1.cmml\" type=\"float\" xref=\"S5.T2.4.4.4.m1.1.1\">21.0</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.4.4.4.m1.1c\">21.0</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.4.4.4.m1.1d\">21.0</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T2.8.8\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T2.8.8.5\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text\" id=\"S5.T2.8.8.5.1\" style=\"font-size:90%;\">No Leave-One-Out Masking</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.5.5.1\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"42.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.45}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.5.5.1.m1.1\"><semantics id=\"S5.T2.5.5.1.m1.1a\"><mrow id=\"S5.T2.5.5.1.m1.1.1\" xref=\"S5.T2.5.5.1.m1.1.1.cmml\"><mn id=\"S5.T2.5.5.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.5.5.1.m1.1.1.2.cmml\">42.6</mn><mo id=\"S5.T2.5.5.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.5.5.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.5.5.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.5.5.1.m1.1.1.3.cmml\"> 0.45</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.5.5.1.m1.1b\"><apply id=\"S5.T2.5.5.1.m1.1.1.cmml\" xref=\"S5.T2.5.5.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.5.5.1.m1.1.1.1.cmml\" xref=\"S5.T2.5.5.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.5.5.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.5.5.1.m1.1.1.2\">42.6</cn><cn id=\"S5.T2.5.5.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.5.5.1.m1.1.1.3\">0.45</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.5.5.1.m1.1c\">42.6{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.45}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.5.5.1.m1.1d\">42.6 ± 0.45</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.6.6.2\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"41.5{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.65}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.6.6.2.m1.1\"><semantics id=\"S5.T2.6.6.2.m1.1a\"><mrow id=\"S5.T2.6.6.2.m1.1.1\" xref=\"S5.T2.6.6.2.m1.1.1.cmml\"><mn id=\"S5.T2.6.6.2.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.6.6.2.m1.1.1.2.cmml\">41.5</mn><mo id=\"S5.T2.6.6.2.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.6.6.2.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.6.6.2.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.6.6.2.m1.1.1.3.cmml\"> 0.65</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.6.6.2.m1.1b\"><apply id=\"S5.T2.6.6.2.m1.1.1.cmml\" xref=\"S5.T2.6.6.2.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.6.6.2.m1.1.1.1.cmml\" xref=\"S5.T2.6.6.2.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.6.6.2.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.6.6.2.m1.1.1.2\">41.5</cn><cn id=\"S5.T2.6.6.2.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.6.6.2.m1.1.1.3\">0.65</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.6.6.2.m1.1c\">41.5{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.65}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.6.6.2.m1.1d\">41.5 ± 0.65</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.7.7.3\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"54.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.88}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.7.7.3.m1.1\"><semantics id=\"S5.T2.7.7.3.m1.1a\"><mrow id=\"S5.T2.7.7.3.m1.1.1\" xref=\"S5.T2.7.7.3.m1.1.1.cmml\"><mn id=\"S5.T2.7.7.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.7.7.3.m1.1.1.2.cmml\">54.4</mn><mo id=\"S5.T2.7.7.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.7.7.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.7.7.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.7.7.3.m1.1.1.3.cmml\"> 0.88</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.7.7.3.m1.1b\"><apply id=\"S5.T2.7.7.3.m1.1.1.cmml\" xref=\"S5.T2.7.7.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.7.7.3.m1.1.1.1.cmml\" xref=\"S5.T2.7.7.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.7.7.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.7.7.3.m1.1.1.2\">54.4</cn><cn id=\"S5.T2.7.7.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.7.7.3.m1.1.1.3\">0.88</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.7.7.3.m1.1c\">54.4{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.88}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.7.7.3.m1.1d\">54.4 ± 0.88</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.8.8.4\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"\\mathbf{23.8}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.8.8.4.m1.1\"><semantics id=\"S5.T2.8.8.4.m1.1a\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T2.8.8.4.m1.1.1\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T2.8.8.4.m1.1.1.cmml\">23.8</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.8.8.4.m1.1b\"><cn id=\"S5.T2.8.8.4.m1.1.1.cmml\" type=\"float\" xref=\"S5.T2.8.8.4.m1.1.1\">23.8</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.8.8.4.m1.1c\">\\mathbf{23.8}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.8.8.4.m1.1d\">bold_23.8</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T2.12.12\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r\" id=\"S5.T2.12.12.5\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text\" id=\"S5.T2.12.12.5.1\" style=\"font-size:90%;\">No Token Dropout</span></th>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.9.9.1\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"43.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.62}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.9.9.1.m1.1\"><semantics id=\"S5.T2.9.9.1.m1.1a\"><mrow id=\"S5.T2.9.9.1.m1.1.1\" xref=\"S5.T2.9.9.1.m1.1.1.cmml\"><mn id=\"S5.T2.9.9.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.9.9.1.m1.1.1.2.cmml\">43.9</mn><mo id=\"S5.T2.9.9.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.9.9.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.9.9.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.9.9.1.m1.1.1.3.cmml\"> 0.62</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.9.9.1.m1.1b\"><apply id=\"S5.T2.9.9.1.m1.1.1.cmml\" xref=\"S5.T2.9.9.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.9.9.1.m1.1.1.1.cmml\" xref=\"S5.T2.9.9.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.9.9.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.9.9.1.m1.1.1.2\">43.9</cn><cn id=\"S5.T2.9.9.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.9.9.1.m1.1.1.3\">0.62</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.9.9.1.m1.1c\">43.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.62}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.9.9.1.m1.1d\">43.9 ± 0.62</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.10.10.2\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"42.7{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.62}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.10.10.2.m1.1\"><semantics id=\"S5.T2.10.10.2.m1.1a\"><mrow id=\"S5.T2.10.10.2.m1.1.1\" xref=\"S5.T2.10.10.2.m1.1.1.cmml\"><mn id=\"S5.T2.10.10.2.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.10.10.2.m1.1.1.2.cmml\">42.7</mn><mo id=\"S5.T2.10.10.2.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.10.10.2.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.10.10.2.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.10.10.2.m1.1.1.3.cmml\"> 0.62</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.10.10.2.m1.1b\"><apply id=\"S5.T2.10.10.2.m1.1.1.cmml\" xref=\"S5.T2.10.10.2.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.10.10.2.m1.1.1.1.cmml\" xref=\"S5.T2.10.10.2.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.10.10.2.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.10.10.2.m1.1.1.2\">42.7</cn><cn id=\"S5.T2.10.10.2.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.10.10.2.m1.1.1.3\">0.62</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.10.10.2.m1.1c\">42.7{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.62}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.10.10.2.m1.1d\">42.7 ± 0.62</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.11.11.3\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"55.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.72}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.11.11.3.m1.1\"><semantics id=\"S5.T2.11.11.3.m1.1a\"><mrow id=\"S5.T2.11.11.3.m1.1.1\" xref=\"S5.T2.11.11.3.m1.1.1.cmml\"><mn id=\"S5.T2.11.11.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T2.11.11.3.m1.1.1.2.cmml\">55.3</mn><mo id=\"S5.T2.11.11.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.11.11.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.11.11.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.11.11.3.m1.1.1.3.cmml\"> 0.72</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.11.11.3.m1.1b\"><apply id=\"S5.T2.11.11.3.m1.1.1.cmml\" xref=\"S5.T2.11.11.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.11.11.3.m1.1.1.1.cmml\" xref=\"S5.T2.11.11.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.11.11.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.11.11.3.m1.1.1.2\">55.3</cn><cn id=\"S5.T2.11.11.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.11.11.3.m1.1.1.3\">0.72</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.11.11.3.m1.1c\">55.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.72}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.11.11.3.m1.1d\">55.3 ± 0.72</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right\" id=\"S5.T2.12.12.4\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"21.0\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.12.12.4.m1.1\"><semantics id=\"S5.T2.12.12.4.m1.1a\"><mn id=\"S5.T2.12.12.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T2.12.12.4.m1.1.1.cmml\">21.0</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.12.12.4.m1.1b\"><cn id=\"S5.T2.12.12.4.m1.1.1.cmml\" type=\"float\" xref=\"S5.T2.12.12.4.m1.1.1\">21.0</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.12.12.4.m1.1c\">21.0</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.12.12.4.m1.1d\">21.0</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T2.16.16\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r\" id=\"S5.T2.16.16.5\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text\" id=\"S5.T2.16.16.5.1\" style=\"font-size:90%;\">Both</span></th>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T2.13.13.1\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"\\mathbf{44.2}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.55}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.13.13.1.m1.1\"><semantics id=\"S5.T2.13.13.1.m1.1a\"><mrow id=\"S5.T2.13.13.1.m1.1.1\" xref=\"S5.T2.13.13.1.m1.1.1.cmml\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T2.13.13.1.m1.1.1.2\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T2.13.13.1.m1.1.1.2.cmml\">44.2</mn><mo id=\"S5.T2.13.13.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.13.13.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.13.13.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.13.13.1.m1.1.1.3.cmml\"> 0.55</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.13.13.1.m1.1b\"><apply id=\"S5.T2.13.13.1.m1.1.1.cmml\" xref=\"S5.T2.13.13.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.13.13.1.m1.1.1.1.cmml\" xref=\"S5.T2.13.13.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.13.13.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.13.13.1.m1.1.1.2\">44.2</cn><cn id=\"S5.T2.13.13.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.13.13.1.m1.1.1.3\">0.55</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.13.13.1.m1.1c\">\\mathbf{44.2}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.55}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.13.13.1.m1.1d\">bold_44.2 ± 0.55</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T2.14.14.2\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"\\mathbf{43.7}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.54}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.14.14.2.m1.1\"><semantics id=\"S5.T2.14.14.2.m1.1a\"><mrow id=\"S5.T2.14.14.2.m1.1.1\" xref=\"S5.T2.14.14.2.m1.1.1.cmml\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T2.14.14.2.m1.1.1.2\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T2.14.14.2.m1.1.1.2.cmml\">43.7</mn><mo id=\"S5.T2.14.14.2.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.14.14.2.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.14.14.2.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.14.14.2.m1.1.1.3.cmml\"> 0.54</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.14.14.2.m1.1b\"><apply id=\"S5.T2.14.14.2.m1.1.1.cmml\" xref=\"S5.T2.14.14.2.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.14.14.2.m1.1.1.1.cmml\" xref=\"S5.T2.14.14.2.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.14.14.2.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.14.14.2.m1.1.1.2\">43.7</cn><cn id=\"S5.T2.14.14.2.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.14.14.2.m1.1.1.3\">0.54</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.14.14.2.m1.1c\">\\mathbf{43.7}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.54}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.14.14.2.m1.1d\">bold_43.7 ± 0.54</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T2.15.15.3\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"\\mathbf{57.9}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.78}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.15.15.3.m1.1\"><semantics id=\"S5.T2.15.15.3.m1.1a\"><mrow id=\"S5.T2.15.15.3.m1.1.1\" xref=\"S5.T2.15.15.3.m1.1.1.cmml\"><mn class=\"ltx_mathvariant_bold\" id=\"S5.T2.15.15.3.m1.1.1.2\" mathsize=\"90%\" mathvariant=\"bold\" xref=\"S5.T2.15.15.3.m1.1.1.2.cmml\">57.9</mn><mo id=\"S5.T2.15.15.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T2.15.15.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T2.15.15.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T2.15.15.3.m1.1.1.3.cmml\"> 0.78</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.15.15.3.m1.1b\"><apply id=\"S5.T2.15.15.3.m1.1.1.cmml\" xref=\"S5.T2.15.15.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T2.15.15.3.m1.1.1.1.cmml\" xref=\"S5.T2.15.15.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T2.15.15.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T2.15.15.3.m1.1.1.2\">57.9</cn><cn id=\"S5.T2.15.15.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T2.15.15.3.m1.1.1.3\">0.78</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.15.15.3.m1.1c\">\\mathbf{57.9}{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.78}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.15.15.3.m1.1d\">bold_57.9 ± 0.78</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb\" id=\"S5.T2.16.16.4\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"22.5\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T2.16.16.4.m1.1\"><semantics id=\"S5.T2.16.16.4.m1.1a\"><mn id=\"S5.T2.16.16.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T2.16.16.4.m1.1.1.cmml\">22.5</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T2.16.16.4.m1.1b\"><cn id=\"S5.T2.16.16.4.m1.1.1.cmml\" type=\"float\" xref=\"S5.T2.16.16.4.m1.1.1\">22.5</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T2.16.16.4.m1.1c\">22.5</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T2.16.16.4.m1.1d\">22.5</annotation></semantics></math></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 2: </span>\nAblation study on the effects of Leave-One-Out Masking and Token Dropout in <span class=\"ltx_text ltx_font_italic\" id=\"S5.T2.21.1\">CT-KV</span>. Means and standard deviations are computed over 5 seeds.\n</figcaption>\n</figure>\n</section>\n<section class=\"ltx_subsection\" id=\"S5.SS6\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">5.6 </span>Qualitative Analysis</h3>\n<div class=\"ltx_para\" id=\"S5.SS6.p1\">\n<p class=\"ltx_p\" id=\"S5.SS6.p1.1\">We compare our <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS6.p1.1.1\">CT-KV</span> to ICL on the 400 ARC evaluation tasks. Table <a class=\"ltx_ref\" href=\"#S5.T3\" title=\"Table 3 ‣ 5.6 Qualitative Analysis ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">3</span></a> shows the confusion matrix indicating the number of tasks solved or not solved by each method. <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS6.p1.1.2\">CT-KV</span> recovers 51 tasks that ICL fails to solve, demonstrating the benefit of tuning the key and value representations corresponding to the in-context demonstration pairs. However, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS6.p1.1.3\">CT-KV</span> fails to solve 9 tasks that ICL is able to, despite initializing its trainable prefix with the same demonstration pairs, suggesting that it can overfit to the few-shot examples.</p>\n</div>\n<figure class=\"ltx_table ltx_align_floatright\" id=\"S5.T3\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"S5.T3.1\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"S5.T3.1.1.1\">\n<th class=\"ltx_td ltx_th ltx_th_row ltx_border_tt\" id=\"S5.T3.1.1.1.1\"></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T3.1.1.1.2\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T3.1.1.1.2.1\">ICL correct</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T3.1.1.1.3\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T3.1.1.1.3.1\">ICL wrong</span></th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"S5.T3.1.2.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" id=\"S5.T3.1.2.1.1\">\n<span class=\"ltx_text ltx_font_italic\" id=\"S5.T3.1.2.1.1.1\">CT-KV</span><span class=\"ltx_text ltx_font_bold\" id=\"S5.T3.1.2.1.1.2\"> correct</span>\n</th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"S5.T3.1.2.1.2\">44</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"S5.T3.1.2.1.3\">51</td>\n</tr>\n<tr class=\"ltx_tr\" id=\"S5.T3.1.3.2\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb\" id=\"S5.T3.1.3.2.1\">\n<span class=\"ltx_text ltx_font_italic\" id=\"S5.T3.1.3.2.1.1\">CT-KV</span><span class=\"ltx_text ltx_font_bold\" id=\"S5.T3.1.3.2.1.2\"> wrong</span>\n</th>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"S5.T3.1.3.2.2\">9</td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"S5.T3.1.3.2.3\">296</td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_table\">Table 3: </span>\nConfusion matrix for the number of solved/unsolved ARC tasks by ICL and <span class=\"ltx_text ltx_font_italic\" id=\"S5.T3.3.1\">CT-KV</span>.\n</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"S5.SS6.p2\">\n<p class=\"ltx_p\" id=\"S5.SS6.p2.1\">Figure <a class=\"ltx_ref\" href=\"#S5.F4\" title=\"Figure 4 ‣ 5.6 Qualitative Analysis ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">4</span></a> shows one failure case for each method, where the other successfully solves the task. The task on the left illustrates that <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS6.p2.1.1\">CT-KV</span> can effectively adapt to the demonstration pairs to solve a geometric puzzle involving cropping the upper-left portion of objects in the query. On the right, we show a case where <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS6.p2.1.2\">CT-KV</span> makes an incorrect prediction. Since <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS6.p2.1.3\">CT-KV</span> performs optimization on the 3 demonstration pairs and two of them, illustrated on the right side of Figure <a class=\"ltx_ref\" href=\"#S5.F4\" title=\"Figure 4 ‣ 5.6 Qualitative Analysis ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">4</span></a>, have answer grids that are 3-row by 4-column, we hypothesize that <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS6.p2.1.4\">CT-KV</span> became incorrectly biased toward predicting a grid of the same shape during optimization.</p>\n</div>\n<figure class=\"ltx_figure\" id=\"S5.F4\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"152\" id=\"S5.F4.g1\" src=\"./assets/x4.png\" width=\"598\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 4: </span>Left is an ARC task that <span class=\"ltx_text ltx_font_italic\" id=\"S5.F4.3.1\">CT-KV</span> successfully solves, but ICL does not. Conversely, the task on the right is solved by ICL but not by <span class=\"ltx_text ltx_font_italic\" id=\"S5.F4.4.2\">CT-KV</span>.</figcaption>\n</figure>\n</section>\n<section class=\"ltx_subsection\" id=\"S5.SS7\">\n<h3 class=\"ltx_title ltx_title_subsection\">\n<span class=\"ltx_tag ltx_tag_subsection\">5.7 </span>Why does CT-KV Outperform ICL?</h3>\n<section class=\"ltx_paragraph\" id=\"S5.SS7.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Two-Stage Interpretation of ICL.</h4>\n<div class=\"ltx_para\" id=\"S5.SS7.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"S5.SS7.SSS0.Px1.p1.3\">Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a> shows that <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS7.SSS0.Px1.p1.3.1\">CT-KV</span> significantly improves accuracy over ICL. To understand ICL’s limitations, we frame it as a two-stage process: first, the model encodes task-relevant information from the demonstration pairs into an intermediate key-value (KV) cache via a forward pass, denoted as <math alttext=\"\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS7.SSS0.Px1.p1.1.m1.1\"><semantics id=\"S5.SS7.SSS0.Px1.p1.1.m1.1a\"><msub id=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1\" xref=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.cmml\"><mi id=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.2\" mathvariant=\"normal\" xref=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.2.cmml\">Θ</mi><mi id=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.3\" xref=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.3.cmml\">CT</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS7.SSS0.Px1.p1.1.m1.1b\"><apply id=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.1.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1\">subscript</csymbol><ci id=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.2.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.2\">Θ</ci><ci id=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.3.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.1.m1.1.1.3\">CT</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS7.SSS0.Px1.p1.1.m1.1c\">\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS7.SSS0.Px1.p1.1.m1.1d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> and used by <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS7.SSS0.Px1.p1.3.2\">CT-KV</span> to initialize <math alttext=\"\\theta_{\\mathrm{context}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS7.SSS0.Px1.p1.2.m2.1\"><semantics id=\"S5.SS7.SSS0.Px1.p1.2.m2.1a\"><msub id=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1\" xref=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.cmml\"><mi id=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.2\" xref=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.2.cmml\">θ</mi><mi id=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.3\" xref=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.3.cmml\">context</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS7.SSS0.Px1.p1.2.m2.1b\"><apply id=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.1.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1\">subscript</csymbol><ci id=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.2.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.2\">𝜃</ci><ci id=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.3.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.2.m2.1.1.3\">context</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS7.SSS0.Px1.p1.2.m2.1c\">\\theta_{\\mathrm{context}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS7.SSS0.Px1.p1.2.m2.1d\">italic_θ start_POSTSUBSCRIPT roman_context end_POSTSUBSCRIPT</annotation></semantics></math>); second, the model attends to this cache when generating an output for a new query input <math alttext=\"x_{q}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS7.SSS0.Px1.p1.3.m3.1\"><semantics id=\"S5.SS7.SSS0.Px1.p1.3.m3.1a\"><msub id=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1\" xref=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.cmml\"><mi id=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.2\" xref=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.2.cmml\">x</mi><mi id=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.3\" xref=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.3.cmml\">q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS7.SSS0.Px1.p1.3.m3.1b\"><apply id=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.1.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1\">subscript</csymbol><ci id=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.2.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.2\">𝑥</ci><ci id=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.3.cmml\" xref=\"S5.SS7.SSS0.Px1.p1.3.m3.1.1.3\">𝑞</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS7.SSS0.Px1.p1.3.m3.1c\">x_{q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS7.SSS0.Px1.p1.3.m3.1d\">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>.</p>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"S5.SS7.SSS0.Px2\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Demonstration Pair Retrieval Experiment.</h4>\n<div class=\"ltx_para\" id=\"S5.SS7.SSS0.Px2.p1\">\n<p class=\"ltx_p\" id=\"S5.SS7.SSS0.Px2.p1.1\">Since the second stage does not revisit the original demonstration tokens, the KV cache must contain all necessary information to solve input-output pairs from the task, including the demonstration pairs themselves. To assess how well this information is encoded, we conduct a simple diagnostic: we concatenate all <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS7.SSS0.Px2.p1.1.m1.1\"><semantics id=\"S5.SS7.SSS0.Px2.p1.1.m1.1a\"><mi id=\"S5.SS7.SSS0.Px2.p1.1.m1.1.1\" xref=\"S5.SS7.SSS0.Px2.p1.1.m1.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS7.SSS0.Px2.p1.1.m1.1b\"><ci id=\"S5.SS7.SSS0.Px2.p1.1.m1.1.1.cmml\" xref=\"S5.SS7.SSS0.Px2.p1.1.m1.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS7.SSS0.Px2.p1.1.m1.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS7.SSS0.Px2.p1.1.m1.1d\">italic_k</annotation></semantics></math> demonstration pairs into the model’s context and then prompt it with the input from one of those same pairs. In this setup, the correct answer is already present in the context, so the model can either apply the task structure it has extracted from the other demonstration pairs or retrieve the correct output directly from the context.</p>\n</div>\n<div class=\"ltx_para\" id=\"S5.SS7.SSS0.Px2.p2\">\n<p class=\"ltx_p\" id=\"S5.SS7.SSS0.Px2.p2.1\">Table <a class=\"ltx_ref\" href=\"#S5.T4\" title=\"Table 4 ‣ Demonstration Pair Retrieval Experiment. ‣ 5.7 Why does CT-KV Outperform ICL? ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">4</span></a> shows that even in this favorable setting, performance surprisingly remains far from perfect, suggesting that the KV cache often fails to encode the task adequately. <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS7.SSS0.Px2.p2.1.1\">CT-KV</span> can be viewed as directly optimizing this KV cache <math alttext=\"\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.SS7.SSS0.Px2.p2.1.m1.1\"><semantics id=\"S5.SS7.SSS0.Px2.p2.1.m1.1a\"><msub id=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1\" xref=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.cmml\"><mi id=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.2\" mathvariant=\"normal\" xref=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.2.cmml\">Θ</mi><mi id=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.3\" xref=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.3.cmml\">CT</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"S5.SS7.SSS0.Px2.p2.1.m1.1b\"><apply id=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.cmml\" xref=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.1.cmml\" xref=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1\">subscript</csymbol><ci id=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.2.cmml\" xref=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.2\">Θ</ci><ci id=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.3.cmml\" xref=\"S5.SS7.SSS0.Px2.p2.1.m1.1.1.3\">CT</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.SS7.SSS0.Px2.p2.1.m1.1c\">\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.SS7.SSS0.Px2.p2.1.m1.1d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> by applying gradient updates on the demonstration pairs to refine the task representation. To prevent overfitting through memorization, we additionally use a Leave-One-Out Masking technique: when optimizing for a given demonstration pair, we exclude it from the context the model can attend to, forcing the model to generalize from the remaining pairs.</p>\n</div>\n<figure class=\"ltx_table\" id=\"S5.T4\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"S5.T4.4\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"S5.T4.4.5.1\">\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T4.4.5.1.1\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T4.4.5.1.1.1\" style=\"font-size:90%;\">NLP-LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T4.4.5.1.2\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T4.4.5.1.2.1\" style=\"font-size:90%;\">MMLU</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T4.4.5.1.3\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T4.4.5.1.3.1\" style=\"font-size:90%;\">BBH</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"S5.T4.4.5.1.4\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><span class=\"ltx_text ltx_font_bold\" id=\"S5.T4.4.5.1.4.1\" style=\"font-size:90%;\">ARC</span></th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"S5.T4.4.4\">\n<td class=\"ltx_td ltx_align_right ltx_border_bb ltx_border_t\" id=\"S5.T4.1.1.1\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"81.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.32}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T4.1.1.1.m1.1\"><semantics id=\"S5.T4.1.1.1.m1.1a\"><mrow id=\"S5.T4.1.1.1.m1.1.1\" xref=\"S5.T4.1.1.1.m1.1.1.cmml\"><mn id=\"S5.T4.1.1.1.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T4.1.1.1.m1.1.1.2.cmml\">81.9</mn><mo id=\"S5.T4.1.1.1.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T4.1.1.1.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T4.1.1.1.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T4.1.1.1.m1.1.1.3.cmml\"> 0.32</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T4.1.1.1.m1.1b\"><apply id=\"S5.T4.1.1.1.m1.1.1.cmml\" xref=\"S5.T4.1.1.1.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T4.1.1.1.m1.1.1.1.cmml\" xref=\"S5.T4.1.1.1.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T4.1.1.1.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T4.1.1.1.m1.1.1.2\">81.9</cn><cn id=\"S5.T4.1.1.1.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T4.1.1.1.m1.1.1.3\">0.32</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T4.1.1.1.m1.1c\">81.9{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.32}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T4.1.1.1.m1.1d\">81.9 ± 0.32</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb ltx_border_t\" id=\"S5.T4.2.2.2\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"84.1{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.45}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T4.2.2.2.m1.1\"><semantics id=\"S5.T4.2.2.2.m1.1a\"><mrow id=\"S5.T4.2.2.2.m1.1.1\" xref=\"S5.T4.2.2.2.m1.1.1.cmml\"><mn id=\"S5.T4.2.2.2.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T4.2.2.2.m1.1.1.2.cmml\">84.1</mn><mo id=\"S5.T4.2.2.2.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T4.2.2.2.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T4.2.2.2.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T4.2.2.2.m1.1.1.3.cmml\"> 0.45</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T4.2.2.2.m1.1b\"><apply id=\"S5.T4.2.2.2.m1.1.1.cmml\" xref=\"S5.T4.2.2.2.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T4.2.2.2.m1.1.1.1.cmml\" xref=\"S5.T4.2.2.2.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T4.2.2.2.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T4.2.2.2.m1.1.1.2\">84.1</cn><cn id=\"S5.T4.2.2.2.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T4.2.2.2.m1.1.1.3\">0.45</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T4.2.2.2.m1.1c\">84.1{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.45}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T4.2.2.2.m1.1d\">84.1 ± 0.45</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb ltx_border_t\" id=\"S5.T4.3.3.3\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"89.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.43}}\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T4.3.3.3.m1.1\"><semantics id=\"S5.T4.3.3.3.m1.1a\"><mrow id=\"S5.T4.3.3.3.m1.1.1\" xref=\"S5.T4.3.3.3.m1.1.1.cmml\"><mn id=\"S5.T4.3.3.3.m1.1.1.2\" mathsize=\"90%\" xref=\"S5.T4.3.3.3.m1.1.1.2.cmml\">89.3</mn><mo id=\"S5.T4.3.3.3.m1.1.1.1\" lspace=\"0.392em\" mathsize=\"63%\" xref=\"S5.T4.3.3.3.m1.1.1.1.cmml\">±</mo><mn id=\"S5.T4.3.3.3.m1.1.1.3\" mathcolor=\"#808080\" mathsize=\"63%\" xref=\"S5.T4.3.3.3.m1.1.1.3.cmml\"> 0.43</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"S5.T4.3.3.3.m1.1b\"><apply id=\"S5.T4.3.3.3.m1.1.1.cmml\" xref=\"S5.T4.3.3.3.m1.1.1\"><csymbol cd=\"latexml\" id=\"S5.T4.3.3.3.m1.1.1.1.cmml\" xref=\"S5.T4.3.3.3.m1.1.1.1\">plus-or-minus</csymbol><cn id=\"S5.T4.3.3.3.m1.1.1.2.cmml\" type=\"float\" xref=\"S5.T4.3.3.3.m1.1.1.2\">89.3</cn><cn id=\"S5.T4.3.3.3.m1.1.1.3.cmml\" type=\"float\" xref=\"S5.T4.3.3.3.m1.1.1.3\">0.43</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T4.3.3.3.m1.1c\">89.3{\\scriptstyle\\,\\pm\\,{\\color[rgb]{.5,.5,.5}\\definecolor[named]{%\npgfstrokecolor}{rgb}{.5,.5,.5}\\pgfsys@color@gray@stroke{.5}%\n\\pgfsys@color@gray@fill{.5}0.43}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T4.3.3.3.m1.1d\">89.3 ± 0.43</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_right ltx_border_bb ltx_border_t\" id=\"S5.T4.4.4.4\" style=\"padding-left:4.0pt;padding-right:4.0pt;\"><math alttext=\"22.6\" class=\"ltx_Math\" display=\"inline\" id=\"S5.T4.4.4.4.m1.1\"><semantics id=\"S5.T4.4.4.4.m1.1a\"><mn id=\"S5.T4.4.4.4.m1.1.1\" mathsize=\"90%\" xref=\"S5.T4.4.4.4.m1.1.1.cmml\">22.6</mn><annotation-xml encoding=\"MathML-Content\" id=\"S5.T4.4.4.4.m1.1b\"><cn id=\"S5.T4.4.4.4.m1.1.1.cmml\" type=\"float\" xref=\"S5.T4.4.4.4.m1.1.1\">22.6</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S5.T4.4.4.4.m1.1c\">22.6</annotation><annotation encoding=\"application/x-llamapun\" id=\"S5.T4.4.4.4.m1.1d\">22.6</annotation></semantics></math></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 4: </span>\nICL accuracy on demonstration pairs with the same experiment setup\nas Section <a class=\"ltx_ref\" href=\"#S5.SS3\" title=\"5.3 Experiment Setup ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">5.3</span></a>, but evaluating on demonstration pairs instead of query pairs. Means and standard deviations are computed over 5 seeds.</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"S5.SS7.SSS0.Px2.p3\">\n<p class=\"ltx_p\" id=\"S5.SS7.SSS0.Px2.p3.1\">This perspective highlights a key weakness of ICL: relying on a single forward pass to encode complex task behavior often results in an incomplete or lossy task representation. In contrast, <span class=\"ltx_text ltx_font_italic\" id=\"S5.SS7.SSS0.Px2.p3.1.1\">CT-KV</span> uses gradient-based optimization to iteratively refine the cache by explicitly training the model to solve each demonstration pair, leading to a more effective and robust task encoding.</p>\n</div>\n</section>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"S6\">\n<h2 class=\"ltx_title ltx_title_section\">\n<span class=\"ltx_tag ltx_tag_section\">6 </span>Conclusion</h2>\n<div class=\"ltx_para\" id=\"S6.p1\">\n<p class=\"ltx_p\" id=\"S6.p1.1\">We introduce <span class=\"ltx_text ltx_font_italic\" id=\"S6.p1.1.1\">Context Tuning</span>, a simple and effective method for improving few-shot learning in language models by directly optimizing a prompt or prefix initialized from demonstration tokens. Our method combines the strengths of ICL, which leverages pretrained knowledge by conditioning on task examples at inference time, and prompt-based adaptation, which efficiently adapts to new tasks by tuning a small number of parameters. By initializing the tunable prompt or prefix derived from demonstration tokens, <span class=\"ltx_text ltx_font_italic\" id=\"S6.p1.1.2\">Context Tuning</span> enables the model to begin optimization from a task-aware starting point, leading to strong performance without updating model weights.</p>\n</div>\n<div class=\"ltx_para\" id=\"S6.p2\">\n<p class=\"ltx_p\" id=\"S6.p2.1\">We develop two versions of this approach: <span class=\"ltx_text ltx_font_italic\" id=\"S6.p2.1.1\">CT-Prompt</span>, which tunes input-level soft prompts, and <span class=\"ltx_text ltx_font_italic\" id=\"S6.p2.1.2\">CT-KV</span>, which tunes layer-specific key and value prefixes derived from the model’s activations on demonstration pairs. Across a broad set of benchmarks, both methods outperform ICL and traditional prompt-based tuning, with <span class=\"ltx_text ltx_font_italic\" id=\"S6.p2.1.3\">CT-KV</span> offering a more favorable trade-off between performance and efficiency. Through ablation studies, we show that <span class=\"ltx_text ltx_font_italic\" id=\"S6.p2.1.4\">CT-KV</span>’s performance depends critically on two design choices: Leave-One-Out Masking and Token Dropout. To better understand the performance gap between ICL and <span class=\"ltx_text ltx_font_italic\" id=\"S6.p2.1.5\">CT-KV</span>, we interpret ICL as a two-stage process and find that it often encodes an incomplete representation of the task in its intermediate cache of demonstration pairs. <span class=\"ltx_text ltx_font_italic\" id=\"S6.p2.1.6\">CT-KV</span> addresses this limitation by explicitly refining the cache through optimization, resulting in a more accurate representation for steering the model toward solving query inputs.</p>\n</div>\n<div class=\"ltx_para\" id=\"S6.p3\">\n<p class=\"ltx_p\" id=\"S6.p3.1\">More broadly, we frame our method within the <span class=\"ltx_text ltx_font_italic\" id=\"S6.p3.1.1\">In-Context Optimization</span> framework, which encompasses approaches that leverage in-context demonstration pairs to adapt either the model weights or its context at inference time. This perspective connects <span class=\"ltx_text ltx_font_italic\" id=\"S6.p3.1.2\">CT-KV</span> and Test-Time Training under a shared goal of improving task adaptation through inference-time optimization. Our findings highlight that optimizing the lightweight context, rather than the model, is a powerful and scalable direction for few-shot learning, achieving competitive performance to TTT with significantly less training time. Moreover, we show that <span class=\"ltx_text ltx_font_italic\" id=\"S6.p3.1.3\">CT-KV</span> can be applied after TTT to further improve performance, suggesting that context and model adaptation can be effectively combined.</p>\n</div>\n<section class=\"ltx_paragraph\" id=\"S6.SS0.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Limitations and Future Work.</h4>\n<div class=\"ltx_para\" id=\"S6.SS0.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"S6.SS0.SSS0.Px1.p1.1\">Section <a class=\"ltx_ref\" href=\"#S5.SS6\" title=\"5.6 Qualitative Analysis ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">5.6</span></a> identifies a potential limitation of <span class=\"ltx_text ltx_font_italic\" id=\"S6.SS0.SSS0.Px1.p1.1.1\">CT-KV</span>, where it may be prone to overfitting on certain tasks. Future directions to improve <span class=\"ltx_text ltx_font_italic\" id=\"S6.SS0.SSS0.Px1.p1.1.2\">CT-KV</span> include exploring stronger regularization techniques beyond Token Dropout, or applying KV cache compression techniques <cite class=\"ltx_cite ltx_citemacro_citep\">(Devoto et al., <a class=\"ltx_ref\" href=\"#bib.bib11\" title=\"\">2024</a>; Ge et al., <a class=\"ltx_ref\" href=\"#bib.bib16\" title=\"\">2024</a>; Liu et al., <a class=\"ltx_ref\" href=\"#bib.bib30\" title=\"\">2024a</a>)</cite> to compress <span class=\"ltx_text ltx_font_italic\" id=\"S6.SS0.SSS0.Px1.p1.1.3\">CT-KV</span>’s initialization <math alttext=\"\\Theta\" class=\"ltx_Math\" display=\"inline\" id=\"S6.SS0.SSS0.Px1.p1.1.m1.1\"><semantics id=\"S6.SS0.SSS0.Px1.p1.1.m1.1a\"><mi id=\"S6.SS0.SSS0.Px1.p1.1.m1.1.1\" mathvariant=\"normal\" xref=\"S6.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\">Θ</mi><annotation-xml encoding=\"MathML-Content\" id=\"S6.SS0.SSS0.Px1.p1.1.m1.1b\"><ci id=\"S6.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\" xref=\"S6.SS0.SSS0.Px1.p1.1.m1.1.1\">Θ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"S6.SS0.SSS0.Px1.p1.1.m1.1c\">\\Theta</annotation><annotation encoding=\"application/x-llamapun\" id=\"S6.SS0.SSS0.Px1.p1.1.m1.1d\">roman_Θ</annotation></semantics></math> before training, further improving overall efficiency.</p>\n</div>\n</section>\n</section>\n<section class=\"ltx_section\" id=\"Sx1\">\n<h2 class=\"ltx_title ltx_title_section\">Acknowledgement</h2>\n<div class=\"ltx_para\" id=\"Sx1.p1\">\n<p class=\"ltx_p\" id=\"Sx1.p1.1\">We thank members of the NYU Agentic Learning AI Lab for their helpful discussions.\nThe work is supported in part by the Institute of Information &amp; Communications Technology Planning &amp; Evaluation (IITP) under grant RS-2024-00469482, funded by the Ministry of Science and ICT (MSIT) of the Republic of Korea in connection with the Global AI Frontier Lab International Collaborative Research.\nJack Lu is supported by the NSERC PGS-D Scholarship. The compute is supported by the NYU High Performance Computing\nresources, services, and staff expertise.</p>\n</div>\n</section>\n<section class=\"ltx_bibliography\" id=\"bib\">\n<h2 class=\"ltx_title ltx_title_bibliography\">References</h2>\n<ul class=\"ltx_biblist\">\n<li class=\"ltx_bibitem\" id=\"bib.bib1\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Akyürek et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nAkyürek, E., Damani, M., Zweiger, A., Qiu, L., Guo, H., Pari, J., Kim, Y., and Andreas, J. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">The surprising effectiveness of test-time training for few-shot learning.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib1.1.1\">arXiv preprint arXiv:2411.07279</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib2\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Bonnet and Macfarlane,  (2024)</span>\n<span class=\"ltx_bibblock\">\nBonnet, C. and Macfarlane, M. V. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">Searching latent program spaces.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib2.1.1\">arXiv preprint arXiv:2411.08706</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib3\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Brown et al.,  (2020)</span>\n<span class=\"ltx_bibblock\">\nBrown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan, J., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A., Agarwal, S., Herbert-Voss, A., Krueger, G., Henighan, T., Child, R., Ramesh, A., Ziegler, D. M., Wu, J., Winter, C., Hesse, C., Chen, M., Sigler, E., Litwin, M., Gray, S., Chess, B., Clark, J., Berner, C., McCandlish, S., Radford, A., Sutskever, I., and Amodei, D. (2020).\n\n</span>\n<span class=\"ltx_bibblock\">Language models are few-shot learners.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib3.1.1\">NeurIPS</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib4\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Chen et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nChen, Y., Zhong, R., Zha, S., Karypis, G., and He, H. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">Meta-learning via language model in-context tuning.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib4.1.1\">ACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib5\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(5)</span>\n<span class=\"ltx_bibblock\">\nChollet, F. (2019a).\n\n</span>\n<span class=\"ltx_bibblock\">Abstraction and reasoning corpus for artificial general intelligence (arc-agi).\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib6\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(6)</span>\n<span class=\"ltx_bibblock\">\nChollet, F. (2019b).\n\n</span>\n<span class=\"ltx_bibblock\">On the measure of intelligence.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib6.1.1\">arXiv preprint arXiv:1911.01547</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib7\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Chollet et al.,  (2025)</span>\n<span class=\"ltx_bibblock\">\nChollet, F., Knoop, M., Kamradt, G., and Landers, B. (2025).\n\n</span>\n<span class=\"ltx_bibblock\">Arc prize 2024: Technical report.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib7.1.1\">arXiv preprint arXiv:2412.04604</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib8\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Dai et al.,  (2023)</span>\n<span class=\"ltx_bibblock\">\nDai, D., Sun, Y., Dong, L., Hao, Y., Ma, S., Sui, Z., and Wei, F. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">Why can gpt learn in-context? language models implicitly perform gradient descent as meta-optimizers.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib8.1.1\">ICLR</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib9\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Dalal et al.,  (2025)</span>\n<span class=\"ltx_bibblock\">\nDalal, K., Koceja, D., Hussein, G., Xu, J., Zhao, Y., Song, Y., Han, S., Cheung, K. C., Kautz, J., Guestrin, C., Hashimoto, T., Koyejo, S., Choi, Y., Sun, Y., and Wang, X. (2025).\n\n</span>\n<span class=\"ltx_bibblock\">One-minute video generation with test-time training.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib9.1.1\">CVPR</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib10\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Deutch et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nDeutch, G., Magar, N., Natan, T., and Dar, G. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">In-context learning and gradient descent revisited.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib10.1.1\">NAACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib11\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Devoto et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nDevoto, A., Zhao, Y., Scardapane, S., and Minervini, P. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">A simple and effective <math alttext=\"l\\_2\" class=\"ltx_Math\" display=\"inline\" id=\"bib.bib11.1.m1.1\"><semantics id=\"bib.bib11.1.m1.1a\"><mrow id=\"bib.bib11.1.m1.1.1\" xref=\"bib.bib11.1.m1.1.1.cmml\"><mi id=\"bib.bib11.1.m1.1.1.2\" xref=\"bib.bib11.1.m1.1.1.2.cmml\">l</mi><mo id=\"bib.bib11.1.m1.1.1.1\" xref=\"bib.bib11.1.m1.1.1.1.cmml\">⁢</mo><mi id=\"bib.bib11.1.m1.1.1.3\" mathvariant=\"normal\" xref=\"bib.bib11.1.m1.1.1.3.cmml\">_</mi><mo id=\"bib.bib11.1.m1.1.1.1a\" xref=\"bib.bib11.1.m1.1.1.1.cmml\">⁢</mo><mn id=\"bib.bib11.1.m1.1.1.4\" xref=\"bib.bib11.1.m1.1.1.4.cmml\">2</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"bib.bib11.1.m1.1b\"><apply id=\"bib.bib11.1.m1.1.1.cmml\" xref=\"bib.bib11.1.m1.1.1\"><times id=\"bib.bib11.1.m1.1.1.1.cmml\" xref=\"bib.bib11.1.m1.1.1.1\"></times><ci id=\"bib.bib11.1.m1.1.1.2.cmml\" xref=\"bib.bib11.1.m1.1.1.2\">𝑙</ci><ci id=\"bib.bib11.1.m1.1.1.3.cmml\" xref=\"bib.bib11.1.m1.1.1.3\">_</ci><cn id=\"bib.bib11.1.m1.1.1.4.cmml\" type=\"integer\" xref=\"bib.bib11.1.m1.1.1.4\">2</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"bib.bib11.1.m1.1c\">l\\_2</annotation><annotation encoding=\"application/x-llamapun\" id=\"bib.bib11.1.m1.1d\">italic_l _ 2</annotation></semantics></math> norm-based strategy for kv cache compression.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib11.2.1\">EMNLP</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib12\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Dhariwal and Nichol,  (2021)</span>\n<span class=\"ltx_bibblock\">\nDhariwal, P. and Nichol, A. Q. (2021).\n\n</span>\n<span class=\"ltx_bibblock\">Diffusion models beat gans on image synthesis.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib12.1.1\">NeurIPS</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib13\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Franzen et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nFranzen, D., Disselhoff, J., and Hartmann, D. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">The llm architect: Solving the arc challenge is a matter of perspective.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib13.1.1\">arXiv preprint arXiv:2505.07859</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib14\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Gandelsman et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nGandelsman, Y., Sun, Y., Chen, X., and Efros, A. A. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">Test-time training with masked autoencoders.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib14.1.1\">NeurIPS</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib15\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Garg et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nGarg, S., Tsipras, D., Liang, P., and Valiant, G. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">What can transformers learn in-context? a case study of simple function classes.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib15.1.1\">arXiv preprint arXiv:2208.01066</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib16\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Ge et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nGe, S., Zhang, Y., Liu, L., Zhang, M., Han, J., and Gao, J. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">Model tells you what to discard: Adaptive kv cache compression for llms.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib16.1.1\">ICML</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib17\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Grattafiori et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nGrattafiori, A., Dubey, A., Jauhri, A., Pandey, A., Kadian, A., Al-Dahle, A., Letman, A., Mathur, A., Schelten, A., Vaughan, A., Yang, A., Fan, A., Goyal, A., and et al. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">The llama 3 herd of models.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib17.1.1\">arXiv preprint arXiv:2407.21783</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib18\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Hardt and Sun,  (2024)</span>\n<span class=\"ltx_bibblock\">\nHardt, M. and Sun, Y. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">Test-time training on nearest neighbors for large language models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib18.1.1\">ICLR</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib19\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Hendrycks et al.,  (2021)</span>\n<span class=\"ltx_bibblock\">\nHendrycks, D., Burns, C., Basart, S., Zou, A., Mazeika, M., Song, D., and Steinhardt, J. (2021).\n\n</span>\n<span class=\"ltx_bibblock\">Measuring massive multitask language understanding.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib19.1.1\">ICLR</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib20\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Ho,  (2022)</span>\n<span class=\"ltx_bibblock\">\nHo, J. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">Classifier-free diffusion guidance.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib20.1.1\">arXiv preprint arXiv:2207.12598</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib21\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Ho et al.,  (2020)</span>\n<span class=\"ltx_bibblock\">\nHo, J., Jain, A., and Abbeel, P. (2020).\n\n</span>\n<span class=\"ltx_bibblock\">Denoising diffusion probabilistic models.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib21.1.1\">arXiv preprint arxiv:2006.11239</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib22\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Hu et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nHu, E. J., Shen, Y., Wallis, P., Allen-Zhu, Z., Li, Y., Wang, S., Wang, L., and Chen, W. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">LoRA: Low-rank adaptation of large language models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib22.1.1\">ICLR</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib23\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Jang et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nJang, J., Jang, S., Kweon, W., Jeon, M., and Yu, H. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">Rectifying demonstration shortcut in in-context learning.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib23.1.1\">ACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib24\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Jiang et al.,  (2023)</span>\n<span class=\"ltx_bibblock\">\nJiang, A. Q., Sablayrolles, A., Mensch, A., Bamford, C., Chaplot, D. S., de las Casas, D., Bressand, F., Lengyel, G., Lample, G., Saulnier, L., Lavaud, L. R., Lachaux, M.-A., Stock, P., Scao, T. L., Lavril, T., Wang, T., Lacroix, T., and Sayed, W. E. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">Mistral 7b.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib24.1.1\">arXiv preprint arXiv:2310.06825</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib25\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Khashabi et al.,  (2020)</span>\n<span class=\"ltx_bibblock\">\nKhashabi, D., Min, S., Khot, T., Sabharwal, A., Tafjord, O., Clark, P., and Hajishirzi, H. (2020).\n\n</span>\n<span class=\"ltx_bibblock\">UNIFIEDQA: Crossing format boundaries with a single QA system.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib25.1.1\">EMNLP (Findings)</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib26\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Kirkpatrick et al.,  (2017)</span>\n<span class=\"ltx_bibblock\">\nKirkpatrick, J., Pascanu, R., Rabinowitz, N., Veness, J., Desjardins, G., Rusu, A. A., Milan, K., Quan, J., Ramalho, T., Grabska-Barwinska, A., Hassabis, D., Clopath, C., Kumaran, D., and Hadsell, R. (2017).\n\n</span>\n<span class=\"ltx_bibblock\">Overcoming catastrophic forgetting in neural networks.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib26.1.1\">PNAS</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib27\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Lester et al.,  (2021)</span>\n<span class=\"ltx_bibblock\">\nLester, B., Al-Rfou, R., and Constant, N. (2021).\n\n</span>\n<span class=\"ltx_bibblock\">The power of scale for parameter-efficient prompt tuning.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib27.1.1\">EMNLP</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib28\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Li and Qiu,  (2023)</span>\n<span class=\"ltx_bibblock\">\nLi, X. and Qiu, X. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">Finding supporting examples for in-context learning.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib28.1.1\">EMNLP (Findings)</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib29\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Li and Liang,  (2021)</span>\n<span class=\"ltx_bibblock\">\nLi, X. L. and Liang, P. (2021).\n\n</span>\n<span class=\"ltx_bibblock\">Prefix-tuning: Optimizing continuous prompts for generation.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib29.1.1\">ACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib30\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(30)</span>\n<span class=\"ltx_bibblock\">\nLiu, A., Liu, J., Pan, Z., He, Y., Haffari, G., and Zhuang, B. (2024a).\n\n</span>\n<span class=\"ltx_bibblock\">Minicache: KV cache compression in depth dimension for large language models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib30.1.1\">NeurIPS</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib31\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Liu et al.,  (2021)</span>\n<span class=\"ltx_bibblock\">\nLiu, J., Shen, D., Zhang, Y., Dolan, B., Carin, L., and Chen, W. (2021).\n\n</span>\n<span class=\"ltx_bibblock\">What makes good in-context examples for gpt-<math alttext=\"3\" class=\"ltx_Math\" display=\"inline\" id=\"bib.bib31.1.m1.1\"><semantics id=\"bib.bib31.1.m1.1a\"><mn id=\"bib.bib31.1.m1.1.1\" xref=\"bib.bib31.1.m1.1.1.cmml\">3</mn><annotation-xml encoding=\"MathML-Content\" id=\"bib.bib31.1.m1.1b\"><cn id=\"bib.bib31.1.m1.1.1.cmml\" type=\"integer\" xref=\"bib.bib31.1.m1.1.1\">3</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"bib.bib31.1.m1.1c\">3</annotation><annotation encoding=\"application/x-llamapun\" id=\"bib.bib31.1.m1.1d\">3</annotation></semantics></math>?\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib31.2.1\">ACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib32\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(32)</span>\n<span class=\"ltx_bibblock\">\nLiu, S., Ye, H., Xing, L., and Zou, J. (2024b).\n\n</span>\n<span class=\"ltx_bibblock\">In-context vectors: making in context learning more effective and controllable through latent space steering.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib32.1.1\">ICML</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib33\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(33)</span>\n<span class=\"ltx_bibblock\">\nLiu, X., Ji, K., Fu, Y., Du, Z., Yang, Z., and Tang, J. (2022a).\n\n</span>\n<span class=\"ltx_bibblock\">P-tuning v2: Prompt tuning can be comparable to fine-tuning universally across scales and tasks.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib33.1.1\">ACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib34\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(34)</span>\n<span class=\"ltx_bibblock\">\nLiu, X., Ji, K., Fu, Y., Tam, W., Du, Z., Yang, Z., and Tang, J. (2022b).\n\n</span>\n<span class=\"ltx_bibblock\">P-tuning: Prompt tuning can be comparable to fine-tuning across scales and tasks.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib34.1.1\">ACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib35\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Lu et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nLu, J., Teehan, R., and Ren, M. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">Procreate, don’t reproduce! propulsive energy diffusion for creative generation.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib35.1.1\">ECCV</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib36\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(36)</span>\n<span class=\"ltx_bibblock\">\nMin, S., Lewis, M., Zettlemoyer, L., and Hajishirzi, H. (2022a).\n\n</span>\n<span class=\"ltx_bibblock\">MetaICL: Learning to learn in context.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib36.1.1\">NAACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib37\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">(37)</span>\n<span class=\"ltx_bibblock\">\nMin, S., Lyu, X., Holtzman, A., Artetxe, M., Lewis, M., Hajishirzi, H., and Zettlemoyer, L. (2022b).\n\n</span>\n<span class=\"ltx_bibblock\">Rethinking the role of demonstrations: What makes in-context learning work?\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib37.1.1\">EMNLP</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib38\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Muhtar et al.,  (2024)</span>\n<span class=\"ltx_bibblock\">\nMuhtar, D., Shen, Y., Yang, Y., Liu, X., Lu, Y., Liu, J., Zhan, Y., Sun, H., Deng, W., Sun, F., Zhang, X., Gao, J., Chen, W., and Zhang, Q. (2024).\n\n</span>\n<span class=\"ltx_bibblock\">Streamadapter: Efficient test time adaptation from contextual streams.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib38.1.1\">arXiv preprint arXiv:2411.09289</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib39\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Nichol et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nNichol, A. Q., Dhariwal, P., Ramesh, A., Shyam, P., Mishkin, P., McGrew, B., Sutskever, I., and Chen, M. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">GLIDE: towards photorealistic image generation and editing with text-guided diffusion models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib39.1.1\">ICML</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib40\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Radford et al.,  (2019)</span>\n<span class=\"ltx_bibblock\">\nRadford, A., Wu, J., Child, R., Luan, D., Amodei, D., and Sutskever, I. (2019).\n\n</span>\n<span class=\"ltx_bibblock\">Language models are unsupervised multitask learners.\n\n</span>\n<span class=\"ltx_bibblock\"><span class=\"ltx_text ltx_font_italic\" id=\"bib.bib40.1.1\">OpenAI</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib41\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Rombach et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nRombach, R., Blattmann, A., Lorenz, D., Esser, P., and Ommer, B. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">High-resolution image synthesis with latent diffusion models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib41.1.1\">CVPR</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib42\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Shin et al.,  (2020)</span>\n<span class=\"ltx_bibblock\">\nShin, T., Razeghi, Y., IV, R. L. L., Wallace, E., and Singh, S. (2020).\n\n</span>\n<span class=\"ltx_bibblock\">AutoPrompt: Eliciting knowledge from language models with automatically generated prompts.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib42.1.1\">EMNLP</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib43\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Singhal et al.,  (2023)</span>\n<span class=\"ltx_bibblock\">\nSinghal, K., Azizi, S., Tu, T., Mahdavi, S. S., Wei, J., Chung, H. W., Scales, N., Tanwani, A., Cole-Lewis, H., Pfohl, S., Payne, P., Seneviratne, M., Gamble, P., Kelly, C., Scharli, N., Chowdhery, A., Mansfield, P., y Arcas, B. A., Webster, D., Corrado, G. S., Matias, Y., Chou, K., Gottweis, J., Tomasev, N., Liu, Y., Rajkomar, A., Barral, J., Semturs, C., Karthikesalingam, A., and Natarajan, V. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">Large language models encode clinical knowledge.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib43.1.1\">Nature</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib44\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Srivastava et al.,  (2023)</span>\n<span class=\"ltx_bibblock\">\nSrivastava, A., Rastogi, A., Rao, A., Md-Shoeb, A.-A., Abid, A., Fisch, A., Brown, A., Santoro, A., Gupta, A., and et al. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">Beyond the imitation game: Quantifying and extrapolating the capabilities of language models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib44.1.1\">TMLR</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib45\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Sun et al.,  (2020)</span>\n<span class=\"ltx_bibblock\">\nSun, Y., Wang, X., Zhuang, L., Miller, J., Hardt, M., and Efros, A. A. (2020).\n\n</span>\n<span class=\"ltx_bibblock\">Test-time training with self-supervision for generalization under distribution shifts.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib45.1.1\">ICML</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib46\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Suzgun et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nSuzgun, M., Scales, N., Scharli, N., Gehrmann, S., Tay, Y., Chung, H. W., Chowdhery, A., Le, Q. V., Chi, E. H., Zhou, D., and Wei, J. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">Challenging big-bench tasks and whether chain-of-thought can solve them.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib46.1.1\">ACL</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib47\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Wallace et al.,  (2023)</span>\n<span class=\"ltx_bibblock\">\nWallace, B., Gokul, A., Ermon, S., and Naik, N. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">End-to-end diffusion latent optimization improves classifier guidance.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib47.1.1\">ICCV</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib48\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Wang et al.,  (2023)</span>\n<span class=\"ltx_bibblock\">\nWang, X., Wei, J., Schuurmans, D., Le, Q. V., Chi, E. H., Narang, S., Chowdhery, A., and Zhou, D. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">Self-consistency improves chain of thought reasoning in language models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib48.1.1\">ICML</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib49\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Wei et al.,  (2022)</span>\n<span class=\"ltx_bibblock\">\nWei, J., Wang, X., Schuurmans, D., Bosma, M., Ichter, B., Xia, F., Chi, E. H., Le, Q. V., and Zhou, D. (2022).\n\n</span>\n<span class=\"ltx_bibblock\">Chain-of-thought prompting elicits reasoning in large language models.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib49.1.1\">NeurIPS</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib50\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Ye et al.,  (2021)</span>\n<span class=\"ltx_bibblock\">\nYe, Q., Lin, B. Y., and Ren, X. (2021).\n\n</span>\n<span class=\"ltx_bibblock\">CrossFit: A few-shot learning challenge for cross-task generalization in NLP.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib50.1.1\">EMNLP</span>.\n\n</span>\n</li>\n<li class=\"ltx_bibitem\" id=\"bib.bib51\">\n<span class=\"ltx_tag ltx_role_refnum ltx_tag_bibitem\">Zhao,  (2023)</span>\n<span class=\"ltx_bibblock\">\nZhao, J. (2023).\n\n</span>\n<span class=\"ltx_bibblock\">In-context exemplars as clues to retrieving from large associative memory.\n\n</span>\n<span class=\"ltx_bibblock\">In <span class=\"ltx_text ltx_font_italic\" id=\"bib.bib51.1.1\">ICML Neural Conversational AI</span>.\n\n</span>\n</li>\n</ul>\n</section>\n<div class=\"ltx_pagination ltx_role_newpage\"></div>\n<section class=\"ltx_appendix\" id=\"Ax1\">\n<h2 class=\"ltx_title ltx_title_appendix\">Appendix</h2>\n</section>\n<section class=\"ltx_appendix\" id=\"A1\">\n<h2 class=\"ltx_title ltx_title_appendix\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix A </span>Time Complexity</h2>\n<div class=\"ltx_para\" id=\"A1.p1\">\n<p class=\"ltx_p\" id=\"A1.p1.5\">At each training iteration, an LLM’s forward and backward passes are dominated by its self-attention operations. Consider a single attention head of dimension <math alttext=\"d\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.1.m1.1\"><semantics id=\"A1.p1.1.m1.1a\"><mi id=\"A1.p1.1.m1.1.1\" xref=\"A1.p1.1.m1.1.1.cmml\">d</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.1.m1.1b\"><ci id=\"A1.p1.1.m1.1.1.cmml\" xref=\"A1.p1.1.m1.1.1\">𝑑</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.1.m1.1c\">d</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.1.m1.1d\">italic_d</annotation></semantics></math>. Let <math alttext=\"L_{Q}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.2.m2.1\"><semantics id=\"A1.p1.2.m2.1a\"><msub id=\"A1.p1.2.m2.1.1\" xref=\"A1.p1.2.m2.1.1.cmml\"><mi id=\"A1.p1.2.m2.1.1.2\" xref=\"A1.p1.2.m2.1.1.2.cmml\">L</mi><mi id=\"A1.p1.2.m2.1.1.3\" xref=\"A1.p1.2.m2.1.1.3.cmml\">Q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.2.m2.1b\"><apply id=\"A1.p1.2.m2.1.1.cmml\" xref=\"A1.p1.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.p1.2.m2.1.1.1.cmml\" xref=\"A1.p1.2.m2.1.1\">subscript</csymbol><ci id=\"A1.p1.2.m2.1.1.2.cmml\" xref=\"A1.p1.2.m2.1.1.2\">𝐿</ci><ci id=\"A1.p1.2.m2.1.1.3.cmml\" xref=\"A1.p1.2.m2.1.1.3\">𝑄</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.2.m2.1c\">L_{Q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.2.m2.1d\">italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> denote the number of query tokens and <math alttext=\"L_{K}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.3.m3.1\"><semantics id=\"A1.p1.3.m3.1a\"><msub id=\"A1.p1.3.m3.1.1\" xref=\"A1.p1.3.m3.1.1.cmml\"><mi id=\"A1.p1.3.m3.1.1.2\" xref=\"A1.p1.3.m3.1.1.2.cmml\">L</mi><mi id=\"A1.p1.3.m3.1.1.3\" xref=\"A1.p1.3.m3.1.1.3.cmml\">K</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.3.m3.1b\"><apply id=\"A1.p1.3.m3.1.1.cmml\" xref=\"A1.p1.3.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.p1.3.m3.1.1.1.cmml\" xref=\"A1.p1.3.m3.1.1\">subscript</csymbol><ci id=\"A1.p1.3.m3.1.1.2.cmml\" xref=\"A1.p1.3.m3.1.1.2\">𝐿</ci><ci id=\"A1.p1.3.m3.1.1.3.cmml\" xref=\"A1.p1.3.m3.1.1.3\">𝐾</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.3.m3.1c\">L_{K}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.3.m3.1d\">italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> the number of key (and value) tokens. We form the query matrix <math alttext=\"\\mathbf{Q}\\in\\mathbb{R}^{L_{Q}\\times d}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.4.m4.1\"><semantics id=\"A1.p1.4.m4.1a\"><mrow id=\"A1.p1.4.m4.1.1\" xref=\"A1.p1.4.m4.1.1.cmml\"><mi id=\"A1.p1.4.m4.1.1.2\" xref=\"A1.p1.4.m4.1.1.2.cmml\">𝐐</mi><mo id=\"A1.p1.4.m4.1.1.1\" xref=\"A1.p1.4.m4.1.1.1.cmml\">∈</mo><msup id=\"A1.p1.4.m4.1.1.3\" xref=\"A1.p1.4.m4.1.1.3.cmml\"><mi id=\"A1.p1.4.m4.1.1.3.2\" xref=\"A1.p1.4.m4.1.1.3.2.cmml\">ℝ</mi><mrow id=\"A1.p1.4.m4.1.1.3.3\" xref=\"A1.p1.4.m4.1.1.3.3.cmml\"><msub id=\"A1.p1.4.m4.1.1.3.3.2\" xref=\"A1.p1.4.m4.1.1.3.3.2.cmml\"><mi id=\"A1.p1.4.m4.1.1.3.3.2.2\" xref=\"A1.p1.4.m4.1.1.3.3.2.2.cmml\">L</mi><mi id=\"A1.p1.4.m4.1.1.3.3.2.3\" xref=\"A1.p1.4.m4.1.1.3.3.2.3.cmml\">Q</mi></msub><mo id=\"A1.p1.4.m4.1.1.3.3.1\" lspace=\"0.222em\" rspace=\"0.222em\" xref=\"A1.p1.4.m4.1.1.3.3.1.cmml\">×</mo><mi id=\"A1.p1.4.m4.1.1.3.3.3\" xref=\"A1.p1.4.m4.1.1.3.3.3.cmml\">d</mi></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.4.m4.1b\"><apply id=\"A1.p1.4.m4.1.1.cmml\" xref=\"A1.p1.4.m4.1.1\"><in id=\"A1.p1.4.m4.1.1.1.cmml\" xref=\"A1.p1.4.m4.1.1.1\"></in><ci id=\"A1.p1.4.m4.1.1.2.cmml\" xref=\"A1.p1.4.m4.1.1.2\">𝐐</ci><apply id=\"A1.p1.4.m4.1.1.3.cmml\" xref=\"A1.p1.4.m4.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A1.p1.4.m4.1.1.3.1.cmml\" xref=\"A1.p1.4.m4.1.1.3\">superscript</csymbol><ci id=\"A1.p1.4.m4.1.1.3.2.cmml\" xref=\"A1.p1.4.m4.1.1.3.2\">ℝ</ci><apply id=\"A1.p1.4.m4.1.1.3.3.cmml\" xref=\"A1.p1.4.m4.1.1.3.3\"><times id=\"A1.p1.4.m4.1.1.3.3.1.cmml\" xref=\"A1.p1.4.m4.1.1.3.3.1\"></times><apply id=\"A1.p1.4.m4.1.1.3.3.2.cmml\" xref=\"A1.p1.4.m4.1.1.3.3.2\"><csymbol cd=\"ambiguous\" id=\"A1.p1.4.m4.1.1.3.3.2.1.cmml\" xref=\"A1.p1.4.m4.1.1.3.3.2\">subscript</csymbol><ci id=\"A1.p1.4.m4.1.1.3.3.2.2.cmml\" xref=\"A1.p1.4.m4.1.1.3.3.2.2\">𝐿</ci><ci id=\"A1.p1.4.m4.1.1.3.3.2.3.cmml\" xref=\"A1.p1.4.m4.1.1.3.3.2.3\">𝑄</ci></apply><ci id=\"A1.p1.4.m4.1.1.3.3.3.cmml\" xref=\"A1.p1.4.m4.1.1.3.3.3\">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.4.m4.1c\">\\mathbf{Q}\\in\\mathbb{R}^{L_{Q}\\times d}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.4.m4.1d\">bold_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and the key and value vectors <math alttext=\"\\mathbf{K},\\mathbf{V}\\in\\mathbb{R}^{L_{K}\\times d}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.5.m5.2\"><semantics id=\"A1.p1.5.m5.2a\"><mrow id=\"A1.p1.5.m5.2.3\" xref=\"A1.p1.5.m5.2.3.cmml\"><mrow id=\"A1.p1.5.m5.2.3.2.2\" xref=\"A1.p1.5.m5.2.3.2.1.cmml\"><mi id=\"A1.p1.5.m5.1.1\" xref=\"A1.p1.5.m5.1.1.cmml\">𝐊</mi><mo id=\"A1.p1.5.m5.2.3.2.2.1\" xref=\"A1.p1.5.m5.2.3.2.1.cmml\">,</mo><mi id=\"A1.p1.5.m5.2.2\" xref=\"A1.p1.5.m5.2.2.cmml\">𝐕</mi></mrow><mo id=\"A1.p1.5.m5.2.3.1\" xref=\"A1.p1.5.m5.2.3.1.cmml\">∈</mo><msup id=\"A1.p1.5.m5.2.3.3\" xref=\"A1.p1.5.m5.2.3.3.cmml\"><mi id=\"A1.p1.5.m5.2.3.3.2\" xref=\"A1.p1.5.m5.2.3.3.2.cmml\">ℝ</mi><mrow id=\"A1.p1.5.m5.2.3.3.3\" xref=\"A1.p1.5.m5.2.3.3.3.cmml\"><msub id=\"A1.p1.5.m5.2.3.3.3.2\" xref=\"A1.p1.5.m5.2.3.3.3.2.cmml\"><mi id=\"A1.p1.5.m5.2.3.3.3.2.2\" xref=\"A1.p1.5.m5.2.3.3.3.2.2.cmml\">L</mi><mi id=\"A1.p1.5.m5.2.3.3.3.2.3\" xref=\"A1.p1.5.m5.2.3.3.3.2.3.cmml\">K</mi></msub><mo id=\"A1.p1.5.m5.2.3.3.3.1\" lspace=\"0.222em\" rspace=\"0.222em\" xref=\"A1.p1.5.m5.2.3.3.3.1.cmml\">×</mo><mi id=\"A1.p1.5.m5.2.3.3.3.3\" xref=\"A1.p1.5.m5.2.3.3.3.3.cmml\">d</mi></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.5.m5.2b\"><apply id=\"A1.p1.5.m5.2.3.cmml\" xref=\"A1.p1.5.m5.2.3\"><in id=\"A1.p1.5.m5.2.3.1.cmml\" xref=\"A1.p1.5.m5.2.3.1\"></in><list id=\"A1.p1.5.m5.2.3.2.1.cmml\" xref=\"A1.p1.5.m5.2.3.2.2\"><ci id=\"A1.p1.5.m5.1.1.cmml\" xref=\"A1.p1.5.m5.1.1\">𝐊</ci><ci id=\"A1.p1.5.m5.2.2.cmml\" xref=\"A1.p1.5.m5.2.2\">𝐕</ci></list><apply id=\"A1.p1.5.m5.2.3.3.cmml\" xref=\"A1.p1.5.m5.2.3.3\"><csymbol cd=\"ambiguous\" id=\"A1.p1.5.m5.2.3.3.1.cmml\" xref=\"A1.p1.5.m5.2.3.3\">superscript</csymbol><ci id=\"A1.p1.5.m5.2.3.3.2.cmml\" xref=\"A1.p1.5.m5.2.3.3.2\">ℝ</ci><apply id=\"A1.p1.5.m5.2.3.3.3.cmml\" xref=\"A1.p1.5.m5.2.3.3.3\"><times id=\"A1.p1.5.m5.2.3.3.3.1.cmml\" xref=\"A1.p1.5.m5.2.3.3.3.1\"></times><apply id=\"A1.p1.5.m5.2.3.3.3.2.cmml\" xref=\"A1.p1.5.m5.2.3.3.3.2\"><csymbol cd=\"ambiguous\" id=\"A1.p1.5.m5.2.3.3.3.2.1.cmml\" xref=\"A1.p1.5.m5.2.3.3.3.2\">subscript</csymbol><ci id=\"A1.p1.5.m5.2.3.3.3.2.2.cmml\" xref=\"A1.p1.5.m5.2.3.3.3.2.2\">𝐿</ci><ci id=\"A1.p1.5.m5.2.3.3.3.2.3.cmml\" xref=\"A1.p1.5.m5.2.3.3.3.2.3\">𝐾</ci></apply><ci id=\"A1.p1.5.m5.2.3.3.3.3.cmml\" xref=\"A1.p1.5.m5.2.3.3.3.3\">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.5.m5.2c\">\\mathbf{K},\\mathbf{V}\\in\\mathbb{R}^{L_{K}\\times d}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.5.m5.2d\">bold_K , bold_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, then compute</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"A1.Ex12\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\mathrm{Attention}\\left(\\mathbf{Q},\\mathbf{K},\\mathbf{V}\\right)\\;=\\;\\mathrm{%\nsoftmax}\\,\\left(\\tfrac{\\mathbf{Q}\\,\\mathbf{K}^{\\top}}{\\sqrt{d}}\\right)\\,%\n\\mathbf{V},\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex12.m1.5\"><semantics id=\"A1.Ex12.m1.5a\"><mrow id=\"A1.Ex12.m1.5.5.1\" xref=\"A1.Ex12.m1.5.5.1.1.cmml\"><mrow id=\"A1.Ex12.m1.5.5.1.1\" xref=\"A1.Ex12.m1.5.5.1.1.cmml\"><mrow id=\"A1.Ex12.m1.5.5.1.1.2\" xref=\"A1.Ex12.m1.5.5.1.1.2.cmml\"><mi id=\"A1.Ex12.m1.5.5.1.1.2.2\" xref=\"A1.Ex12.m1.5.5.1.1.2.2.cmml\">Attention</mi><mo id=\"A1.Ex12.m1.5.5.1.1.2.1\" xref=\"A1.Ex12.m1.5.5.1.1.2.1.cmml\">⁢</mo><mrow id=\"A1.Ex12.m1.5.5.1.1.2.3.2\" xref=\"A1.Ex12.m1.5.5.1.1.2.3.1.cmml\"><mo id=\"A1.Ex12.m1.5.5.1.1.2.3.2.1\" xref=\"A1.Ex12.m1.5.5.1.1.2.3.1.cmml\">(</mo><mi id=\"A1.Ex12.m1.1.1\" xref=\"A1.Ex12.m1.1.1.cmml\">𝐐</mi><mo id=\"A1.Ex12.m1.5.5.1.1.2.3.2.2\" xref=\"A1.Ex12.m1.5.5.1.1.2.3.1.cmml\">,</mo><mi id=\"A1.Ex12.m1.2.2\" xref=\"A1.Ex12.m1.2.2.cmml\">𝐊</mi><mo id=\"A1.Ex12.m1.5.5.1.1.2.3.2.3\" xref=\"A1.Ex12.m1.5.5.1.1.2.3.1.cmml\">,</mo><mi id=\"A1.Ex12.m1.3.3\" xref=\"A1.Ex12.m1.3.3.cmml\">𝐕</mi><mo id=\"A1.Ex12.m1.5.5.1.1.2.3.2.4\" rspace=\"0.280em\" xref=\"A1.Ex12.m1.5.5.1.1.2.3.1.cmml\">)</mo></mrow></mrow><mo id=\"A1.Ex12.m1.5.5.1.1.1\" rspace=\"0.558em\" xref=\"A1.Ex12.m1.5.5.1.1.1.cmml\">=</mo><mrow id=\"A1.Ex12.m1.5.5.1.1.3\" xref=\"A1.Ex12.m1.5.5.1.1.3.cmml\"><mi id=\"A1.Ex12.m1.5.5.1.1.3.2\" xref=\"A1.Ex12.m1.5.5.1.1.3.2.cmml\">softmax</mi><mo id=\"A1.Ex12.m1.5.5.1.1.3.1\" lspace=\"0.170em\" xref=\"A1.Ex12.m1.5.5.1.1.3.1.cmml\">⁢</mo><mrow id=\"A1.Ex12.m1.5.5.1.1.3.3.2\" xref=\"A1.Ex12.m1.4.4.cmml\"><mo id=\"A1.Ex12.m1.5.5.1.1.3.3.2.1\" xref=\"A1.Ex12.m1.4.4.cmml\">(</mo><mstyle displaystyle=\"false\" id=\"A1.Ex12.m1.4.4\" xref=\"A1.Ex12.m1.4.4.cmml\"><mfrac id=\"A1.Ex12.m1.4.4a\" xref=\"A1.Ex12.m1.4.4.cmml\"><mrow id=\"A1.Ex12.m1.4.4.2\" xref=\"A1.Ex12.m1.4.4.2.cmml\"><mi id=\"A1.Ex12.m1.4.4.2.2\" xref=\"A1.Ex12.m1.4.4.2.2.cmml\">𝐐</mi><mo id=\"A1.Ex12.m1.4.4.2.1\" lspace=\"0.170em\" xref=\"A1.Ex12.m1.4.4.2.1.cmml\">⁢</mo><msup id=\"A1.Ex12.m1.4.4.2.3\" xref=\"A1.Ex12.m1.4.4.2.3.cmml\"><mi id=\"A1.Ex12.m1.4.4.2.3.2\" xref=\"A1.Ex12.m1.4.4.2.3.2.cmml\">𝐊</mi><mo id=\"A1.Ex12.m1.4.4.2.3.3\" xref=\"A1.Ex12.m1.4.4.2.3.3.cmml\">⊤</mo></msup></mrow><msqrt id=\"A1.Ex12.m1.4.4.3\" xref=\"A1.Ex12.m1.4.4.3.cmml\"><mi id=\"A1.Ex12.m1.4.4.3.2\" xref=\"A1.Ex12.m1.4.4.3.2.cmml\">d</mi></msqrt></mfrac></mstyle><mo id=\"A1.Ex12.m1.5.5.1.1.3.3.2.2\" xref=\"A1.Ex12.m1.4.4.cmml\">)</mo></mrow><mo id=\"A1.Ex12.m1.5.5.1.1.3.1a\" lspace=\"0.170em\" xref=\"A1.Ex12.m1.5.5.1.1.3.1.cmml\">⁢</mo><mi id=\"A1.Ex12.m1.5.5.1.1.3.4\" xref=\"A1.Ex12.m1.5.5.1.1.3.4.cmml\">𝐕</mi></mrow></mrow><mo id=\"A1.Ex12.m1.5.5.1.2\" xref=\"A1.Ex12.m1.5.5.1.1.cmml\">,</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.Ex12.m1.5b\"><apply id=\"A1.Ex12.m1.5.5.1.1.cmml\" xref=\"A1.Ex12.m1.5.5.1\"><eq id=\"A1.Ex12.m1.5.5.1.1.1.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.1\"></eq><apply id=\"A1.Ex12.m1.5.5.1.1.2.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.2\"><times id=\"A1.Ex12.m1.5.5.1.1.2.1.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.2.1\"></times><ci id=\"A1.Ex12.m1.5.5.1.1.2.2.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.2.2\">Attention</ci><vector id=\"A1.Ex12.m1.5.5.1.1.2.3.1.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.2.3.2\"><ci id=\"A1.Ex12.m1.1.1.cmml\" xref=\"A1.Ex12.m1.1.1\">𝐐</ci><ci id=\"A1.Ex12.m1.2.2.cmml\" xref=\"A1.Ex12.m1.2.2\">𝐊</ci><ci id=\"A1.Ex12.m1.3.3.cmml\" xref=\"A1.Ex12.m1.3.3\">𝐕</ci></vector></apply><apply id=\"A1.Ex12.m1.5.5.1.1.3.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.3\"><times id=\"A1.Ex12.m1.5.5.1.1.3.1.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.3.1\"></times><ci id=\"A1.Ex12.m1.5.5.1.1.3.2.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.3.2\">softmax</ci><apply id=\"A1.Ex12.m1.4.4.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.3.3.2\"><divide id=\"A1.Ex12.m1.4.4.1.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.3.3.2\"></divide><apply id=\"A1.Ex12.m1.4.4.2.cmml\" xref=\"A1.Ex12.m1.4.4.2\"><times id=\"A1.Ex12.m1.4.4.2.1.cmml\" xref=\"A1.Ex12.m1.4.4.2.1\"></times><ci id=\"A1.Ex12.m1.4.4.2.2.cmml\" xref=\"A1.Ex12.m1.4.4.2.2\">𝐐</ci><apply id=\"A1.Ex12.m1.4.4.2.3.cmml\" xref=\"A1.Ex12.m1.4.4.2.3\"><csymbol cd=\"ambiguous\" id=\"A1.Ex12.m1.4.4.2.3.1.cmml\" xref=\"A1.Ex12.m1.4.4.2.3\">superscript</csymbol><ci id=\"A1.Ex12.m1.4.4.2.3.2.cmml\" xref=\"A1.Ex12.m1.4.4.2.3.2\">𝐊</ci><csymbol cd=\"latexml\" id=\"A1.Ex12.m1.4.4.2.3.3.cmml\" xref=\"A1.Ex12.m1.4.4.2.3.3\">top</csymbol></apply></apply><apply id=\"A1.Ex12.m1.4.4.3.cmml\" xref=\"A1.Ex12.m1.4.4.3\"><root id=\"A1.Ex12.m1.4.4.3a.cmml\" xref=\"A1.Ex12.m1.4.4.3\"></root><ci id=\"A1.Ex12.m1.4.4.3.2.cmml\" xref=\"A1.Ex12.m1.4.4.3.2\">𝑑</ci></apply></apply><ci id=\"A1.Ex12.m1.5.5.1.1.3.4.cmml\" xref=\"A1.Ex12.m1.5.5.1.1.3.4\">𝐕</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.Ex12.m1.5c\">\\mathrm{Attention}\\left(\\mathbf{Q},\\mathbf{K},\\mathbf{V}\\right)\\;=\\;\\mathrm{%\nsoftmax}\\,\\left(\\tfrac{\\mathbf{Q}\\,\\mathbf{K}^{\\top}}{\\sqrt{d}}\\right)\\,%\n\\mathbf{V},</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.Ex12.m1.5d\">roman_Attention ( bold_Q , bold_K , bold_V ) = roman_softmax ( divide start_ARG bold_Q bold_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) bold_V ,</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"A1.p1.8\">whose dominant cost is the matrix multiplication <math alttext=\"\\mathbf{Q}\\,\\mathbf{K}^{\\top}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.6.m1.1\"><semantics id=\"A1.p1.6.m1.1a\"><mrow id=\"A1.p1.6.m1.1.1\" xref=\"A1.p1.6.m1.1.1.cmml\"><mi id=\"A1.p1.6.m1.1.1.2\" xref=\"A1.p1.6.m1.1.1.2.cmml\">𝐐</mi><mo id=\"A1.p1.6.m1.1.1.1\" lspace=\"0.170em\" xref=\"A1.p1.6.m1.1.1.1.cmml\">⁢</mo><msup id=\"A1.p1.6.m1.1.1.3\" xref=\"A1.p1.6.m1.1.1.3.cmml\"><mi id=\"A1.p1.6.m1.1.1.3.2\" xref=\"A1.p1.6.m1.1.1.3.2.cmml\">𝐊</mi><mo id=\"A1.p1.6.m1.1.1.3.3\" xref=\"A1.p1.6.m1.1.1.3.3.cmml\">⊤</mo></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.6.m1.1b\"><apply id=\"A1.p1.6.m1.1.1.cmml\" xref=\"A1.p1.6.m1.1.1\"><times id=\"A1.p1.6.m1.1.1.1.cmml\" xref=\"A1.p1.6.m1.1.1.1\"></times><ci id=\"A1.p1.6.m1.1.1.2.cmml\" xref=\"A1.p1.6.m1.1.1.2\">𝐐</ci><apply id=\"A1.p1.6.m1.1.1.3.cmml\" xref=\"A1.p1.6.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A1.p1.6.m1.1.1.3.1.cmml\" xref=\"A1.p1.6.m1.1.1.3\">superscript</csymbol><ci id=\"A1.p1.6.m1.1.1.3.2.cmml\" xref=\"A1.p1.6.m1.1.1.3.2\">𝐊</ci><csymbol cd=\"latexml\" id=\"A1.p1.6.m1.1.1.3.3.cmml\" xref=\"A1.p1.6.m1.1.1.3.3\">top</csymbol></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.6.m1.1c\">\\mathbf{Q}\\,\\mathbf{K}^{\\top}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.6.m1.1d\">bold_Q bold_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>, requiring <math alttext=\"O(L_{Q}\\,L_{K}\\,d)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.7.m2.1\"><semantics id=\"A1.p1.7.m2.1a\"><mrow id=\"A1.p1.7.m2.1.1\" xref=\"A1.p1.7.m2.1.1.cmml\"><mi id=\"A1.p1.7.m2.1.1.3\" xref=\"A1.p1.7.m2.1.1.3.cmml\">O</mi><mo id=\"A1.p1.7.m2.1.1.2\" xref=\"A1.p1.7.m2.1.1.2.cmml\">⁢</mo><mrow id=\"A1.p1.7.m2.1.1.1.1\" xref=\"A1.p1.7.m2.1.1.1.1.1.cmml\"><mo id=\"A1.p1.7.m2.1.1.1.1.2\" stretchy=\"false\" xref=\"A1.p1.7.m2.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.p1.7.m2.1.1.1.1.1\" xref=\"A1.p1.7.m2.1.1.1.1.1.cmml\"><msub id=\"A1.p1.7.m2.1.1.1.1.1.2\" xref=\"A1.p1.7.m2.1.1.1.1.1.2.cmml\"><mi id=\"A1.p1.7.m2.1.1.1.1.1.2.2\" xref=\"A1.p1.7.m2.1.1.1.1.1.2.2.cmml\">L</mi><mi id=\"A1.p1.7.m2.1.1.1.1.1.2.3\" xref=\"A1.p1.7.m2.1.1.1.1.1.2.3.cmml\">Q</mi></msub><mo id=\"A1.p1.7.m2.1.1.1.1.1.1\" xref=\"A1.p1.7.m2.1.1.1.1.1.1.cmml\">⁢</mo><msub id=\"A1.p1.7.m2.1.1.1.1.1.3\" xref=\"A1.p1.7.m2.1.1.1.1.1.3.cmml\"><mi id=\"A1.p1.7.m2.1.1.1.1.1.3.2\" xref=\"A1.p1.7.m2.1.1.1.1.1.3.2.cmml\">L</mi><mi id=\"A1.p1.7.m2.1.1.1.1.1.3.3\" xref=\"A1.p1.7.m2.1.1.1.1.1.3.3.cmml\">K</mi></msub><mo id=\"A1.p1.7.m2.1.1.1.1.1.1a\" xref=\"A1.p1.7.m2.1.1.1.1.1.1.cmml\">⁢</mo><mi id=\"A1.p1.7.m2.1.1.1.1.1.4\" xref=\"A1.p1.7.m2.1.1.1.1.1.4.cmml\">d</mi></mrow><mo id=\"A1.p1.7.m2.1.1.1.1.3\" stretchy=\"false\" xref=\"A1.p1.7.m2.1.1.1.1.1.cmml\">)</mo></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.7.m2.1b\"><apply id=\"A1.p1.7.m2.1.1.cmml\" xref=\"A1.p1.7.m2.1.1\"><times id=\"A1.p1.7.m2.1.1.2.cmml\" xref=\"A1.p1.7.m2.1.1.2\"></times><ci id=\"A1.p1.7.m2.1.1.3.cmml\" xref=\"A1.p1.7.m2.1.1.3\">𝑂</ci><apply id=\"A1.p1.7.m2.1.1.1.1.1.cmml\" xref=\"A1.p1.7.m2.1.1.1.1\"><times id=\"A1.p1.7.m2.1.1.1.1.1.1.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.1\"></times><apply id=\"A1.p1.7.m2.1.1.1.1.1.2.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A1.p1.7.m2.1.1.1.1.1.2.1.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.2\">subscript</csymbol><ci id=\"A1.p1.7.m2.1.1.1.1.1.2.2.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.2.2\">𝐿</ci><ci id=\"A1.p1.7.m2.1.1.1.1.1.2.3.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.2.3\">𝑄</ci></apply><apply id=\"A1.p1.7.m2.1.1.1.1.1.3.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A1.p1.7.m2.1.1.1.1.1.3.1.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.3\">subscript</csymbol><ci id=\"A1.p1.7.m2.1.1.1.1.1.3.2.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.3.2\">𝐿</ci><ci id=\"A1.p1.7.m2.1.1.1.1.1.3.3.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.3.3\">𝐾</ci></apply><ci id=\"A1.p1.7.m2.1.1.1.1.1.4.cmml\" xref=\"A1.p1.7.m2.1.1.1.1.1.4\">𝑑</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.7.m2.1c\">O(L_{Q}\\,L_{K}\\,d)</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.7.m2.1d\">italic_O ( italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_d )</annotation></semantics></math> operations per head. Because <math alttext=\"d\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p1.8.m3.1\"><semantics id=\"A1.p1.8.m3.1a\"><mi id=\"A1.p1.8.m3.1.1\" xref=\"A1.p1.8.m3.1.1.cmml\">d</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.p1.8.m3.1b\"><ci id=\"A1.p1.8.m3.1.1.cmml\" xref=\"A1.p1.8.m3.1.1\">𝑑</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p1.8.m3.1c\">d</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p1.8.m3.1d\">italic_d</annotation></semantics></math> is a constant for a given model, we omit it in our comparisons below.</p>\n</div>\n<div class=\"ltx_para\" id=\"A1.p2\">\n<p class=\"ltx_p\" id=\"A1.p2.4\">Next, let <math alttext=\"n\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p2.1.m1.1\"><semantics id=\"A1.p2.1.m1.1a\"><mi id=\"A1.p2.1.m1.1.1\" xref=\"A1.p2.1.m1.1.1.cmml\">n</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.p2.1.m1.1b\"><ci id=\"A1.p2.1.m1.1.1.cmml\" xref=\"A1.p2.1.m1.1.1\">𝑛</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p2.1.m1.1c\">n</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p2.1.m1.1d\">italic_n</annotation></semantics></math> be the number of tokens in the task’s query and <math alttext=\"p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p2.2.m2.1\"><semantics id=\"A1.p2.2.m2.1a\"><mi id=\"A1.p2.2.m2.1.1\" xref=\"A1.p2.2.m2.1.1.cmml\">p</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.p2.2.m2.1b\"><ci id=\"A1.p2.2.m2.1.1.cmml\" xref=\"A1.p2.2.m2.1.1\">𝑝</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p2.2.m2.1c\">p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p2.2.m2.1d\">italic_p</annotation></semantics></math> the number of additional trainable prompt or prefix tokens per layer, we analyze how the training time of each method in the <span class=\"ltx_text ltx_font_italic\" id=\"A1.p2.4.1\">In-Context Optimization</span> framework scales with <math alttext=\"n\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p2.3.m3.1\"><semantics id=\"A1.p2.3.m3.1a\"><mi id=\"A1.p2.3.m3.1.1\" xref=\"A1.p2.3.m3.1.1.cmml\">n</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.p2.3.m3.1b\"><ci id=\"A1.p2.3.m3.1.1.cmml\" xref=\"A1.p2.3.m3.1.1\">𝑛</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p2.3.m3.1c\">n</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p2.3.m3.1d\">italic_n</annotation></semantics></math> and <math alttext=\"p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.p2.4.m4.1\"><semantics id=\"A1.p2.4.m4.1a\"><mi id=\"A1.p2.4.m4.1.1\" xref=\"A1.p2.4.m4.1.1.cmml\">p</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.p2.4.m4.1b\"><ci id=\"A1.p2.4.m4.1.1.cmml\" xref=\"A1.p2.4.m4.1.1\">𝑝</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.p2.4.m4.1c\">p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.p2.4.m4.1d\">italic_p</annotation></semantics></math>.</p>\n</div>\n<section class=\"ltx_paragraph\" id=\"A1.SS0.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Test Time Training.</h4>\n<div class=\"ltx_para\" id=\"A1.SS0.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"A1.SS0.SSS0.Px1.p1.4\">At each layer of each training iteration, TTT prepends <math alttext=\"p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px1.p1.1.m1.1\"><semantics id=\"A1.SS0.SSS0.Px1.p1.1.m1.1a\"><mi id=\"A1.SS0.SSS0.Px1.p1.1.m1.1.1\" xref=\"A1.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\">p</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px1.p1.1.m1.1b\"><ci id=\"A1.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.1.m1.1.1\">𝑝</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px1.p1.1.m1.1c\">p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px1.p1.1.m1.1d\">italic_p</annotation></semantics></math> trainable tokens to the <math alttext=\"n\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px1.p1.2.m2.1\"><semantics id=\"A1.SS0.SSS0.Px1.p1.2.m2.1a\"><mi id=\"A1.SS0.SSS0.Px1.p1.2.m2.1.1\" xref=\"A1.SS0.SSS0.Px1.p1.2.m2.1.1.cmml\">n</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px1.p1.2.m2.1b\"><ci id=\"A1.SS0.SSS0.Px1.p1.2.m2.1.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.2.m2.1.1\">𝑛</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px1.p1.2.m2.1c\">n</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px1.p1.2.m2.1d\">italic_n</annotation></semantics></math> query tokens and computes their keys and values, giving <math alttext=\"L_{Q}=n+p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px1.p1.3.m3.1\"><semantics id=\"A1.SS0.SSS0.Px1.p1.3.m3.1a\"><mrow id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.cmml\"><msub id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml\"><mi id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.2\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml\">L</mi><mi id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.3\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml\">Q</mi></msub><mo id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.1\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml\">=</mo><mrow id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml\"><mi id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.2\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml\">n</mi><mo id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.1\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml\">+</mo><mi id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.3\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml\">p</mi></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px1.p1.3.m3.1b\"><apply id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1\"><eq id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.1\"></eq><apply id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2\">subscript</csymbol><ci id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.2.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.2\">𝐿</ci><ci id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.3.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.2.3\">𝑄</ci></apply><apply id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3\"><plus id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.1\"></plus><ci id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.2.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.2\">𝑛</ci><ci id=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.3.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.3.m3.1.1.3.3\">𝑝</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px1.p1.3.m3.1c\">L_{Q}=n+p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px1.p1.3.m3.1d\">italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT = italic_n + italic_p</annotation></semantics></math> and <math alttext=\"L_{K}=n+p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px1.p1.4.m4.1\"><semantics id=\"A1.SS0.SSS0.Px1.p1.4.m4.1a\"><mrow id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.cmml\"><msub id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml\"><mi id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.2\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.2.cmml\">L</mi><mi id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.3\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.3.cmml\">K</mi></msub><mo id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.1\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml\">=</mo><mrow id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml\"><mi id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.2\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml\">n</mi><mo id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.1\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.1.cmml\">+</mo><mi id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.3\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml\">p</mi></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px1.p1.4.m4.1b\"><apply id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1\"><eq id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.1\"></eq><apply id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2\">subscript</csymbol><ci id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.2.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.2\">𝐿</ci><ci id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.3.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.2.3\">𝐾</ci></apply><apply id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3\"><plus id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.1.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.1\"></plus><ci id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.2\">𝑛</ci><ci id=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml\" xref=\"A1.SS0.SSS0.Px1.p1.4.m4.1.1.3.3\">𝑝</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px1.p1.4.m4.1c\">L_{K}=n+p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px1.p1.4.m4.1d\">italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT = italic_n + italic_p</annotation></semantics></math> with a per-head cost of</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"A1.Ex13\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"O\\left((n+p)^{2}\\right).\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex13.m1.1\"><semantics id=\"A1.Ex13.m1.1a\"><mrow id=\"A1.Ex13.m1.1.1.1\" xref=\"A1.Ex13.m1.1.1.1.1.cmml\"><mrow id=\"A1.Ex13.m1.1.1.1.1\" xref=\"A1.Ex13.m1.1.1.1.1.cmml\"><mi id=\"A1.Ex13.m1.1.1.1.1.3\" xref=\"A1.Ex13.m1.1.1.1.1.3.cmml\">O</mi><mo id=\"A1.Ex13.m1.1.1.1.1.2\" xref=\"A1.Ex13.m1.1.1.1.1.2.cmml\">⁢</mo><mrow id=\"A1.Ex13.m1.1.1.1.1.1.1\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.Ex13.m1.1.1.1.1.1.1.2\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.cmml\">(</mo><msup id=\"A1.Ex13.m1.1.1.1.1.1.1.1\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.cmml\"><mrow id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml\">n</mi><mo id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\">+</mo><mi id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml\">p</mi></mrow><mo id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml\">)</mo></mrow><mn id=\"A1.Ex13.m1.1.1.1.1.1.1.1.3\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.3.cmml\">2</mn></msup><mo id=\"A1.Ex13.m1.1.1.1.1.1.1.3\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.cmml\">)</mo></mrow></mrow><mo id=\"A1.Ex13.m1.1.1.1.2\" lspace=\"0em\" xref=\"A1.Ex13.m1.1.1.1.1.cmml\">.</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.Ex13.m1.1b\"><apply id=\"A1.Ex13.m1.1.1.1.1.cmml\" xref=\"A1.Ex13.m1.1.1.1\"><times id=\"A1.Ex13.m1.1.1.1.1.2.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.2\"></times><ci id=\"A1.Ex13.m1.1.1.1.1.3.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.3\">𝑂</ci><apply id=\"A1.Ex13.m1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.Ex13.m1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.1.1\">superscript</csymbol><apply id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1\"><plus id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1\"></plus><ci id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.2\">𝑛</ci><ci id=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.1.1.1.3\">𝑝</ci></apply><cn id=\"A1.Ex13.m1.1.1.1.1.1.1.1.3.cmml\" type=\"integer\" xref=\"A1.Ex13.m1.1.1.1.1.1.1.1.3\">2</cn></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.Ex13.m1.1c\">O\\left((n+p)^{2}\\right).</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.Ex13.m1.1d\">italic_O ( ( italic_n + italic_p ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"A1.SS0.SSS0.Px2\">\n<h4 class=\"ltx_title ltx_title_paragraph\">CT-Prompt.</h4>\n<div class=\"ltx_para\" id=\"A1.SS0.SSS0.Px2.p1\">\n<p class=\"ltx_p\" id=\"A1.SS0.SSS0.Px2.p1.3\"><span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px2.p1.3.1\">CT-Prompt</span> prepends <math alttext=\"p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px2.p1.1.m1.1\"><semantics id=\"A1.SS0.SSS0.Px2.p1.1.m1.1a\"><mi id=\"A1.SS0.SSS0.Px2.p1.1.m1.1.1\" xref=\"A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml\">p</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px2.p1.1.m1.1b\"><ci id=\"A1.SS0.SSS0.Px2.p1.1.m1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.1.m1.1.1\">𝑝</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px2.p1.1.m1.1c\">p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px2.p1.1.m1.1d\">italic_p</annotation></semantics></math> trainable soft token embeddings to the query and computes their keys and values, also giving <math alttext=\"L_{Q}=n+p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px2.p1.2.m2.1\"><semantics id=\"A1.SS0.SSS0.Px2.p1.2.m2.1a\"><mrow id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml\"><msub id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml\"><mi id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.2\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml\">L</mi><mi id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.3\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml\">Q</mi></msub><mo id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.1\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml\">=</mo><mrow id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml\"><mi id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.2\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.2.cmml\">n</mi><mo id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.1\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.1.cmml\">+</mo><mi id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.3\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.cmml\">p</mi></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px2.p1.2.m2.1b\"><apply id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1\"><eq id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.1\"></eq><apply id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2\">subscript</csymbol><ci id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.2\">𝐿</ci><ci id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.3.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.2.3\">𝑄</ci></apply><apply id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3\"><plus id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.1\"></plus><ci id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.2.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.2\">𝑛</ci><ci id=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.3.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.2.m2.1.1.3.3\">𝑝</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px2.p1.2.m2.1c\">L_{Q}=n+p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px2.p1.2.m2.1d\">italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT = italic_n + italic_p</annotation></semantics></math> and <math alttext=\"L_{K}=n+p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px2.p1.3.m3.1\"><semantics id=\"A1.SS0.SSS0.Px2.p1.3.m3.1a\"><mrow id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.cmml\"><msub id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml\"><mi id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.2\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml\">L</mi><mi id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.3\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml\">K</mi></msub><mo id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.1\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml\">=</mo><mrow id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml\"><mi id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.2\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml\">n</mi><mo id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.1\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml\">+</mo><mi id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.3\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.cmml\">p</mi></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px2.p1.3.m3.1b\"><apply id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1\"><eq id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.1\"></eq><apply id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2\">subscript</csymbol><ci id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.2\">𝐿</ci><ci id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.2.3\">𝐾</ci></apply><apply id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3\"><plus id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.1\"></plus><ci id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.2\">𝑛</ci><ci id=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.cmml\" xref=\"A1.SS0.SSS0.Px2.p1.3.m3.1.1.3.3\">𝑝</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px2.p1.3.m3.1c\">L_{K}=n+p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px2.p1.3.m3.1d\">italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT = italic_n + italic_p</annotation></semantics></math> with a per-head cost of</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"A1.Ex14\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"O\\left((n+p)^{2}\\right).\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex14.m1.1\"><semantics id=\"A1.Ex14.m1.1a\"><mrow id=\"A1.Ex14.m1.1.1.1\" xref=\"A1.Ex14.m1.1.1.1.1.cmml\"><mrow id=\"A1.Ex14.m1.1.1.1.1\" xref=\"A1.Ex14.m1.1.1.1.1.cmml\"><mi id=\"A1.Ex14.m1.1.1.1.1.3\" xref=\"A1.Ex14.m1.1.1.1.1.3.cmml\">O</mi><mo id=\"A1.Ex14.m1.1.1.1.1.2\" xref=\"A1.Ex14.m1.1.1.1.1.2.cmml\">⁢</mo><mrow id=\"A1.Ex14.m1.1.1.1.1.1.1\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.Ex14.m1.1.1.1.1.1.1.2\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.cmml\">(</mo><msup id=\"A1.Ex14.m1.1.1.1.1.1.1.1\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.cmml\"><mrow id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2.cmml\">n</mi><mo id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\">+</mo><mi id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml\">p</mi></mrow><mo id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.cmml\">)</mo></mrow><mn id=\"A1.Ex14.m1.1.1.1.1.1.1.1.3\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.3.cmml\">2</mn></msup><mo id=\"A1.Ex14.m1.1.1.1.1.1.1.3\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.cmml\">)</mo></mrow></mrow><mo id=\"A1.Ex14.m1.1.1.1.2\" lspace=\"0em\" xref=\"A1.Ex14.m1.1.1.1.1.cmml\">.</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.Ex14.m1.1b\"><apply id=\"A1.Ex14.m1.1.1.1.1.cmml\" xref=\"A1.Ex14.m1.1.1.1\"><times id=\"A1.Ex14.m1.1.1.1.1.2.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.2\"></times><ci id=\"A1.Ex14.m1.1.1.1.1.3.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.3\">𝑂</ci><apply id=\"A1.Ex14.m1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.Ex14.m1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.1.1\">superscript</csymbol><apply id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1\"><plus id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1\"></plus><ci id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2\">𝑛</ci><ci id=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3\">𝑝</ci></apply><cn id=\"A1.Ex14.m1.1.1.1.1.1.1.1.3.cmml\" type=\"integer\" xref=\"A1.Ex14.m1.1.1.1.1.1.1.1.3\">2</cn></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.Ex14.m1.1c\">O\\left((n+p)^{2}\\right).</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.Ex14.m1.1d\">italic_O ( ( italic_n + italic_p ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"A1.SS0.SSS0.Px3\">\n<h4 class=\"ltx_title ltx_title_paragraph\">CT-KV.</h4>\n<div class=\"ltx_para\" id=\"A1.SS0.SSS0.Px3.p1\">\n<p class=\"ltx_p\" id=\"A1.SS0.SSS0.Px3.p1.3\">Unlike from TTT and <span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px3.p1.3.1\">CT-Prompt</span>, <span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px3.p1.3.2\">CT-KV</span> prepends <math alttext=\"p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px3.p1.1.m1.1\"><semantics id=\"A1.SS0.SSS0.Px3.p1.1.m1.1a\"><mi id=\"A1.SS0.SSS0.Px3.p1.1.m1.1.1\" xref=\"A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml\">p</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px3.p1.1.m1.1b\"><ci id=\"A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.1.m1.1.1\">𝑝</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px3.p1.1.m1.1c\">p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px3.p1.1.m1.1d\">italic_p</annotation></semantics></math> trainable tokens as past keys and values, so these tokens do not generate queries. This yields <math alttext=\"L_{Q}=n\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px3.p1.2.m2.1\"><semantics id=\"A1.SS0.SSS0.Px3.p1.2.m2.1a\"><mrow id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml\"><msub id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml\"><mi id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.2\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.2.cmml\">L</mi><mi id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.3\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.3.cmml\">Q</mi></msub><mo id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.1\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml\">=</mo><mi id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.3\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml\">n</mi></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px3.p1.2.m2.1b\"><apply id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1\"><eq id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.1\"></eq><apply id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2\">subscript</csymbol><ci id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.2.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.2\">𝐿</ci><ci id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.3.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.2.3\">𝑄</ci></apply><ci id=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.2.m2.1.1.3\">𝑛</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px3.p1.2.m2.1c\">L_{Q}=n</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px3.p1.2.m2.1d\">italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT = italic_n</annotation></semantics></math> and <math alttext=\"L_{K}=n+p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px3.p1.3.m3.1\"><semantics id=\"A1.SS0.SSS0.Px3.p1.3.m3.1a\"><mrow id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml\"><msub id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml\"><mi id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.2\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.2.cmml\">L</mi><mi id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.3\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.3.cmml\">K</mi></msub><mo id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.1\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml\">=</mo><mrow id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml\"><mi id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml\">n</mi><mo id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml\">+</mo><mi id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3.cmml\">p</mi></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px3.p1.3.m3.1b\"><apply id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1\"><eq id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.1\"></eq><apply id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2\">subscript</csymbol><ci id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.2.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.2\">𝐿</ci><ci id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.3.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.2.3\">𝐾</ci></apply><apply id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3\"><plus id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.1\"></plus><ci id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.2\">𝑛</ci><ci id=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3.cmml\" xref=\"A1.SS0.SSS0.Px3.p1.3.m3.1.1.3.3\">𝑝</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px3.p1.3.m3.1c\">L_{K}=n+p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px3.p1.3.m3.1d\">italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT = italic_n + italic_p</annotation></semantics></math> with a per-head cost of only</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"A1.Ex15\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"O\\left(n\\,(n+p)\\right).\" class=\"ltx_Math\" display=\"block\" id=\"A1.Ex15.m1.1\"><semantics id=\"A1.Ex15.m1.1a\"><mrow id=\"A1.Ex15.m1.1.1.1\" xref=\"A1.Ex15.m1.1.1.1.1.cmml\"><mrow id=\"A1.Ex15.m1.1.1.1.1\" xref=\"A1.Ex15.m1.1.1.1.1.cmml\"><mi id=\"A1.Ex15.m1.1.1.1.1.3\" xref=\"A1.Ex15.m1.1.1.1.1.3.cmml\">O</mi><mo id=\"A1.Ex15.m1.1.1.1.1.2\" xref=\"A1.Ex15.m1.1.1.1.1.2.cmml\">⁢</mo><mrow id=\"A1.Ex15.m1.1.1.1.1.1.1\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.Ex15.m1.1.1.1.1.1.1.2\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.Ex15.m1.1.1.1.1.1.1.1\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.cmml\"><mi id=\"A1.Ex15.m1.1.1.1.1.1.1.1.3\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.3.cmml\">n</mi><mo id=\"A1.Ex15.m1.1.1.1.1.1.1.1.2\" lspace=\"0.170em\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.2.cmml\">⁢</mo><mrow id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.2\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.2.cmml\">n</mi><mo id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.1\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\">+</mo><mi id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.3\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.3.cmml\">p</mi></mrow><mo id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.cmml\">)</mo></mrow></mrow><mo id=\"A1.Ex15.m1.1.1.1.1.1.1.3\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.cmml\">)</mo></mrow></mrow><mo id=\"A1.Ex15.m1.1.1.1.2\" lspace=\"0em\" xref=\"A1.Ex15.m1.1.1.1.1.cmml\">.</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.Ex15.m1.1b\"><apply id=\"A1.Ex15.m1.1.1.1.1.cmml\" xref=\"A1.Ex15.m1.1.1.1\"><times id=\"A1.Ex15.m1.1.1.1.1.2.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.2\"></times><ci id=\"A1.Ex15.m1.1.1.1.1.3.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.3\">𝑂</ci><apply id=\"A1.Ex15.m1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.1.1\"><times id=\"A1.Ex15.m1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.2\"></times><ci id=\"A1.Ex15.m1.1.1.1.1.1.1.1.3.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.3\">𝑛</ci><apply id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1\"><plus id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.1\"></plus><ci id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.2\">𝑛</ci><ci id=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"A1.Ex15.m1.1.1.1.1.1.1.1.1.1.1.3\">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.Ex15.m1.1c\">O\\left(n\\,(n+p)\\right).</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.Ex15.m1.1d\">italic_O ( italic_n ( italic_n + italic_p ) ) .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n</div>\n</section>\n<section class=\"ltx_paragraph\" id=\"A1.SS0.SSS0.Px4\">\n<h4 class=\"ltx_title ltx_title_paragraph\">Time Complexity for k Demonstrations</h4>\n<div class=\"ltx_para\" id=\"A1.SS0.SSS0.Px4.p1\">\n<p class=\"ltx_p\" id=\"A1.SS0.SSS0.Px4.p1.11\">Suppose we have <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.1.m1.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.1.m1.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.1.m1.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.1.m1.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.1.m1.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.1.m1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.1.m1.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.1.m1.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.1.m1.1d\">italic_k</annotation></semantics></math> demonstration pairs, each of length <math alttext=\"\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.2.m2.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.2.m2.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.2.m2.1.1\" mathvariant=\"normal\" xref=\"A1.SS0.SSS0.Px4.p1.2.m2.1.1.cmml\">ℓ</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.2.m2.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.2.m2.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.2.m2.1.1\">ℓ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.2.m2.1c\">\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.2.m2.1d\">roman_ℓ</annotation></semantics></math> (assuming equal length). In TTT, <math alttext=\"n=\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.3.m3.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.3.m3.1a\"><mrow id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.cmml\"><mi id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.2\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.2.cmml\">n</mi><mo id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.cmml\">=</mo><mi id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.3\" mathvariant=\"normal\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.3.cmml\">ℓ</mi></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.3.m3.1b\"><apply id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1\"><eq id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.1\"></eq><ci id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.2\">𝑛</ci><ci id=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.3.m3.1.1.3\">ℓ</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.3.m3.1c\">n=\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.3.m3.1d\">italic_n = roman_ℓ</annotation></semantics></math> is the length of a demonstration pair and <math alttext=\"p=(k-1)\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.4.m4.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.4.m4.1a\"><mrow id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.cmml\"><mi id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.3\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.3.cmml\">p</mi><mo id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.2\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.2.cmml\">=</mo><mrow id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.cmml\"><mrow id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.cmml\"><mo id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.2\" stretchy=\"false\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.cmml\"><mi id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.2\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.2.cmml\">k</mi><mo id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.1.cmml\">−</mo><mn id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.3\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.3.cmml\">1</mn></mrow><mo id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.3\" stretchy=\"false\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.cmml\">)</mo></mrow><mo id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.2\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.2.cmml\">⁢</mo><mi id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.3\" mathvariant=\"normal\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.3.cmml\">ℓ</mi></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.4.m4.1b\"><apply id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1\"><eq id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.2\"></eq><ci id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.3\">𝑝</ci><apply id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1\"><times id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.2\"></times><apply id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1\"><minus id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.1\"></minus><ci id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.2.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.2\">𝑘</ci><cn id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.3.cmml\" type=\"integer\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.1.1.1.3\">1</cn></apply><ci id=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.3.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.4.m4.1.1.1.3\">ℓ</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.4.m4.1c\">p=(k-1)\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.4.m4.1d\">italic_p = ( italic_k - 1 ) roman_ℓ</annotation></semantics></math> is the summed length of other demonstration pairs. For <span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px4.p1.11.1\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px4.p1.11.2\">CT-KV</span>, <math alttext=\"n\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.5.m5.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.5.m5.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.5.m5.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.5.m5.1.1.cmml\">n</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.5.m5.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.5.m5.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.5.m5.1.1\">𝑛</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.5.m5.1c\">n</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.5.m5.1d\">italic_n</annotation></semantics></math> and <math alttext=\"p\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.6.m6.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.6.m6.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.6.m6.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.6.m6.1.1.cmml\">p</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.6.m6.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.6.m6.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.6.m6.1.1\">𝑝</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.6.m6.1c\">p</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.6.m6.1d\">italic_p</annotation></semantics></math> have the same values as TTT because Leave One Out masks out one of the in-context demonstration pairs. Table <a class=\"ltx_ref\" href=\"#A1.T5\" title=\"Table 5 ‣ Time Complexity for k Demonstrations ‣ Appendix A Time Complexity ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">5</span></a> summarizes the per-head costs in <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.7.m7.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.7.m7.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.7.m7.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.7.m7.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.7.m7.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.7.m7.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.7.m7.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.7.m7.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.7.m7.1d\">italic_k</annotation></semantics></math> and <math alttext=\"\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.8.m8.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.8.m8.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.8.m8.1.1\" mathvariant=\"normal\" xref=\"A1.SS0.SSS0.Px4.p1.8.m8.1.1.cmml\">ℓ</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.8.m8.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.8.m8.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.8.m8.1.1\">ℓ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.8.m8.1c\">\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.8.m8.1d\">roman_ℓ</annotation></semantics></math>, showing that both <span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px4.p1.11.3\">CT-Prompt</span> and TTT incur quadratic cost in <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.9.m9.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.9.m9.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.9.m9.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.9.m9.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.9.m9.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.9.m9.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.9.m9.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.9.m9.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.9.m9.1d\">italic_k</annotation></semantics></math>, while <span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px4.p1.11.4\">CT-KV</span> grows only linearly in <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.10.m10.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.10.m10.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.10.m10.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.10.m10.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.10.m10.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.10.m10.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.10.m10.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.10.m10.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.10.m10.1d\">italic_k</annotation></semantics></math>. This <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A1.SS0.SSS0.Px4.p1.11.m11.1\"><semantics id=\"A1.SS0.SSS0.Px4.p1.11.m11.1a\"><mi id=\"A1.SS0.SSS0.Px4.p1.11.m11.1.1\" xref=\"A1.SS0.SSS0.Px4.p1.11.m11.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.SS0.SSS0.Px4.p1.11.m11.1b\"><ci id=\"A1.SS0.SSS0.Px4.p1.11.m11.1.1.cmml\" xref=\"A1.SS0.SSS0.Px4.p1.11.m11.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.SS0.SSS0.Px4.p1.11.m11.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.SS0.SSS0.Px4.p1.11.m11.1d\">italic_k</annotation></semantics></math>-fold reduction in self-attention complexity explains <span class=\"ltx_text ltx_font_italic\" id=\"A1.SS0.SSS0.Px4.p1.11.5\">CT-KV</span>’s faster empirical training speed in Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a>.</p>\n</div>\n<figure class=\"ltx_table\" id=\"A1.T5\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"A1.T5.11\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"A1.T5.2.2\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt\" id=\"A1.T5.2.2.3\">Method</th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A1.T5.1.1.1\"><math alttext=\"L_{Q}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.1.1.1.m1.1\"><semantics id=\"A1.T5.1.1.1.m1.1a\"><msub id=\"A1.T5.1.1.1.m1.1.1\" xref=\"A1.T5.1.1.1.m1.1.1.cmml\"><mi id=\"A1.T5.1.1.1.m1.1.1.2\" xref=\"A1.T5.1.1.1.m1.1.1.2.cmml\">L</mi><mi id=\"A1.T5.1.1.1.m1.1.1.3\" xref=\"A1.T5.1.1.1.m1.1.1.3.cmml\">Q</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.1.1.1.m1.1b\"><apply id=\"A1.T5.1.1.1.m1.1.1.cmml\" xref=\"A1.T5.1.1.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.T5.1.1.1.m1.1.1.1.cmml\" xref=\"A1.T5.1.1.1.m1.1.1\">subscript</csymbol><ci id=\"A1.T5.1.1.1.m1.1.1.2.cmml\" xref=\"A1.T5.1.1.1.m1.1.1.2\">𝐿</ci><ci id=\"A1.T5.1.1.1.m1.1.1.3.cmml\" xref=\"A1.T5.1.1.1.m1.1.1.3\">𝑄</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.1.1.1.m1.1c\">L_{Q}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.1.1.1.m1.1d\">italic_L start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A1.T5.2.2.2\"><math alttext=\"L_{K}\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.2.2.2.m1.1\"><semantics id=\"A1.T5.2.2.2.m1.1a\"><msub id=\"A1.T5.2.2.2.m1.1.1\" xref=\"A1.T5.2.2.2.m1.1.1.cmml\"><mi id=\"A1.T5.2.2.2.m1.1.1.2\" xref=\"A1.T5.2.2.2.m1.1.1.2.cmml\">L</mi><mi id=\"A1.T5.2.2.2.m1.1.1.3\" xref=\"A1.T5.2.2.2.m1.1.1.3.cmml\">K</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.2.2.2.m1.1b\"><apply id=\"A1.T5.2.2.2.m1.1.1.cmml\" xref=\"A1.T5.2.2.2.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.T5.2.2.2.m1.1.1.1.cmml\" xref=\"A1.T5.2.2.2.m1.1.1\">subscript</csymbol><ci id=\"A1.T5.2.2.2.m1.1.1.2.cmml\" xref=\"A1.T5.2.2.2.m1.1.1.2\">𝐿</ci><ci id=\"A1.T5.2.2.2.m1.1.1.3.cmml\" xref=\"A1.T5.2.2.2.m1.1.1.3\">𝐾</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.2.2.2.m1.1c\">L_{K}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.2.2.2.m1.1d\">italic_L start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A1.T5.2.2.4\">Per-Head Cost</th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"A1.T5.5.5\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" id=\"A1.T5.5.5.4\">TTT</th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A1.T5.3.3.1\"><math alttext=\"k\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.3.3.1.m1.1\"><semantics id=\"A1.T5.3.3.1.m1.1a\"><mrow id=\"A1.T5.3.3.1.m1.1.1\" xref=\"A1.T5.3.3.1.m1.1.1.cmml\"><mi id=\"A1.T5.3.3.1.m1.1.1.2\" xref=\"A1.T5.3.3.1.m1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.3.3.1.m1.1.1.1\" xref=\"A1.T5.3.3.1.m1.1.1.1.cmml\">⁢</mo><mi id=\"A1.T5.3.3.1.m1.1.1.3\" mathvariant=\"normal\" xref=\"A1.T5.3.3.1.m1.1.1.3.cmml\">ℓ</mi></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.3.3.1.m1.1b\"><apply id=\"A1.T5.3.3.1.m1.1.1.cmml\" xref=\"A1.T5.3.3.1.m1.1.1\"><times id=\"A1.T5.3.3.1.m1.1.1.1.cmml\" xref=\"A1.T5.3.3.1.m1.1.1.1\"></times><ci id=\"A1.T5.3.3.1.m1.1.1.2.cmml\" xref=\"A1.T5.3.3.1.m1.1.1.2\">𝑘</ci><ci id=\"A1.T5.3.3.1.m1.1.1.3.cmml\" xref=\"A1.T5.3.3.1.m1.1.1.3\">ℓ</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.3.3.1.m1.1c\">k\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.3.3.1.m1.1d\">italic_k roman_ℓ</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A1.T5.4.4.2\"><math alttext=\"k\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.4.4.2.m1.1\"><semantics id=\"A1.T5.4.4.2.m1.1a\"><mrow id=\"A1.T5.4.4.2.m1.1.1\" xref=\"A1.T5.4.4.2.m1.1.1.cmml\"><mi id=\"A1.T5.4.4.2.m1.1.1.2\" xref=\"A1.T5.4.4.2.m1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.4.4.2.m1.1.1.1\" xref=\"A1.T5.4.4.2.m1.1.1.1.cmml\">⁢</mo><mi id=\"A1.T5.4.4.2.m1.1.1.3\" mathvariant=\"normal\" xref=\"A1.T5.4.4.2.m1.1.1.3.cmml\">ℓ</mi></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.4.4.2.m1.1b\"><apply id=\"A1.T5.4.4.2.m1.1.1.cmml\" xref=\"A1.T5.4.4.2.m1.1.1\"><times id=\"A1.T5.4.4.2.m1.1.1.1.cmml\" xref=\"A1.T5.4.4.2.m1.1.1.1\"></times><ci id=\"A1.T5.4.4.2.m1.1.1.2.cmml\" xref=\"A1.T5.4.4.2.m1.1.1.2\">𝑘</ci><ci id=\"A1.T5.4.4.2.m1.1.1.3.cmml\" xref=\"A1.T5.4.4.2.m1.1.1.3\">ℓ</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.4.4.2.m1.1c\">k\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.4.4.2.m1.1d\">italic_k roman_ℓ</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A1.T5.5.5.3\"><math alttext=\"O\\left((k\\ell)^{2}\\right)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.5.5.3.m1.1\"><semantics id=\"A1.T5.5.5.3.m1.1a\"><mrow id=\"A1.T5.5.5.3.m1.1.1\" xref=\"A1.T5.5.5.3.m1.1.1.cmml\"><mi id=\"A1.T5.5.5.3.m1.1.1.3\" xref=\"A1.T5.5.5.3.m1.1.1.3.cmml\">O</mi><mo id=\"A1.T5.5.5.3.m1.1.1.2\" xref=\"A1.T5.5.5.3.m1.1.1.2.cmml\">⁢</mo><mrow id=\"A1.T5.5.5.3.m1.1.1.1.1\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.cmml\"><mo id=\"A1.T5.5.5.3.m1.1.1.1.1.2\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.cmml\">(</mo><msup id=\"A1.T5.5.5.3.m1.1.1.1.1.1\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.cmml\"><mrow id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.2\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.1\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.1.cmml\">⁢</mo><mi id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.3\" mathvariant=\"normal\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.3.cmml\">ℓ</mi></mrow><mo id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.cmml\">)</mo></mrow><mn id=\"A1.T5.5.5.3.m1.1.1.1.1.1.3\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.3.cmml\">2</mn></msup><mo id=\"A1.T5.5.5.3.m1.1.1.1.1.3\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.cmml\">)</mo></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.5.5.3.m1.1b\"><apply id=\"A1.T5.5.5.3.m1.1.1.cmml\" xref=\"A1.T5.5.5.3.m1.1.1\"><times id=\"A1.T5.5.5.3.m1.1.1.2.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.2\"></times><ci id=\"A1.T5.5.5.3.m1.1.1.3.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.3\">𝑂</ci><apply id=\"A1.T5.5.5.3.m1.1.1.1.1.1.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.T5.5.5.3.m1.1.1.1.1.1.2.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.1.1\">superscript</csymbol><apply id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1\"><times id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.1\"></times><ci id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.2\">𝑘</ci><ci id=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.1.1.1.3\">ℓ</ci></apply><cn id=\"A1.T5.5.5.3.m1.1.1.1.1.1.3.cmml\" type=\"integer\" xref=\"A1.T5.5.5.3.m1.1.1.1.1.1.3\">2</cn></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.5.5.3.m1.1c\">O\\left((k\\ell)^{2}\\right)</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.5.5.3.m1.1d\">italic_O ( ( italic_k roman_ℓ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A1.T5.8.8\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A1.T5.8.8.4\">CT-Prompt</th>\n<td class=\"ltx_td ltx_align_center\" id=\"A1.T5.6.6.1\"><math alttext=\"k\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.6.6.1.m1.1\"><semantics id=\"A1.T5.6.6.1.m1.1a\"><mrow id=\"A1.T5.6.6.1.m1.1.1\" xref=\"A1.T5.6.6.1.m1.1.1.cmml\"><mi id=\"A1.T5.6.6.1.m1.1.1.2\" xref=\"A1.T5.6.6.1.m1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.6.6.1.m1.1.1.1\" xref=\"A1.T5.6.6.1.m1.1.1.1.cmml\">⁢</mo><mi id=\"A1.T5.6.6.1.m1.1.1.3\" mathvariant=\"normal\" xref=\"A1.T5.6.6.1.m1.1.1.3.cmml\">ℓ</mi></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.6.6.1.m1.1b\"><apply id=\"A1.T5.6.6.1.m1.1.1.cmml\" xref=\"A1.T5.6.6.1.m1.1.1\"><times id=\"A1.T5.6.6.1.m1.1.1.1.cmml\" xref=\"A1.T5.6.6.1.m1.1.1.1\"></times><ci id=\"A1.T5.6.6.1.m1.1.1.2.cmml\" xref=\"A1.T5.6.6.1.m1.1.1.2\">𝑘</ci><ci id=\"A1.T5.6.6.1.m1.1.1.3.cmml\" xref=\"A1.T5.6.6.1.m1.1.1.3\">ℓ</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.6.6.1.m1.1c\">k\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.6.6.1.m1.1d\">italic_k roman_ℓ</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A1.T5.7.7.2\"><math alttext=\"k\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.7.7.2.m1.1\"><semantics id=\"A1.T5.7.7.2.m1.1a\"><mrow id=\"A1.T5.7.7.2.m1.1.1\" xref=\"A1.T5.7.7.2.m1.1.1.cmml\"><mi id=\"A1.T5.7.7.2.m1.1.1.2\" xref=\"A1.T5.7.7.2.m1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.7.7.2.m1.1.1.1\" xref=\"A1.T5.7.7.2.m1.1.1.1.cmml\">⁢</mo><mi id=\"A1.T5.7.7.2.m1.1.1.3\" mathvariant=\"normal\" xref=\"A1.T5.7.7.2.m1.1.1.3.cmml\">ℓ</mi></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.7.7.2.m1.1b\"><apply id=\"A1.T5.7.7.2.m1.1.1.cmml\" xref=\"A1.T5.7.7.2.m1.1.1\"><times id=\"A1.T5.7.7.2.m1.1.1.1.cmml\" xref=\"A1.T5.7.7.2.m1.1.1.1\"></times><ci id=\"A1.T5.7.7.2.m1.1.1.2.cmml\" xref=\"A1.T5.7.7.2.m1.1.1.2\">𝑘</ci><ci id=\"A1.T5.7.7.2.m1.1.1.3.cmml\" xref=\"A1.T5.7.7.2.m1.1.1.3\">ℓ</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.7.7.2.m1.1c\">k\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.7.7.2.m1.1d\">italic_k roman_ℓ</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A1.T5.8.8.3\"><math alttext=\"O\\left((k\\ell)^{2}\\right)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.8.8.3.m1.1\"><semantics id=\"A1.T5.8.8.3.m1.1a\"><mrow id=\"A1.T5.8.8.3.m1.1.1\" xref=\"A1.T5.8.8.3.m1.1.1.cmml\"><mi id=\"A1.T5.8.8.3.m1.1.1.3\" xref=\"A1.T5.8.8.3.m1.1.1.3.cmml\">O</mi><mo id=\"A1.T5.8.8.3.m1.1.1.2\" xref=\"A1.T5.8.8.3.m1.1.1.2.cmml\">⁢</mo><mrow id=\"A1.T5.8.8.3.m1.1.1.1.1\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.cmml\"><mo id=\"A1.T5.8.8.3.m1.1.1.1.1.2\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.cmml\">(</mo><msup id=\"A1.T5.8.8.3.m1.1.1.1.1.1\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.cmml\"><mrow id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.cmml\"><mo id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.cmml\"><mi id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.2\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.1\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.1.cmml\">⁢</mo><mi id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.3\" mathvariant=\"normal\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.3.cmml\">ℓ</mi></mrow><mo id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.cmml\">)</mo></mrow><mn id=\"A1.T5.8.8.3.m1.1.1.1.1.1.3\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.3.cmml\">2</mn></msup><mo id=\"A1.T5.8.8.3.m1.1.1.1.1.3\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.cmml\">)</mo></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.8.8.3.m1.1b\"><apply id=\"A1.T5.8.8.3.m1.1.1.cmml\" xref=\"A1.T5.8.8.3.m1.1.1\"><times id=\"A1.T5.8.8.3.m1.1.1.2.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.2\"></times><ci id=\"A1.T5.8.8.3.m1.1.1.3.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.3\">𝑂</ci><apply id=\"A1.T5.8.8.3.m1.1.1.1.1.1.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"A1.T5.8.8.3.m1.1.1.1.1.1.2.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.1.1\">superscript</csymbol><apply id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1\"><times id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.1\"></times><ci id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.2\">𝑘</ci><ci id=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.1.1.1.3\">ℓ</ci></apply><cn id=\"A1.T5.8.8.3.m1.1.1.1.1.1.3.cmml\" type=\"integer\" xref=\"A1.T5.8.8.3.m1.1.1.1.1.1.3\">2</cn></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.8.8.3.m1.1c\">O\\left((k\\ell)^{2}\\right)</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.8.8.3.m1.1d\">italic_O ( ( italic_k roman_ℓ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A1.T5.11.11\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb\" id=\"A1.T5.11.11.4\">CT-KV</th>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A1.T5.9.9.1\"><math alttext=\"\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.9.9.1.m1.1\"><semantics id=\"A1.T5.9.9.1.m1.1a\"><mi id=\"A1.T5.9.9.1.m1.1.1\" mathvariant=\"normal\" xref=\"A1.T5.9.9.1.m1.1.1.cmml\">ℓ</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.9.9.1.m1.1b\"><ci id=\"A1.T5.9.9.1.m1.1.1.cmml\" xref=\"A1.T5.9.9.1.m1.1.1\">ℓ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.9.9.1.m1.1c\">\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.9.9.1.m1.1d\">roman_ℓ</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A1.T5.10.10.2\"><math alttext=\"k\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.10.10.2.m1.1\"><semantics id=\"A1.T5.10.10.2.m1.1a\"><mrow id=\"A1.T5.10.10.2.m1.1.1\" xref=\"A1.T5.10.10.2.m1.1.1.cmml\"><mi id=\"A1.T5.10.10.2.m1.1.1.2\" xref=\"A1.T5.10.10.2.m1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.10.10.2.m1.1.1.1\" xref=\"A1.T5.10.10.2.m1.1.1.1.cmml\">⁢</mo><mi id=\"A1.T5.10.10.2.m1.1.1.3\" mathvariant=\"normal\" xref=\"A1.T5.10.10.2.m1.1.1.3.cmml\">ℓ</mi></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.10.10.2.m1.1b\"><apply id=\"A1.T5.10.10.2.m1.1.1.cmml\" xref=\"A1.T5.10.10.2.m1.1.1\"><times id=\"A1.T5.10.10.2.m1.1.1.1.cmml\" xref=\"A1.T5.10.10.2.m1.1.1.1\"></times><ci id=\"A1.T5.10.10.2.m1.1.1.2.cmml\" xref=\"A1.T5.10.10.2.m1.1.1.2\">𝑘</ci><ci id=\"A1.T5.10.10.2.m1.1.1.3.cmml\" xref=\"A1.T5.10.10.2.m1.1.1.3\">ℓ</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.10.10.2.m1.1c\">k\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.10.10.2.m1.1d\">italic_k roman_ℓ</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A1.T5.11.11.3\"><math alttext=\"O\\left(k\\,\\ell^{2}\\right)\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.11.11.3.m1.1\"><semantics id=\"A1.T5.11.11.3.m1.1a\"><mrow id=\"A1.T5.11.11.3.m1.1.1\" xref=\"A1.T5.11.11.3.m1.1.1.cmml\"><mi id=\"A1.T5.11.11.3.m1.1.1.3\" xref=\"A1.T5.11.11.3.m1.1.1.3.cmml\">O</mi><mo id=\"A1.T5.11.11.3.m1.1.1.2\" xref=\"A1.T5.11.11.3.m1.1.1.2.cmml\">⁢</mo><mrow id=\"A1.T5.11.11.3.m1.1.1.1.1\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.cmml\"><mo id=\"A1.T5.11.11.3.m1.1.1.1.1.2\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.cmml\">(</mo><mrow id=\"A1.T5.11.11.3.m1.1.1.1.1.1\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.cmml\"><mi id=\"A1.T5.11.11.3.m1.1.1.1.1.1.2\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.2.cmml\">k</mi><mo id=\"A1.T5.11.11.3.m1.1.1.1.1.1.1\" lspace=\"0.170em\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.1.cmml\">⁢</mo><msup id=\"A1.T5.11.11.3.m1.1.1.1.1.1.3\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.cmml\"><mi id=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.2\" mathvariant=\"normal\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.2.cmml\">ℓ</mi><mn id=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.3\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.3.cmml\">2</mn></msup></mrow><mo id=\"A1.T5.11.11.3.m1.1.1.1.1.3\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.cmml\">)</mo></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.11.11.3.m1.1b\"><apply id=\"A1.T5.11.11.3.m1.1.1.cmml\" xref=\"A1.T5.11.11.3.m1.1.1\"><times id=\"A1.T5.11.11.3.m1.1.1.2.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.2\"></times><ci id=\"A1.T5.11.11.3.m1.1.1.3.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.3\">𝑂</ci><apply id=\"A1.T5.11.11.3.m1.1.1.1.1.1.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.1.1\"><times id=\"A1.T5.11.11.3.m1.1.1.1.1.1.1.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.1\"></times><ci id=\"A1.T5.11.11.3.m1.1.1.1.1.1.2.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.2\">𝑘</ci><apply id=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.1.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.3\">superscript</csymbol><ci id=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.2.cmml\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.2\">ℓ</ci><cn id=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.3.cmml\" type=\"integer\" xref=\"A1.T5.11.11.3.m1.1.1.1.1.1.3.3\">2</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.11.11.3.m1.1c\">O\\left(k\\,\\ell^{2}\\right)</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.11.11.3.m1.1d\">italic_O ( italic_k roman_ℓ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_table\">Table 5: </span>\nPer-head self-attention time complexity for methods with <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.14.m1.1\"><semantics id=\"A1.T5.14.m1.1b\"><mi id=\"A1.T5.14.m1.1.1\" xref=\"A1.T5.14.m1.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.14.m1.1c\"><ci id=\"A1.T5.14.m1.1.1.cmml\" xref=\"A1.T5.14.m1.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.14.m1.1d\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.14.m1.1e\">italic_k</annotation></semantics></math> demonstration pairs of length <math alttext=\"\\ell\" class=\"ltx_Math\" display=\"inline\" id=\"A1.T5.15.m2.1\"><semantics id=\"A1.T5.15.m2.1b\"><mi id=\"A1.T5.15.m2.1.1\" mathvariant=\"normal\" xref=\"A1.T5.15.m2.1.1.cmml\">ℓ</mi><annotation-xml encoding=\"MathML-Content\" id=\"A1.T5.15.m2.1c\"><ci id=\"A1.T5.15.m2.1.1.cmml\" xref=\"A1.T5.15.m2.1.1\">ℓ</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A1.T5.15.m2.1d\">\\ell</annotation><annotation encoding=\"application/x-llamapun\" id=\"A1.T5.15.m2.1e\">roman_ℓ</annotation></semantics></math>.\n</figcaption>\n</figure>\n</section>\n</section>\n<section class=\"ltx_appendix\" id=\"A2\">\n<h2 class=\"ltx_title ltx_title_appendix\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix B </span>Prompt Tuning and Prefix Tuning with Other Initialization Schemes</h2>\n<figure class=\"ltx_table\" id=\"A2.T6\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"A2.T6.5\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"A2.T6.5.6.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt\" id=\"A2.T6.5.6.1.1\"><span class=\"ltx_text ltx_font_bold\" id=\"A2.T6.5.6.1.1.1\" style=\"font-size:90%;\">Method</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A2.T6.5.6.1.2\"><span class=\"ltx_text ltx_font_bold\" id=\"A2.T6.5.6.1.2.1\" style=\"font-size:90%;\">NLP-LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A2.T6.5.6.1.3\"><span class=\"ltx_text ltx_font_bold\" id=\"A2.T6.5.6.1.3.1\" style=\"font-size:90%;\">MMLU</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A2.T6.5.6.1.4\"><span class=\"ltx_text ltx_font_bold\" id=\"A2.T6.5.6.1.4.1\" style=\"font-size:90%;\">BBH</span></th>\n<th class=\"ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A2.T6.5.6.1.5\"><span class=\"ltx_text ltx_font_bold\" id=\"A2.T6.5.6.1.5.1\" style=\"font-size:90%;\">ARC</span></th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"A2.T6.1.1\">\n<td class=\"ltx_td ltx_align_left ltx_border_t\" id=\"A2.T6.1.1.1\">\n<span class=\"ltx_text\" id=\"A2.T6.1.1.1.1\" style=\"font-size:90%;\">Prompt Tuning (</span><math alttext=\"m=32\" class=\"ltx_Math\" display=\"inline\" id=\"A2.T6.1.1.1.m1.1\"><semantics id=\"A2.T6.1.1.1.m1.1a\"><mrow id=\"A2.T6.1.1.1.m1.1.1\" xref=\"A2.T6.1.1.1.m1.1.1.cmml\"><mi id=\"A2.T6.1.1.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A2.T6.1.1.1.m1.1.1.2.cmml\">m</mi><mo id=\"A2.T6.1.1.1.m1.1.1.1\" mathsize=\"90%\" xref=\"A2.T6.1.1.1.m1.1.1.1.cmml\">=</mo><mn id=\"A2.T6.1.1.1.m1.1.1.3\" mathsize=\"90%\" xref=\"A2.T6.1.1.1.m1.1.1.3.cmml\">32</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A2.T6.1.1.1.m1.1b\"><apply id=\"A2.T6.1.1.1.m1.1.1.cmml\" xref=\"A2.T6.1.1.1.m1.1.1\"><eq id=\"A2.T6.1.1.1.m1.1.1.1.cmml\" xref=\"A2.T6.1.1.1.m1.1.1.1\"></eq><ci id=\"A2.T6.1.1.1.m1.1.1.2.cmml\" xref=\"A2.T6.1.1.1.m1.1.1.2\">𝑚</ci><cn id=\"A2.T6.1.1.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"A2.T6.1.1.1.m1.1.1.3\">32</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A2.T6.1.1.1.m1.1c\">m=32</annotation><annotation encoding=\"application/x-llamapun\" id=\"A2.T6.1.1.1.m1.1d\">italic_m = 32</annotation></semantics></math><span class=\"ltx_text\" id=\"A2.T6.1.1.1.2\" style=\"font-size:90%;\">, uniform)</span>\n</td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A2.T6.1.1.2\"><span class=\"ltx_text\" id=\"A2.T6.1.1.2.1\" style=\"font-size:90%;\">39.4</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A2.T6.1.1.3\"><span class=\"ltx_text\" id=\"A2.T6.1.1.3.1\" style=\"font-size:90%;\">34.3</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A2.T6.1.1.4\"><span class=\"ltx_text\" id=\"A2.T6.1.1.4.1\" style=\"font-size:90%;\">34.4</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_t\" id=\"A2.T6.1.1.5\"><span class=\"ltx_text\" id=\"A2.T6.1.1.5.1\" style=\"font-size:90%;\">5.0</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A2.T6.2.2\">\n<td class=\"ltx_td ltx_align_left\" id=\"A2.T6.2.2.1\">\n<span class=\"ltx_text\" id=\"A2.T6.2.2.1.1\" style=\"font-size:90%;\">Prompt Tuning (</span><math alttext=\"m=32\" class=\"ltx_Math\" display=\"inline\" id=\"A2.T6.2.2.1.m1.1\"><semantics id=\"A2.T6.2.2.1.m1.1a\"><mrow id=\"A2.T6.2.2.1.m1.1.1\" xref=\"A2.T6.2.2.1.m1.1.1.cmml\"><mi id=\"A2.T6.2.2.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A2.T6.2.2.1.m1.1.1.2.cmml\">m</mi><mo id=\"A2.T6.2.2.1.m1.1.1.1\" mathsize=\"90%\" xref=\"A2.T6.2.2.1.m1.1.1.1.cmml\">=</mo><mn id=\"A2.T6.2.2.1.m1.1.1.3\" mathsize=\"90%\" xref=\"A2.T6.2.2.1.m1.1.1.3.cmml\">32</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A2.T6.2.2.1.m1.1b\"><apply id=\"A2.T6.2.2.1.m1.1.1.cmml\" xref=\"A2.T6.2.2.1.m1.1.1\"><eq id=\"A2.T6.2.2.1.m1.1.1.1.cmml\" xref=\"A2.T6.2.2.1.m1.1.1.1\"></eq><ci id=\"A2.T6.2.2.1.m1.1.1.2.cmml\" xref=\"A2.T6.2.2.1.m1.1.1.2\">𝑚</ci><cn id=\"A2.T6.2.2.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"A2.T6.2.2.1.m1.1.1.3\">32</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A2.T6.2.2.1.m1.1c\">m=32</annotation><annotation encoding=\"application/x-llamapun\" id=\"A2.T6.2.2.1.m1.1d\">italic_m = 32</annotation></semantics></math><span class=\"ltx_text\" id=\"A2.T6.2.2.1.2\" style=\"font-size:90%;\">, token)</span>\n</td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.2.2.2\"><span class=\"ltx_text\" id=\"A2.T6.2.2.2.1\" style=\"font-size:90%;\">41.4</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.2.2.3\"><span class=\"ltx_text\" id=\"A2.T6.2.2.3.1\" style=\"font-size:90%;\">39.2</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.2.2.4\"><span class=\"ltx_text\" id=\"A2.T6.2.2.4.1\" style=\"font-size:90%;\">50.8</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A2.T6.2.2.5\"><span class=\"ltx_text\" id=\"A2.T6.2.2.5.1\" style=\"font-size:90%;\">12.0</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A2.T6.3.3\">\n<td class=\"ltx_td ltx_align_left\" id=\"A2.T6.3.3.1\">\n<span class=\"ltx_text\" id=\"A2.T6.3.3.1.1\" style=\"font-size:90%;\">Prefix Tuning (</span><math alttext=\"m=32\" class=\"ltx_Math\" display=\"inline\" id=\"A2.T6.3.3.1.m1.1\"><semantics id=\"A2.T6.3.3.1.m1.1a\"><mrow id=\"A2.T6.3.3.1.m1.1.1\" xref=\"A2.T6.3.3.1.m1.1.1.cmml\"><mi id=\"A2.T6.3.3.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A2.T6.3.3.1.m1.1.1.2.cmml\">m</mi><mo id=\"A2.T6.3.3.1.m1.1.1.1\" mathsize=\"90%\" xref=\"A2.T6.3.3.1.m1.1.1.1.cmml\">=</mo><mn id=\"A2.T6.3.3.1.m1.1.1.3\" mathsize=\"90%\" xref=\"A2.T6.3.3.1.m1.1.1.3.cmml\">32</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A2.T6.3.3.1.m1.1b\"><apply id=\"A2.T6.3.3.1.m1.1.1.cmml\" xref=\"A2.T6.3.3.1.m1.1.1\"><eq id=\"A2.T6.3.3.1.m1.1.1.1.cmml\" xref=\"A2.T6.3.3.1.m1.1.1.1\"></eq><ci id=\"A2.T6.3.3.1.m1.1.1.2.cmml\" xref=\"A2.T6.3.3.1.m1.1.1.2\">𝑚</ci><cn id=\"A2.T6.3.3.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"A2.T6.3.3.1.m1.1.1.3\">32</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A2.T6.3.3.1.m1.1c\">m=32</annotation><annotation encoding=\"application/x-llamapun\" id=\"A2.T6.3.3.1.m1.1d\">italic_m = 32</annotation></semantics></math><span class=\"ltx_text\" id=\"A2.T6.3.3.1.2\" style=\"font-size:90%;\">, uniform)</span>\n</td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.3.3.2\"><span class=\"ltx_text\" id=\"A2.T6.3.3.2.1\" style=\"font-size:90%;\">38.2</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.3.3.3\"><span class=\"ltx_text\" id=\"A2.T6.3.3.3.1\" style=\"font-size:90%;\">26.8</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.3.3.4\"><span class=\"ltx_text\" id=\"A2.T6.3.3.4.1\" style=\"font-size:90%;\">10.22</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A2.T6.3.3.5\"><span class=\"ltx_text\" id=\"A2.T6.3.3.5.1\" style=\"font-size:90%;\">3.3</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A2.T6.4.4\">\n<td class=\"ltx_td ltx_align_left\" id=\"A2.T6.4.4.1\">\n<span class=\"ltx_text\" id=\"A2.T6.4.4.1.1\" style=\"font-size:90%;\">Prefix Tuning (</span><math alttext=\"m=32\" class=\"ltx_Math\" display=\"inline\" id=\"A2.T6.4.4.1.m1.1\"><semantics id=\"A2.T6.4.4.1.m1.1a\"><mrow id=\"A2.T6.4.4.1.m1.1.1\" xref=\"A2.T6.4.4.1.m1.1.1.cmml\"><mi id=\"A2.T6.4.4.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A2.T6.4.4.1.m1.1.1.2.cmml\">m</mi><mo id=\"A2.T6.4.4.1.m1.1.1.1\" mathsize=\"90%\" xref=\"A2.T6.4.4.1.m1.1.1.1.cmml\">=</mo><mn id=\"A2.T6.4.4.1.m1.1.1.3\" mathsize=\"90%\" xref=\"A2.T6.4.4.1.m1.1.1.3.cmml\">32</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A2.T6.4.4.1.m1.1b\"><apply id=\"A2.T6.4.4.1.m1.1.1.cmml\" xref=\"A2.T6.4.4.1.m1.1.1\"><eq id=\"A2.T6.4.4.1.m1.1.1.1.cmml\" xref=\"A2.T6.4.4.1.m1.1.1.1\"></eq><ci id=\"A2.T6.4.4.1.m1.1.1.2.cmml\" xref=\"A2.T6.4.4.1.m1.1.1.2\">𝑚</ci><cn id=\"A2.T6.4.4.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"A2.T6.4.4.1.m1.1.1.3\">32</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A2.T6.4.4.1.m1.1c\">m=32</annotation><annotation encoding=\"application/x-llamapun\" id=\"A2.T6.4.4.1.m1.1d\">italic_m = 32</annotation></semantics></math><span class=\"ltx_text\" id=\"A2.T6.4.4.1.2\" style=\"font-size:90%;\">, MLP)</span>\n</td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.4.4.2\"><span class=\"ltx_text\" id=\"A2.T6.4.4.2.1\" style=\"font-size:90%;\">39.6</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.4.4.3\"><span class=\"ltx_text\" id=\"A2.T6.4.4.3.1\" style=\"font-size:90%;\">26.2</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A2.T6.4.4.4\"><span class=\"ltx_text\" id=\"A2.T6.4.4.4.1\" style=\"font-size:90%;\">11.03</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A2.T6.4.4.5\"><span class=\"ltx_text\" id=\"A2.T6.4.4.5.1\" style=\"font-size:90%;\">7.3</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A2.T6.5.5\">\n<td class=\"ltx_td ltx_align_left ltx_border_bb\" id=\"A2.T6.5.5.1\">\n<span class=\"ltx_text\" id=\"A2.T6.5.5.1.1\" style=\"font-size:90%;\">Prefix Tuning (</span><math alttext=\"m=32\" class=\"ltx_Math\" display=\"inline\" id=\"A2.T6.5.5.1.m1.1\"><semantics id=\"A2.T6.5.5.1.m1.1a\"><mrow id=\"A2.T6.5.5.1.m1.1.1\" xref=\"A2.T6.5.5.1.m1.1.1.cmml\"><mi id=\"A2.T6.5.5.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A2.T6.5.5.1.m1.1.1.2.cmml\">m</mi><mo id=\"A2.T6.5.5.1.m1.1.1.1\" mathsize=\"90%\" xref=\"A2.T6.5.5.1.m1.1.1.1.cmml\">=</mo><mn id=\"A2.T6.5.5.1.m1.1.1.3\" mathsize=\"90%\" xref=\"A2.T6.5.5.1.m1.1.1.3.cmml\">32</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A2.T6.5.5.1.m1.1b\"><apply id=\"A2.T6.5.5.1.m1.1.1.cmml\" xref=\"A2.T6.5.5.1.m1.1.1\"><eq id=\"A2.T6.5.5.1.m1.1.1.1.cmml\" xref=\"A2.T6.5.5.1.m1.1.1.1\"></eq><ci id=\"A2.T6.5.5.1.m1.1.1.2.cmml\" xref=\"A2.T6.5.5.1.m1.1.1.2\">𝑚</ci><cn id=\"A2.T6.5.5.1.m1.1.1.3.cmml\" type=\"integer\" xref=\"A2.T6.5.5.1.m1.1.1.3\">32</cn></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A2.T6.5.5.1.m1.1c\">m=32</annotation><annotation encoding=\"application/x-llamapun\" id=\"A2.T6.5.5.1.m1.1d\">italic_m = 32</annotation></semantics></math><span class=\"ltx_text\" id=\"A2.T6.5.5.1.2\" style=\"font-size:90%;\">, token)</span>\n</td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A2.T6.5.5.2\"><span class=\"ltx_text\" id=\"A2.T6.5.5.2.1\" style=\"font-size:90%;\">42.0</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A2.T6.5.5.3\"><span class=\"ltx_text\" id=\"A2.T6.5.5.3.1\" style=\"font-size:90%;\">39.9</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A2.T6.5.5.4\"><span class=\"ltx_text\" id=\"A2.T6.5.5.4.1\" style=\"font-size:90%;\">52.7</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_bb\" id=\"A2.T6.5.5.5\"><span class=\"ltx_text\" id=\"A2.T6.5.5.5.1\" style=\"font-size:90%;\">9.3</span></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 6: </span>\nAblation of initialization schemes for Prompt Tuning and Prefix Tuning. We show the means of accuracies over 5 seeds with different sets of demonstration pairs per task (except for ARC because it has fixed demonstration pairs).</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"A2.p1\">\n<p class=\"ltx_p\" id=\"A2.p1.1\">In Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a>, we reported Prompt Tuning and Prefix Tuning results using only random-token initialization for their trainable prompts and prefixes. Here, we also follow <cite class=\"ltx_cite ltx_citemacro_citet\">Lester et al., (<a class=\"ltx_ref\" href=\"#bib.bib27\" title=\"\">2021</a>)</cite> in initializing prompts from a uniform distribution, and <cite class=\"ltx_cite ltx_citemacro_citet\">Li and Liang, (<a class=\"ltx_ref\" href=\"#bib.bib29\" title=\"\">2021</a>)</cite> in initializing prefixes either from a uniform distribution or from a seed prefix passed through a two-layer MLP (hidden size 512). Table <a class=\"ltx_ref\" href=\"#A2.T6\" title=\"Table 6 ‣ Appendix B Prompt Tuning and Prefix Tuning with Other Initialization Schemes ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">6</span></a> shows that both Prompt Tuning and Prefix Tuning perform best with random-token initialization, confirming the findings of those works. Therefore, even when compared against these alternative initialization schemes, <span class=\"ltx_text ltx_font_italic\" id=\"A2.p1.1.1\">CT-Prompt</span> and <span class=\"ltx_text ltx_font_italic\" id=\"A2.p1.1.2\">CT-KV</span> continue to deliver superior performance.</p>\n</div>\n</section>\n<section class=\"ltx_appendix\" id=\"A3\">\n<h2 class=\"ltx_title ltx_title_appendix\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix C </span>More Details on Experiment Setup</h2>\n<div class=\"ltx_para\" id=\"A3.p1\">\n<p class=\"ltx_p\" id=\"A3.p1.3\">We detail below our hyperparameter settings for the results reported in Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a> and Table <a class=\"ltx_ref\" href=\"#A2.T6\" title=\"Table 6 ‣ Appendix B Prompt Tuning and Prefix Tuning with Other Initialization Schemes ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">6</span></a>. For TTT, we follow <cite class=\"ltx_cite ltx_citemacro_citet\">Akyürek et al., (<a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite>: using a LoRA learning rate of 1e-4, sampling a random permutation of the <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p1.1.m1.1\"><semantics id=\"A3.p1.1.m1.1a\"><mi id=\"A3.p1.1.m1.1.1\" xref=\"A3.p1.1.m1.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A3.p1.1.m1.1b\"><ci id=\"A3.p1.1.m1.1.1.cmml\" xref=\"A3.p1.1.m1.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p1.1.m1.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p1.1.m1.1d\">italic_k</annotation></semantics></math> demonstration pairs at each training step, and setting the LoRA rank to <math alttext=\"128\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p1.2.m2.1\"><semantics id=\"A3.p1.2.m2.1a\"><mn id=\"A3.p1.2.m2.1.1\" xref=\"A3.p1.2.m2.1.1.cmml\">128</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p1.2.m2.1b\"><cn id=\"A3.p1.2.m2.1.1.cmml\" type=\"integer\" xref=\"A3.p1.2.m2.1.1\">128</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p1.2.m2.1c\">128</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p1.2.m2.1d\">128</annotation></semantics></math> for ARC and <math alttext=\"64\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p1.3.m3.1\"><semantics id=\"A3.p1.3.m3.1a\"><mn id=\"A3.p1.3.m3.1.1\" xref=\"A3.p1.3.m3.1.1.cmml\">64</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p1.3.m3.1b\"><cn id=\"A3.p1.3.m3.1.1.cmml\" type=\"integer\" xref=\"A3.p1.3.m3.1.1\">64</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p1.3.m3.1c\">64</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p1.3.m3.1d\">64</annotation></semantics></math> for all other tasks. In our TTT+<span class=\"ltx_text ltx_font_italic\" id=\"A3.p1.3.1\">CT-KV</span> experiments, we find that using a small number of <span class=\"ltx_text ltx_font_italic\" id=\"A3.p1.3.2\">CT-KV</span> training iterations and lower learning rates further boosts performance on top of a TTT-adapted model.</p>\n</div>\n<div class=\"ltx_para\" id=\"A3.p2\">\n<p class=\"ltx_p\" id=\"A3.p2.6\">For all other experiments, we search over learning rates 3e-4, 1e-3, 3e-3 and Token Dropout rates <math alttext=\"0,0.05,0.1\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p2.1.m1.3\"><semantics id=\"A3.p2.1.m1.3a\"><mrow id=\"A3.p2.1.m1.3.4.2\" xref=\"A3.p2.1.m1.3.4.1.cmml\"><mn id=\"A3.p2.1.m1.1.1\" xref=\"A3.p2.1.m1.1.1.cmml\">0</mn><mo id=\"A3.p2.1.m1.3.4.2.1\" xref=\"A3.p2.1.m1.3.4.1.cmml\">,</mo><mn id=\"A3.p2.1.m1.2.2\" xref=\"A3.p2.1.m1.2.2.cmml\">0.05</mn><mo id=\"A3.p2.1.m1.3.4.2.2\" xref=\"A3.p2.1.m1.3.4.1.cmml\">,</mo><mn id=\"A3.p2.1.m1.3.3\" xref=\"A3.p2.1.m1.3.3.cmml\">0.1</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A3.p2.1.m1.3b\"><list id=\"A3.p2.1.m1.3.4.1.cmml\" xref=\"A3.p2.1.m1.3.4.2\"><cn id=\"A3.p2.1.m1.1.1.cmml\" type=\"integer\" xref=\"A3.p2.1.m1.1.1\">0</cn><cn id=\"A3.p2.1.m1.2.2.cmml\" type=\"float\" xref=\"A3.p2.1.m1.2.2\">0.05</cn><cn id=\"A3.p2.1.m1.3.3.cmml\" type=\"float\" xref=\"A3.p2.1.m1.3.3\">0.1</cn></list></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p2.1.m1.3c\">0,0.05,0.1</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p2.1.m1.3d\">0 , 0.05 , 0.1</annotation></semantics></math>. We search training iterations <math alttext=\"150,200,250,300\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p2.2.m2.4\"><semantics id=\"A3.p2.2.m2.4a\"><mrow id=\"A3.p2.2.m2.4.5.2\" xref=\"A3.p2.2.m2.4.5.1.cmml\"><mn id=\"A3.p2.2.m2.1.1\" xref=\"A3.p2.2.m2.1.1.cmml\">150</mn><mo id=\"A3.p2.2.m2.4.5.2.1\" xref=\"A3.p2.2.m2.4.5.1.cmml\">,</mo><mn id=\"A3.p2.2.m2.2.2\" xref=\"A3.p2.2.m2.2.2.cmml\">200</mn><mo id=\"A3.p2.2.m2.4.5.2.2\" xref=\"A3.p2.2.m2.4.5.1.cmml\">,</mo><mn id=\"A3.p2.2.m2.3.3\" xref=\"A3.p2.2.m2.3.3.cmml\">250</mn><mo id=\"A3.p2.2.m2.4.5.2.3\" xref=\"A3.p2.2.m2.4.5.1.cmml\">,</mo><mn id=\"A3.p2.2.m2.4.4\" xref=\"A3.p2.2.m2.4.4.cmml\">300</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A3.p2.2.m2.4b\"><list id=\"A3.p2.2.m2.4.5.1.cmml\" xref=\"A3.p2.2.m2.4.5.2\"><cn id=\"A3.p2.2.m2.1.1.cmml\" type=\"integer\" xref=\"A3.p2.2.m2.1.1\">150</cn><cn id=\"A3.p2.2.m2.2.2.cmml\" type=\"integer\" xref=\"A3.p2.2.m2.2.2\">200</cn><cn id=\"A3.p2.2.m2.3.3.cmml\" type=\"integer\" xref=\"A3.p2.2.m2.3.3\">250</cn><cn id=\"A3.p2.2.m2.4.4.cmml\" type=\"integer\" xref=\"A3.p2.2.m2.4.4\">300</cn></list></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p2.2.m2.4c\">150,200,250,300</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p2.2.m2.4d\">150 , 200 , 250 , 300</annotation></semantics></math> for NLP-LR and ARC experiments, <math alttext=\"15,20,25,30\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p2.3.m3.4\"><semantics id=\"A3.p2.3.m3.4a\"><mrow id=\"A3.p2.3.m3.4.5.2\" xref=\"A3.p2.3.m3.4.5.1.cmml\"><mn id=\"A3.p2.3.m3.1.1\" xref=\"A3.p2.3.m3.1.1.cmml\">15</mn><mo id=\"A3.p2.3.m3.4.5.2.1\" xref=\"A3.p2.3.m3.4.5.1.cmml\">,</mo><mn id=\"A3.p2.3.m3.2.2\" xref=\"A3.p2.3.m3.2.2.cmml\">20</mn><mo id=\"A3.p2.3.m3.4.5.2.2\" xref=\"A3.p2.3.m3.4.5.1.cmml\">,</mo><mn id=\"A3.p2.3.m3.3.3\" xref=\"A3.p2.3.m3.3.3.cmml\">25</mn><mo id=\"A3.p2.3.m3.4.5.2.3\" xref=\"A3.p2.3.m3.4.5.1.cmml\">,</mo><mn id=\"A3.p2.3.m3.4.4\" xref=\"A3.p2.3.m3.4.4.cmml\">30</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A3.p2.3.m3.4b\"><list id=\"A3.p2.3.m3.4.5.1.cmml\" xref=\"A3.p2.3.m3.4.5.2\"><cn id=\"A3.p2.3.m3.1.1.cmml\" type=\"integer\" xref=\"A3.p2.3.m3.1.1\">15</cn><cn id=\"A3.p2.3.m3.2.2.cmml\" type=\"integer\" xref=\"A3.p2.3.m3.2.2\">20</cn><cn id=\"A3.p2.3.m3.3.3.cmml\" type=\"integer\" xref=\"A3.p2.3.m3.3.3\">25</cn><cn id=\"A3.p2.3.m3.4.4.cmml\" type=\"integer\" xref=\"A3.p2.3.m3.4.4\">30</cn></list></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p2.3.m3.4c\">15,20,25,30</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p2.3.m3.4d\">15 , 20 , 25 , 30</annotation></semantics></math> for MMLU experiments, and <math alttext=\"12,16,20,24\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p2.4.m4.4\"><semantics id=\"A3.p2.4.m4.4a\"><mrow id=\"A3.p2.4.m4.4.5.2\" xref=\"A3.p2.4.m4.4.5.1.cmml\"><mn id=\"A3.p2.4.m4.1.1\" xref=\"A3.p2.4.m4.1.1.cmml\">12</mn><mo id=\"A3.p2.4.m4.4.5.2.1\" xref=\"A3.p2.4.m4.4.5.1.cmml\">,</mo><mn id=\"A3.p2.4.m4.2.2\" xref=\"A3.p2.4.m4.2.2.cmml\">16</mn><mo id=\"A3.p2.4.m4.4.5.2.2\" xref=\"A3.p2.4.m4.4.5.1.cmml\">,</mo><mn id=\"A3.p2.4.m4.3.3\" xref=\"A3.p2.4.m4.3.3.cmml\">20</mn><mo id=\"A3.p2.4.m4.4.5.2.3\" xref=\"A3.p2.4.m4.4.5.1.cmml\">,</mo><mn id=\"A3.p2.4.m4.4.4\" xref=\"A3.p2.4.m4.4.4.cmml\">24</mn></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A3.p2.4.m4.4b\"><list id=\"A3.p2.4.m4.4.5.1.cmml\" xref=\"A3.p2.4.m4.4.5.2\"><cn id=\"A3.p2.4.m4.1.1.cmml\" type=\"integer\" xref=\"A3.p2.4.m4.1.1\">12</cn><cn id=\"A3.p2.4.m4.2.2.cmml\" type=\"integer\" xref=\"A3.p2.4.m4.2.2\">16</cn><cn id=\"A3.p2.4.m4.3.3.cmml\" type=\"integer\" xref=\"A3.p2.4.m4.3.3\">20</cn><cn id=\"A3.p2.4.m4.4.4.cmml\" type=\"integer\" xref=\"A3.p2.4.m4.4.4\">24</cn></list></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p2.4.m4.4c\">12,16,20,24</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p2.4.m4.4d\">12 , 16 , 20 , 24</annotation></semantics></math> for BBH experiments. Table <a class=\"ltx_ref\" href=\"#A3.T7\" title=\"Table 7 ‣ Appendix C More Details on Experiment Setup ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">7</span></a> shows our hyperparameter choices. For fair comparison, hyperparameter sweeps are performed for all methods. For <span class=\"ltx_text ltx_font_italic\" id=\"A3.p2.6.1\">CT-Prompt</span>, <span class=\"ltx_text ltx_font_italic\" id=\"A3.p2.6.2\">CT-KV</span>, and TTT+<span class=\"ltx_text ltx_font_italic\" id=\"A3.p2.6.3\">CT-KV</span>, we use Token Dropout rates of <math alttext=\"0.05\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p2.5.m5.1\"><semantics id=\"A3.p2.5.m5.1a\"><mn id=\"A3.p2.5.m5.1.1\" xref=\"A3.p2.5.m5.1.1.cmml\">0.05</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p2.5.m5.1b\"><cn id=\"A3.p2.5.m5.1.1.cmml\" type=\"float\" xref=\"A3.p2.5.m5.1.1\">0.05</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p2.5.m5.1c\">0.05</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p2.5.m5.1d\">0.05</annotation></semantics></math> for NLP-LR and <math alttext=\"0.1\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p2.6.m6.1\"><semantics id=\"A3.p2.6.m6.1a\"><mn id=\"A3.p2.6.m6.1.1\" xref=\"A3.p2.6.m6.1.1.cmml\">0.1</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p2.6.m6.1b\"><cn id=\"A3.p2.6.m6.1.1.cmml\" type=\"float\" xref=\"A3.p2.6.m6.1.1\">0.1</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p2.6.m6.1c\">0.1</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p2.6.m6.1d\">0.1</annotation></semantics></math> for MMLU, BBH, and ARC.</p>\n</div>\n<div class=\"ltx_para\" id=\"A3.p3\">\n<p class=\"ltx_p\" id=\"A3.p3.1\">Experiments for NLP-LR are performed on a single RTX8000, while all other experiments are conducted on a single A100. All experiments use the Adam optimizer, a cosine learning rate scheduler with no warm-up, bfloat16 precision, and up to 32GB of CPU RAM.</p>\n</div>\n<div class=\"ltx_para\" id=\"A3.p4\">\n<p class=\"ltx_p\" id=\"A3.p4.8\">To fairly compare efficiency, we train each method with the largest batch size possible for the GPU used in its experiment. Since TTT, Prompt Tuning (m = # demo), and <span class=\"ltx_text ltx_font_italic\" id=\"A3.p4.8.1\">CT-Prompt</span> use more memory than other methods due to computing larger <math alttext=\"QK^{T}\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.1.m1.1\"><semantics id=\"A3.p4.1.m1.1a\"><mrow id=\"A3.p4.1.m1.1.1\" xref=\"A3.p4.1.m1.1.1.cmml\"><mi id=\"A3.p4.1.m1.1.1.2\" xref=\"A3.p4.1.m1.1.1.2.cmml\">Q</mi><mo id=\"A3.p4.1.m1.1.1.1\" xref=\"A3.p4.1.m1.1.1.1.cmml\">⁢</mo><msup id=\"A3.p4.1.m1.1.1.3\" xref=\"A3.p4.1.m1.1.1.3.cmml\"><mi id=\"A3.p4.1.m1.1.1.3.2\" xref=\"A3.p4.1.m1.1.1.3.2.cmml\">K</mi><mi id=\"A3.p4.1.m1.1.1.3.3\" xref=\"A3.p4.1.m1.1.1.3.3.cmml\">T</mi></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.1.m1.1b\"><apply id=\"A3.p4.1.m1.1.1.cmml\" xref=\"A3.p4.1.m1.1.1\"><times id=\"A3.p4.1.m1.1.1.1.cmml\" xref=\"A3.p4.1.m1.1.1.1\"></times><ci id=\"A3.p4.1.m1.1.1.2.cmml\" xref=\"A3.p4.1.m1.1.1.2\">𝑄</ci><apply id=\"A3.p4.1.m1.1.1.3.cmml\" xref=\"A3.p4.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A3.p4.1.m1.1.1.3.1.cmml\" xref=\"A3.p4.1.m1.1.1.3\">superscript</csymbol><ci id=\"A3.p4.1.m1.1.1.3.2.cmml\" xref=\"A3.p4.1.m1.1.1.3.2\">𝐾</ci><ci id=\"A3.p4.1.m1.1.1.3.3.cmml\" xref=\"A3.p4.1.m1.1.1.3.3\">𝑇</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.1.m1.1c\">QK^{T}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.1.m1.1d\">italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> matrices (as shown in our derivation in Section <a class=\"ltx_ref\" href=\"#A1\" title=\"Appendix A Time Complexity ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">A</span></a>), we limit their batch sizes to <math alttext=\"4\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.2.m2.1\"><semantics id=\"A3.p4.2.m2.1a\"><mn id=\"A3.p4.2.m2.1.1\" xref=\"A3.p4.2.m2.1.1.cmml\">4</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.2.m2.1b\"><cn id=\"A3.p4.2.m2.1.1.cmml\" type=\"integer\" xref=\"A3.p4.2.m2.1.1\">4</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.2.m2.1c\">4</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.2.m2.1d\">4</annotation></semantics></math> for NLP-LR, MMLU, and ARC, and <math alttext=\"5\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.3.m3.1\"><semantics id=\"A3.p4.3.m3.1a\"><mn id=\"A3.p4.3.m3.1.1\" xref=\"A3.p4.3.m3.1.1.cmml\">5</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.3.m3.1b\"><cn id=\"A3.p4.3.m3.1.1.cmml\" type=\"integer\" xref=\"A3.p4.3.m3.1.1\">5</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.3.m3.1c\">5</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.3.m3.1d\">5</annotation></semantics></math> for BBH. MMLU and BBH models use gradient checkpointing. For all other methods, we use batch size <math alttext=\"16\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.4.m4.1\"><semantics id=\"A3.p4.4.m4.1a\"><mn id=\"A3.p4.4.m4.1.1\" xref=\"A3.p4.4.m4.1.1.cmml\">16</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.4.m4.1b\"><cn id=\"A3.p4.4.m4.1.1.cmml\" type=\"integer\" xref=\"A3.p4.4.m4.1.1\">16</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.4.m4.1c\">16</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.4.m4.1d\">16</annotation></semantics></math> for NLP-LR, <math alttext=\"8\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.5.m5.1\"><semantics id=\"A3.p4.5.m5.1a\"><mn id=\"A3.p4.5.m5.1.1\" xref=\"A3.p4.5.m5.1.1.cmml\">8</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.5.m5.1b\"><cn id=\"A3.p4.5.m5.1.1.cmml\" type=\"integer\" xref=\"A3.p4.5.m5.1.1\">8</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.5.m5.1c\">8</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.5.m5.1d\">8</annotation></semantics></math> for MMLU with gradient accumulation of <math alttext=\"2\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.6.m6.1\"><semantics id=\"A3.p4.6.m6.1a\"><mn id=\"A3.p4.6.m6.1.1\" xref=\"A3.p4.6.m6.1.1.cmml\">2</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.6.m6.1b\"><cn id=\"A3.p4.6.m6.1.1.cmml\" type=\"integer\" xref=\"A3.p4.6.m6.1.1\">2</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.6.m6.1c\">2</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.6.m6.1d\">2</annotation></semantics></math>, <math alttext=\"2\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.7.m7.1\"><semantics id=\"A3.p4.7.m7.1a\"><mn id=\"A3.p4.7.m7.1.1\" xref=\"A3.p4.7.m7.1.1.cmml\">2</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.7.m7.1b\"><cn id=\"A3.p4.7.m7.1.1.cmml\" type=\"integer\" xref=\"A3.p4.7.m7.1.1\">2</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.7.m7.1c\">2</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.7.m7.1d\">2</annotation></semantics></math> for BBH with gradient accumulation of <math alttext=\"5\" class=\"ltx_Math\" display=\"inline\" id=\"A3.p4.8.m8.1\"><semantics id=\"A3.p4.8.m8.1a\"><mn id=\"A3.p4.8.m8.1.1\" xref=\"A3.p4.8.m8.1.1.cmml\">5</mn><annotation-xml encoding=\"MathML-Content\" id=\"A3.p4.8.m8.1b\"><cn id=\"A3.p4.8.m8.1.1.cmml\" type=\"integer\" xref=\"A3.p4.8.m8.1.1\">5</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A3.p4.8.m8.1c\">5</annotation><annotation encoding=\"application/x-llamapun\" id=\"A3.p4.8.m8.1d\">5</annotation></semantics></math>, and full batch for ARC (depending on each task’s number of demonstration pairs). All models, unless noted, do not require gradient checkpointing.</p>\n</div>\n<figure class=\"ltx_table\" id=\"A3.T7\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"A3.T7.1\">\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"A3.T7.1.1.1\">\n<td class=\"ltx_td ltx_border_tt\" id=\"A3.T7.1.1.1.1\"></td>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" colspan=\"2\" id=\"A3.T7.1.1.1.2\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.1.1.2.1\" style=\"font-size:90%;\">NLP-LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" colspan=\"2\" id=\"A3.T7.1.1.1.3\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.1.1.3.1\" style=\"font-size:90%;\">MMLU</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" colspan=\"2\" id=\"A3.T7.1.1.1.4\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.1.1.4.1\" style=\"font-size:90%;\">BBH</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" colspan=\"2\" id=\"A3.T7.1.1.1.5\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.1.1.5.1\" style=\"font-size:90%;\">ARC</span></th>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.2.2\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_column\" id=\"A3.T7.1.2.2.1\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.1.1\" style=\"font-size:90%;\">Method</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.2\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.2.1\" style=\"font-size:90%;\">LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.3\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.3.1\" style=\"font-size:90%;\"># iters</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.4\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.4.1\" style=\"font-size:90%;\">LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.5\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.5.1\" style=\"font-size:90%;\"># iters</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.6\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.6.1\" style=\"font-size:90%;\">LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.7\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.7.1\" style=\"font-size:90%;\"># iters</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.8\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.8.1\" style=\"font-size:90%;\">LR</span></th>\n<th class=\"ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t\" id=\"A3.T7.1.2.2.9\"><span class=\"ltx_text ltx_font_bold\" id=\"A3.T7.1.2.2.9.1\" style=\"font-size:90%;\"># iters</span></th>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.3.3\">\n<td class=\"ltx_td ltx_align_left ltx_border_t\" id=\"A3.T7.1.3.3.1\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.1.1\" style=\"font-size:90%;\">Prompt Tuning (m = 32, uniform)</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.2\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.2.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.3\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.3.1\" style=\"font-size:90%;\">200</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.4\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.4.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.5\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.5.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.6\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.6.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.7\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.7.1\" style=\"font-size:90%;\">20</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.8\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.8.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_t\" id=\"A3.T7.1.3.3.9\"><span class=\"ltx_text\" id=\"A3.T7.1.3.3.9.1\" style=\"font-size:90%;\">250</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.4.4\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.4.4.1\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.1.1\" style=\"font-size:90%;\">Prompt Tuning (m = 32, token)</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.4.4.2\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.2.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.4.4.3\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.3.1\" style=\"font-size:90%;\">200</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.4.4.4\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.4.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.4.4.5\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.5.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.4.4.6\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.6.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.4.4.7\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.7.1\" style=\"font-size:90%;\">16</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.4.4.8\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.8.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.4.4.9\"><span class=\"ltx_text\" id=\"A3.T7.1.4.4.9.1\" style=\"font-size:90%;\">200</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.5.5\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.5.5.1\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.1.1\" style=\"font-size:90%;\">Prompt Tuning (m = # demo, token)</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.5.5.2\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.2.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.5.5.3\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.3.1\" style=\"font-size:90%;\">250</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.5.5.4\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.4.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.5.5.5\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.5.1\" style=\"font-size:90%;\">20</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.5.5.6\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.6.1\" style=\"font-size:90%;\">3e-4</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.5.5.7\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.7.1\" style=\"font-size:90%;\">16</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.5.5.8\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.8.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.5.5.9\"><span class=\"ltx_text\" id=\"A3.T7.1.5.5.9.1\" style=\"font-size:90%;\">200</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.6.6\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.6.6.1\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.1.1\" style=\"font-size:90%;\">Prefix Tuning (m = 32, uniform)</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.6.6.2\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.2.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.6.6.3\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.3.1\" style=\"font-size:90%;\">250</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.6.6.4\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.4.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.6.6.5\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.5.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.6.6.6\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.6.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.6.6.7\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.7.1\" style=\"font-size:90%;\">20</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.6.6.8\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.8.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.6.6.9\"><span class=\"ltx_text\" id=\"A3.T7.1.6.6.9.1\" style=\"font-size:90%;\">250</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.7.7\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.7.7.1\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.1.1\" style=\"font-size:90%;\">Prefix Tuning (m = 32, MLP)</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.7.7.2\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.2.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.7.7.3\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.3.1\" style=\"font-size:90%;\">250</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.7.7.4\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.4.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.7.7.5\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.5.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.7.7.6\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.6.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.7.7.7\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.7.1\" style=\"font-size:90%;\">20</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.7.7.8\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.8.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.7.7.9\"><span class=\"ltx_text\" id=\"A3.T7.1.7.7.9.1\" style=\"font-size:90%;\">200</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.8.8\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.8.8.1\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.1.1\" style=\"font-size:90%;\">Prefix Tuning (m = 32, token)</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.8.8.2\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.2.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.8.8.3\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.3.1\" style=\"font-size:90%;\">250</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.8.8.4\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.4.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.8.8.5\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.5.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.8.8.6\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.6.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.8.8.7\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.7.1\" style=\"font-size:90%;\">16</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.8.8.8\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.8.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.8.8.9\"><span class=\"ltx_text\" id=\"A3.T7.1.8.8.9.1\" style=\"font-size:90%;\">200</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.9.9\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.9.9.1\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.1.1\" style=\"font-size:90%;\">Prefix Tuning (m = # demo, token)</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.9.9.2\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.2.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.9.9.3\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.3.1\" style=\"font-size:90%;\">250</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.9.9.4\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.4.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.9.9.5\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.5.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.9.9.6\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.6.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.9.9.7\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.7.1\" style=\"font-size:90%;\">16</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.9.9.8\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.8.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.9.9.9\"><span class=\"ltx_text\" id=\"A3.T7.1.9.9.9.1\" style=\"font-size:90%;\">200</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.10.10\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.10.10.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A3.T7.1.10.10.1.1\" style=\"font-size:90%;\">CT-Prompt</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.10.10.2\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.2.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.10.10.3\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.3.1\" style=\"font-size:90%;\">250</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.10.10.4\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.4.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.10.10.5\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.5.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.10.10.6\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.6.1\" style=\"font-size:90%;\">3e-4</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.10.10.7\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.7.1\" style=\"font-size:90%;\">12</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.10.10.8\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.8.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.10.10.9\"><span class=\"ltx_text\" id=\"A3.T7.1.10.10.9.1\" style=\"font-size:90%;\">250</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.11.11\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.11.11.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A3.T7.1.11.11.1.1\" style=\"font-size:90%;\">CT-KV</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.11.11.2\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.2.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.11.11.3\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.3.1\" style=\"font-size:90%;\">200</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.11.11.4\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.4.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.11.11.5\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.5.1\" style=\"font-size:90%;\">20</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.11.11.6\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.6.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.11.11.7\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.7.1\" style=\"font-size:90%;\">16</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.11.11.8\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.8.1\" style=\"font-size:90%;\">3e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.11.11.9\"><span class=\"ltx_text\" id=\"A3.T7.1.11.11.9.1\" style=\"font-size:90%;\">200</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.12.12\">\n<td class=\"ltx_td ltx_align_left\" id=\"A3.T7.1.12.12.1\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.1.1\" style=\"font-size:90%;\">TTT</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.12.12.2\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.2.1\" style=\"font-size:90%;\">1e-4</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.12.12.3\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.3.1\" style=\"font-size:90%;\">250</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.12.12.4\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.4.1\" style=\"font-size:90%;\">1e-4</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.12.12.5\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.5.1\" style=\"font-size:90%;\">20</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.12.12.6\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.6.1\" style=\"font-size:90%;\">1e-4</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.12.12.7\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.7.1\" style=\"font-size:90%;\">8</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A3.T7.1.12.12.8\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.8.1\" style=\"font-size:90%;\">1e-4</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A3.T7.1.12.12.9\"><span class=\"ltx_text\" id=\"A3.T7.1.12.12.9.1\" style=\"font-size:90%;\">200</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A3.T7.1.13.13\">\n<td class=\"ltx_td ltx_align_left ltx_border_bb\" id=\"A3.T7.1.13.13.1\">\n<span class=\"ltx_text\" id=\"A3.T7.1.13.13.1.1\" style=\"font-size:90%;\">TTT+</span><span class=\"ltx_text ltx_font_italic\" id=\"A3.T7.1.13.13.1.2\" style=\"font-size:90%;\">CT-KV</span>\n</td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.2\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.2.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.3\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.3.1\" style=\"font-size:90%;\">25</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.4\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.4.1\" style=\"font-size:90%;\">1e-4</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.5\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.5.1\" style=\"font-size:90%;\">5</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.6\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.6.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.7\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.7.1\" style=\"font-size:90%;\">8</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.8\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.8.1\" style=\"font-size:90%;\">1e-3</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_bb\" id=\"A3.T7.1.13.13.9\"><span class=\"ltx_text\" id=\"A3.T7.1.13.13.9.1\" style=\"font-size:90%;\">25</span></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 7: </span>\nLearning rates (LR) and number of training iterations (# iters) used for each method and benchmark.\n</figcaption>\n</figure>\n</section>\n<section class=\"ltx_appendix\" id=\"A4\">\n<h2 class=\"ltx_title ltx_title_appendix\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix D </span>Parameter-Efficient Variants of CT-KV</h2>\n<div class=\"ltx_para\" id=\"A4.p1\">\n<p class=\"ltx_p\" id=\"A4.p1.1\">In this section, we explore two variants of <span class=\"ltx_text ltx_font_italic\" id=\"A4.p1.1.1\">CT-KV</span> that reduce the number of trainable prefix parameters. We use the notations from Section <a class=\"ltx_ref\" href=\"#S4\" title=\"4 Context Tuning for In-Context Optimization ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">4</span></a>.</p>\n</div>\n<section class=\"ltx_paragraph\" id=\"A4.SS0.SSS0.Px1\">\n<h4 class=\"ltx_title ltx_title_paragraph\">CT-V</h4>\n<div class=\"ltx_para\" id=\"A4.SS0.SSS0.Px1.p1\">\n<p class=\"ltx_p\" id=\"A4.SS0.SSS0.Px1.p1.6\">We partition the trainable prefix <math alttext=\"\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.1.m1.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.1.m1.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml\">CT</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.1.m1.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.1.m1.1.1.3\">CT</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.1.m1.1c\">\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.1.m1.1d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> into its key and value components, <math alttext=\"\\Theta_{K}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.2.m2.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.2.m2.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml\">K</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.2.m2.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.2.m2.1.1.3\">𝐾</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.2.m2.1c\">\\Theta_{K}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.2.m2.1d\">roman_Θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext=\"\\Theta_{V}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.3.m3.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.3.m3.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml\">V</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.3.m3.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.3.m3.1.1.3\">𝑉</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.3.m3.1c\">\\Theta_{V}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.3.m3.1d\">roman_Θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>. Inspired by <cite class=\"ltx_cite ltx_citemacro_citet\">Kirkpatrick et al., (<a class=\"ltx_ref\" href=\"#bib.bib26\" title=\"\">2017</a>)</cite>, we estimate the importance of each trainable parameter <math alttext=\"\\Theta_{j}\\in\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.4.m4.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.4.m4.1a\"><mrow id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.cmml\"><msub id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.3\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.3.cmml\">j</mi></msub><mo id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml\">∈</mo><msub id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.3\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml\">CT</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.4.m4.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1\"><in id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.1\"></in><apply id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.2.3\">𝑗</ci></apply><apply id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.4.m4.1.1.3.3\">CT</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.4.m4.1c\">\\Theta_{j}\\in\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.4.m4.1d\">roman_Θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> by computing its diagonal Fisher term over the <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.5.m5.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.5.m5.1a\"><mi id=\"A4.SS0.SSS0.Px1.p1.5.m5.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.5.m5.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.5.m5.1b\"><ci id=\"A4.SS0.SSS0.Px1.p1.5.m5.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.5.m5.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.5.m5.1c\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.5.m5.1d\">italic_k</annotation></semantics></math> demonstrations in <math alttext=\"\\mathcal{D}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.6.m6.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.6.m6.1a\"><mi class=\"ltx_font_mathcaligraphic\" id=\"A4.SS0.SSS0.Px1.p1.6.m6.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.6.m6.1.1.cmml\">𝒟</mi><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.6.m6.1b\"><ci id=\"A4.SS0.SSS0.Px1.p1.6.m6.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.6.m6.1.1\">𝒟</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.6.m6.1c\">\\mathcal{D}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.6.m6.1d\">caligraphic_D</annotation></semantics></math>:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"A4.Ex16\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\hat{F}_{j}=\\frac{1}{k}\\sum_{i=1}^{k}\\left(\\nabla_{\\Theta_{j}}\\log p_{\\phi}(y_%\n{i}\\bigm{|}\\Theta_{\\mathrm{CT}},x_{i})\\right)^{2}.\" class=\"ltx_math_unparsed\" display=\"block\" id=\"A4.Ex16.m1.1\"><semantics id=\"A4.Ex16.m1.1a\"><mrow id=\"A4.Ex16.m1.1b\"><msub id=\"A4.Ex16.m1.1.1\"><mover accent=\"true\" id=\"A4.Ex16.m1.1.1.2\"><mi id=\"A4.Ex16.m1.1.1.2.2\">F</mi><mo id=\"A4.Ex16.m1.1.1.2.1\">^</mo></mover><mi id=\"A4.Ex16.m1.1.1.3\">j</mi></msub><mo id=\"A4.Ex16.m1.1.2\">=</mo><mfrac id=\"A4.Ex16.m1.1.3\"><mn id=\"A4.Ex16.m1.1.3.2\">1</mn><mi id=\"A4.Ex16.m1.1.3.3\">k</mi></mfrac><munderover id=\"A4.Ex16.m1.1.4\"><mo id=\"A4.Ex16.m1.1.4.2.2\" movablelimits=\"false\" rspace=\"0em\">∑</mo><mrow id=\"A4.Ex16.m1.1.4.2.3\"><mi id=\"A4.Ex16.m1.1.4.2.3.2\">i</mi><mo id=\"A4.Ex16.m1.1.4.2.3.1\">=</mo><mn id=\"A4.Ex16.m1.1.4.2.3.3\">1</mn></mrow><mi id=\"A4.Ex16.m1.1.4.3\">k</mi></munderover><msup id=\"A4.Ex16.m1.1.5\"><mrow id=\"A4.Ex16.m1.1.5.2\"><mo id=\"A4.Ex16.m1.1.5.2.1\">(</mo><msub id=\"A4.Ex16.m1.1.5.2.2\"><mo id=\"A4.Ex16.m1.1.5.2.2.2\" rspace=\"0.167em\">∇</mo><msub id=\"A4.Ex16.m1.1.5.2.2.3\"><mi id=\"A4.Ex16.m1.1.5.2.2.3.2\" mathvariant=\"normal\">Θ</mi><mi id=\"A4.Ex16.m1.1.5.2.2.3.3\">j</mi></msub></msub><mi id=\"A4.Ex16.m1.1.5.2.3\">log</mi><msub id=\"A4.Ex16.m1.1.5.2.4\"><mi id=\"A4.Ex16.m1.1.5.2.4.2\">p</mi><mi id=\"A4.Ex16.m1.1.5.2.4.3\">ϕ</mi></msub><mrow id=\"A4.Ex16.m1.1.5.2.5\"><mo id=\"A4.Ex16.m1.1.5.2.5.1\" stretchy=\"false\">(</mo><msub id=\"A4.Ex16.m1.1.5.2.5.2\"><mi id=\"A4.Ex16.m1.1.5.2.5.2.2\">y</mi><mi id=\"A4.Ex16.m1.1.5.2.5.2.3\">i</mi></msub><mo id=\"A4.Ex16.m1.1.5.2.5.3\" lspace=\"0em\" mathsize=\"120%\" rspace=\"0em\">|</mo><msub id=\"A4.Ex16.m1.1.5.2.5.4\"><mi id=\"A4.Ex16.m1.1.5.2.5.4.2\" mathvariant=\"normal\">Θ</mi><mi id=\"A4.Ex16.m1.1.5.2.5.4.3\">CT</mi></msub><mo id=\"A4.Ex16.m1.1.5.2.5.5\">,</mo><msub id=\"A4.Ex16.m1.1.5.2.5.6\"><mi id=\"A4.Ex16.m1.1.5.2.5.6.2\">x</mi><mi id=\"A4.Ex16.m1.1.5.2.5.6.3\">i</mi></msub><mo id=\"A4.Ex16.m1.1.5.2.5.7\" stretchy=\"false\">)</mo></mrow><mo id=\"A4.Ex16.m1.1.5.2.6\">)</mo></mrow><mn id=\"A4.Ex16.m1.1.5.3\">2</mn></msup><mo id=\"A4.Ex16.m1.1.6\" lspace=\"0em\">.</mo></mrow><annotation encoding=\"application/x-tex\" id=\"A4.Ex16.m1.1c\">\\hat{F}_{j}=\\frac{1}{k}\\sum_{i=1}^{k}\\left(\\nabla_{\\Theta_{j}}\\log p_{\\phi}(y_%\n{i}\\bigm{|}\\Theta_{\\mathrm{CT}},x_{i})\\right)^{2}.</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.Ex16.m1.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_k end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( ∇ start_POSTSUBSCRIPT roman_Θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"A4.SS0.SSS0.Px1.p1.16\"><math alttext=\"\\hat{F}_{j}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.7.m1.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.7.m1.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.cmml\"><mover accent=\"true\" id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.2\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.2.cmml\">F</mi><mo id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.1\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.1.cmml\">^</mo></mover><mi id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.3.cmml\">j</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.7.m1.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1\">subscript</csymbol><apply id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2\"><ci id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.1\">^</ci><ci id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.2.2\">𝐹</ci></apply><ci id=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.7.m1.1.1.3\">𝑗</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.7.m1.1c\">\\hat{F}_{j}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.7.m1.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> provides a relative estimate of how much a change in each parameter <math alttext=\"\\Theta_{j}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.8.m2.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.8.m2.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.3.cmml\">j</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.8.m2.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.8.m2.1.1.3\">𝑗</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.8.m2.1c\">\\Theta_{j}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.8.m2.1d\">roman_Θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> affects the model’s ability to solve each demonstration pair, representing its importance during training. By averaging <math alttext=\"\\hat{F}_{j}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.9.m3.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.9.m3.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.cmml\"><mover accent=\"true\" id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.2\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.2.cmml\">F</mi><mo id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.1\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.1.cmml\">^</mo></mover><mi id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.3.cmml\">j</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.9.m3.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1\">subscript</csymbol><apply id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2\"><ci id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.1\">^</ci><ci id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.2.2\">𝐹</ci></apply><ci id=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.9.m3.1.1.3\">𝑗</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.9.m3.1c\">\\hat{F}_{j}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.9.m3.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> across parameters in <math alttext=\"\\Theta_{K}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.10.m4.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.10.m4.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.3.cmml\">K</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.10.m4.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.10.m4.1.1.3\">𝐾</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.10.m4.1c\">\\Theta_{K}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.10.m4.1d\">roman_Θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext=\"\\Theta_{V}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.11.m5.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.11.m5.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.3.cmml\">V</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.11.m5.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.11.m5.1.1.3\">𝑉</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.11.m5.1c\">\\Theta_{V}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.11.m5.1d\">roman_Θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, we obtain two scalar estimates, <math alttext=\"\\hat{F}_{K}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.12.m6.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.12.m6.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.cmml\"><mover accent=\"true\" id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.2\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.2.cmml\">F</mi><mo id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.1\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.1.cmml\">^</mo></mover><mi id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.3.cmml\">K</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.12.m6.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1\">subscript</csymbol><apply id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2\"><ci id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.1\">^</ci><ci id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.2.2\">𝐹</ci></apply><ci id=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.12.m6.1.1.3\">𝐾</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.12.m6.1c\">\\hat{F}_{K}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.12.m6.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext=\"\\hat{F}_{V}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.13.m7.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.13.m7.1a\"><msub id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.cmml\"><mover accent=\"true\" id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.2\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.2.cmml\">F</mi><mo id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.1\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.1.cmml\">^</mo></mover><mi id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.3.cmml\">V</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.13.m7.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1\">subscript</csymbol><apply id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2\"><ci id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.1\">^</ci><ci id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.2.2\">𝐹</ci></apply><ci id=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.13.m7.1.1.3\">𝑉</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.13.m7.1c\">\\hat{F}_{V}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.13.m7.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math>, indicating the relative importance of the trainable keys and values, respectively. Based on our findings in Table <a class=\"ltx_ref\" href=\"#A4.T8\" title=\"Table 8 ‣ CT-V ‣ Appendix D Parameter-Efficient Variants of CT-KV ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">8</span></a>, we conclude that <math alttext=\"\\hat{F}_{V}\\gg\\hat{F}_{K}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.14.m8.1a\"><mrow id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.cmml\"><msub id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.cmml\"><mover accent=\"true\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.2\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.2.cmml\">F</mi><mo id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.1\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.1.cmml\">^</mo></mover><mi id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.3\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.3.cmml\">V</mi></msub><mo id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.1.cmml\">≫</mo><msub id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.cmml\"><mover accent=\"true\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.2\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.2.cmml\">F</mi><mo id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.1\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.1.cmml\">^</mo></mover><mi id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.3\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.3.cmml\">K</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1\"><csymbol cd=\"latexml\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.1\">much-greater-than</csymbol><apply id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2\">subscript</csymbol><apply id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2\"><ci id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.1\">^</ci><ci id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.2.2\">𝐹</ci></apply><ci id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.2.3\">𝑉</ci></apply><apply id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3\">subscript</csymbol><apply id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2\"><ci id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.1\">^</ci><ci id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.2.2\">𝐹</ci></apply><ci id=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.14.m8.1.1.3.3\">𝐾</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1c\">\\hat{F}_{V}\\gg\\hat{F}_{K}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.14.m8.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ≫ over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math> for most tasks, suggesting that values play a more significant role. By freezing <math alttext=\"\\Theta_{K}\\subset\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.15.m9.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.15.m9.1a\"><mrow id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.cmml\"><msub id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.3\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.3.cmml\">K</mi></msub><mo id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.1.cmml\">⊂</mo><msub id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.3\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.3.cmml\">CT</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.15.m9.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1\"><subset id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.1\"></subset><apply id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.2.3\">𝐾</ci></apply><apply id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.15.m9.1.1.3.3\">CT</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.15.m9.1c\">\\Theta_{K}\\subset\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.15.m9.1d\">roman_Θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ⊂ roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> and training only <math alttext=\"\\Theta_{V}\\subset\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px1.p1.16.m10.1\"><semantics id=\"A4.SS0.SSS0.Px1.p1.16.m10.1a\"><mrow id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.cmml\"><msub id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.3\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.3.cmml\">V</mi></msub><mo id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.1\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.1.cmml\">⊂</mo><msub id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.cmml\"><mi id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.3\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.3.cmml\">CT</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px1.p1.16.m10.1b\"><apply id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1\"><subset id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.1\"></subset><apply id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.2.3\">𝑉</ci></apply><apply id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.1.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.2.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.3.cmml\" xref=\"A4.SS0.SSS0.Px1.p1.16.m10.1.1.3.3\">CT</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px1.p1.16.m10.1c\">\\Theta_{V}\\subset\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px1.p1.16.m10.1d\">roman_Θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ⊂ roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math>, we arrive at <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px1.p1.16.1\">CT-V</span>, which reduces the number of trainable parameters in <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px1.p1.16.2\">CT-KV</span> by exactly half.</p>\n</div>\n<figure class=\"ltx_table\" id=\"A4.T8\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"A4.T8.10\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"A4.T8.2.2\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt\" id=\"A4.T8.2.2.3\"><span class=\"ltx_text\" id=\"A4.T8.2.2.3.1\" style=\"font-size:90%;\">Dataset</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A4.T8.1.1.1\"><math alttext=\"\\hat{F}_{K}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.1.1.1.m1.1\"><semantics id=\"A4.T8.1.1.1.m1.1a\"><msub id=\"A4.T8.1.1.1.m1.1.1\" xref=\"A4.T8.1.1.1.m1.1.1.cmml\"><mover accent=\"true\" id=\"A4.T8.1.1.1.m1.1.1.2\" xref=\"A4.T8.1.1.1.m1.1.1.2.cmml\"><mi id=\"A4.T8.1.1.1.m1.1.1.2.2\" mathsize=\"90%\" xref=\"A4.T8.1.1.1.m1.1.1.2.2.cmml\">F</mi><mo id=\"A4.T8.1.1.1.m1.1.1.2.1\" mathsize=\"90%\" xref=\"A4.T8.1.1.1.m1.1.1.2.1.cmml\">^</mo></mover><mi id=\"A4.T8.1.1.1.m1.1.1.3\" mathsize=\"90%\" xref=\"A4.T8.1.1.1.m1.1.1.3.cmml\">K</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.1.1.1.m1.1b\"><apply id=\"A4.T8.1.1.1.m1.1.1.cmml\" xref=\"A4.T8.1.1.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.T8.1.1.1.m1.1.1.1.cmml\" xref=\"A4.T8.1.1.1.m1.1.1\">subscript</csymbol><apply id=\"A4.T8.1.1.1.m1.1.1.2.cmml\" xref=\"A4.T8.1.1.1.m1.1.1.2\"><ci id=\"A4.T8.1.1.1.m1.1.1.2.1.cmml\" xref=\"A4.T8.1.1.1.m1.1.1.2.1\">^</ci><ci id=\"A4.T8.1.1.1.m1.1.1.2.2.cmml\" xref=\"A4.T8.1.1.1.m1.1.1.2.2\">𝐹</ci></apply><ci id=\"A4.T8.1.1.1.m1.1.1.3.cmml\" xref=\"A4.T8.1.1.1.m1.1.1.3\">𝐾</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.1.1.1.m1.1c\">\\hat{F}_{K}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.1.1.1.m1.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A4.T8.2.2.2\"><math alttext=\"\\hat{F}_{V}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.2.2.2.m1.1\"><semantics id=\"A4.T8.2.2.2.m1.1a\"><msub id=\"A4.T8.2.2.2.m1.1.1\" xref=\"A4.T8.2.2.2.m1.1.1.cmml\"><mover accent=\"true\" id=\"A4.T8.2.2.2.m1.1.1.2\" xref=\"A4.T8.2.2.2.m1.1.1.2.cmml\"><mi id=\"A4.T8.2.2.2.m1.1.1.2.2\" mathsize=\"90%\" xref=\"A4.T8.2.2.2.m1.1.1.2.2.cmml\">F</mi><mo id=\"A4.T8.2.2.2.m1.1.1.2.1\" mathsize=\"90%\" xref=\"A4.T8.2.2.2.m1.1.1.2.1.cmml\">^</mo></mover><mi id=\"A4.T8.2.2.2.m1.1.1.3\" mathsize=\"90%\" xref=\"A4.T8.2.2.2.m1.1.1.3.cmml\">V</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.2.2.2.m1.1b\"><apply id=\"A4.T8.2.2.2.m1.1.1.cmml\" xref=\"A4.T8.2.2.2.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.T8.2.2.2.m1.1.1.1.cmml\" xref=\"A4.T8.2.2.2.m1.1.1\">subscript</csymbol><apply id=\"A4.T8.2.2.2.m1.1.1.2.cmml\" xref=\"A4.T8.2.2.2.m1.1.1.2\"><ci id=\"A4.T8.2.2.2.m1.1.1.2.1.cmml\" xref=\"A4.T8.2.2.2.m1.1.1.2.1\">^</ci><ci id=\"A4.T8.2.2.2.m1.1.1.2.2.cmml\" xref=\"A4.T8.2.2.2.m1.1.1.2.2\">𝐹</ci></apply><ci id=\"A4.T8.2.2.2.m1.1.1.3.cmml\" xref=\"A4.T8.2.2.2.m1.1.1.3\">𝑉</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.2.2.2.m1.1c\">\\hat{F}_{V}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.2.2.2.m1.1d\">over^ start_ARG italic_F end_ARG start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math></th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"A4.T8.4.4\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" id=\"A4.T8.4.4.3\"><span class=\"ltx_text\" id=\"A4.T8.4.4.3.1\" style=\"font-size:90%;\">ARC</span></th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A4.T8.3.3.1\"><math alttext=\"2.43\\times 10^{-9}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.3.3.1.m1.1\"><semantics id=\"A4.T8.3.3.1.m1.1a\"><mrow id=\"A4.T8.3.3.1.m1.1.1\" xref=\"A4.T8.3.3.1.m1.1.1.cmml\"><mn id=\"A4.T8.3.3.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.3.3.1.m1.1.1.2.cmml\">2.43</mn><mo id=\"A4.T8.3.3.1.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.3.3.1.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.3.3.1.m1.1.1.3\" xref=\"A4.T8.3.3.1.m1.1.1.3.cmml\"><mn id=\"A4.T8.3.3.1.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.3.3.1.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.3.3.1.m1.1.1.3.3\" xref=\"A4.T8.3.3.1.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.3.3.1.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.3.3.1.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.3.3.1.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.3.3.1.m1.1.1.3.3.2.cmml\">9</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.3.3.1.m1.1b\"><apply id=\"A4.T8.3.3.1.m1.1.1.cmml\" xref=\"A4.T8.3.3.1.m1.1.1\"><times id=\"A4.T8.3.3.1.m1.1.1.1.cmml\" xref=\"A4.T8.3.3.1.m1.1.1.1\"></times><cn id=\"A4.T8.3.3.1.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.3.3.1.m1.1.1.2\">2.43</cn><apply id=\"A4.T8.3.3.1.m1.1.1.3.cmml\" xref=\"A4.T8.3.3.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.3.3.1.m1.1.1.3.1.cmml\" xref=\"A4.T8.3.3.1.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.3.3.1.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.3.3.1.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.3.3.1.m1.1.1.3.3.cmml\" xref=\"A4.T8.3.3.1.m1.1.1.3.3\"><minus id=\"A4.T8.3.3.1.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.3.3.1.m1.1.1.3.3\"></minus><cn id=\"A4.T8.3.3.1.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.3.3.1.m1.1.1.3.3.2\">9</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.3.3.1.m1.1c\">2.43\\times 10^{-9}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.3.3.1.m1.1d\">2.43 × 10 start_POSTSUPERSCRIPT - 9 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A4.T8.4.4.2\"><math alttext=\"1.02\\times 10^{-7}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.4.4.2.m1.1\"><semantics id=\"A4.T8.4.4.2.m1.1a\"><mrow id=\"A4.T8.4.4.2.m1.1.1\" xref=\"A4.T8.4.4.2.m1.1.1.cmml\"><mn id=\"A4.T8.4.4.2.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.4.4.2.m1.1.1.2.cmml\">1.02</mn><mo id=\"A4.T8.4.4.2.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.4.4.2.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.4.4.2.m1.1.1.3\" xref=\"A4.T8.4.4.2.m1.1.1.3.cmml\"><mn id=\"A4.T8.4.4.2.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.4.4.2.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.4.4.2.m1.1.1.3.3\" xref=\"A4.T8.4.4.2.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.4.4.2.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.4.4.2.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.4.4.2.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.4.4.2.m1.1.1.3.3.2.cmml\">7</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.4.4.2.m1.1b\"><apply id=\"A4.T8.4.4.2.m1.1.1.cmml\" xref=\"A4.T8.4.4.2.m1.1.1\"><times id=\"A4.T8.4.4.2.m1.1.1.1.cmml\" xref=\"A4.T8.4.4.2.m1.1.1.1\"></times><cn id=\"A4.T8.4.4.2.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.4.4.2.m1.1.1.2\">1.02</cn><apply id=\"A4.T8.4.4.2.m1.1.1.3.cmml\" xref=\"A4.T8.4.4.2.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.4.4.2.m1.1.1.3.1.cmml\" xref=\"A4.T8.4.4.2.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.4.4.2.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.4.4.2.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.4.4.2.m1.1.1.3.3.cmml\" xref=\"A4.T8.4.4.2.m1.1.1.3.3\"><minus id=\"A4.T8.4.4.2.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.4.4.2.m1.1.1.3.3\"></minus><cn id=\"A4.T8.4.4.2.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.4.4.2.m1.1.1.3.3.2\">7</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.4.4.2.m1.1c\">1.02\\times 10^{-7}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.4.4.2.m1.1d\">1.02 × 10 start_POSTSUPERSCRIPT - 7 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A4.T8.6.6\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A4.T8.6.6.3\"><span class=\"ltx_text\" id=\"A4.T8.6.6.3.1\" style=\"font-size:90%;\">BBH</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T8.5.5.1\"><math alttext=\"1.89\\times 10^{-6}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.5.5.1.m1.1\"><semantics id=\"A4.T8.5.5.1.m1.1a\"><mrow id=\"A4.T8.5.5.1.m1.1.1\" xref=\"A4.T8.5.5.1.m1.1.1.cmml\"><mn id=\"A4.T8.5.5.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.5.5.1.m1.1.1.2.cmml\">1.89</mn><mo id=\"A4.T8.5.5.1.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.5.5.1.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.5.5.1.m1.1.1.3\" xref=\"A4.T8.5.5.1.m1.1.1.3.cmml\"><mn id=\"A4.T8.5.5.1.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.5.5.1.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.5.5.1.m1.1.1.3.3\" xref=\"A4.T8.5.5.1.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.5.5.1.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.5.5.1.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.5.5.1.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.5.5.1.m1.1.1.3.3.2.cmml\">6</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.5.5.1.m1.1b\"><apply id=\"A4.T8.5.5.1.m1.1.1.cmml\" xref=\"A4.T8.5.5.1.m1.1.1\"><times id=\"A4.T8.5.5.1.m1.1.1.1.cmml\" xref=\"A4.T8.5.5.1.m1.1.1.1\"></times><cn id=\"A4.T8.5.5.1.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.5.5.1.m1.1.1.2\">1.89</cn><apply id=\"A4.T8.5.5.1.m1.1.1.3.cmml\" xref=\"A4.T8.5.5.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.5.5.1.m1.1.1.3.1.cmml\" xref=\"A4.T8.5.5.1.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.5.5.1.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.5.5.1.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.5.5.1.m1.1.1.3.3.cmml\" xref=\"A4.T8.5.5.1.m1.1.1.3.3\"><minus id=\"A4.T8.5.5.1.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.5.5.1.m1.1.1.3.3\"></minus><cn id=\"A4.T8.5.5.1.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.5.5.1.m1.1.1.3.3.2\">6</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.5.5.1.m1.1c\">1.89\\times 10^{-6}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.5.5.1.m1.1d\">1.89 × 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T8.6.6.2\"><math alttext=\"3.99\\times 10^{-4}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.6.6.2.m1.1\"><semantics id=\"A4.T8.6.6.2.m1.1a\"><mrow id=\"A4.T8.6.6.2.m1.1.1\" xref=\"A4.T8.6.6.2.m1.1.1.cmml\"><mn id=\"A4.T8.6.6.2.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.6.6.2.m1.1.1.2.cmml\">3.99</mn><mo id=\"A4.T8.6.6.2.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.6.6.2.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.6.6.2.m1.1.1.3\" xref=\"A4.T8.6.6.2.m1.1.1.3.cmml\"><mn id=\"A4.T8.6.6.2.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.6.6.2.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.6.6.2.m1.1.1.3.3\" xref=\"A4.T8.6.6.2.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.6.6.2.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.6.6.2.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.6.6.2.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.6.6.2.m1.1.1.3.3.2.cmml\">4</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.6.6.2.m1.1b\"><apply id=\"A4.T8.6.6.2.m1.1.1.cmml\" xref=\"A4.T8.6.6.2.m1.1.1\"><times id=\"A4.T8.6.6.2.m1.1.1.1.cmml\" xref=\"A4.T8.6.6.2.m1.1.1.1\"></times><cn id=\"A4.T8.6.6.2.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.6.6.2.m1.1.1.2\">3.99</cn><apply id=\"A4.T8.6.6.2.m1.1.1.3.cmml\" xref=\"A4.T8.6.6.2.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.6.6.2.m1.1.1.3.1.cmml\" xref=\"A4.T8.6.6.2.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.6.6.2.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.6.6.2.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.6.6.2.m1.1.1.3.3.cmml\" xref=\"A4.T8.6.6.2.m1.1.1.3.3\"><minus id=\"A4.T8.6.6.2.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.6.6.2.m1.1.1.3.3\"></minus><cn id=\"A4.T8.6.6.2.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.6.6.2.m1.1.1.3.3.2\">4</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.6.6.2.m1.1c\">3.99\\times 10^{-4}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.6.6.2.m1.1d\">3.99 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A4.T8.8.8\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A4.T8.8.8.3\"><span class=\"ltx_text\" id=\"A4.T8.8.8.3.1\" style=\"font-size:90%;\">NLP-LR</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T8.7.7.1\"><math alttext=\"1.44\\times 10^{-8}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.7.7.1.m1.1\"><semantics id=\"A4.T8.7.7.1.m1.1a\"><mrow id=\"A4.T8.7.7.1.m1.1.1\" xref=\"A4.T8.7.7.1.m1.1.1.cmml\"><mn id=\"A4.T8.7.7.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.7.7.1.m1.1.1.2.cmml\">1.44</mn><mo id=\"A4.T8.7.7.1.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.7.7.1.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.7.7.1.m1.1.1.3\" xref=\"A4.T8.7.7.1.m1.1.1.3.cmml\"><mn id=\"A4.T8.7.7.1.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.7.7.1.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.7.7.1.m1.1.1.3.3\" xref=\"A4.T8.7.7.1.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.7.7.1.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.7.7.1.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.7.7.1.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.7.7.1.m1.1.1.3.3.2.cmml\">8</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.7.7.1.m1.1b\"><apply id=\"A4.T8.7.7.1.m1.1.1.cmml\" xref=\"A4.T8.7.7.1.m1.1.1\"><times id=\"A4.T8.7.7.1.m1.1.1.1.cmml\" xref=\"A4.T8.7.7.1.m1.1.1.1\"></times><cn id=\"A4.T8.7.7.1.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.7.7.1.m1.1.1.2\">1.44</cn><apply id=\"A4.T8.7.7.1.m1.1.1.3.cmml\" xref=\"A4.T8.7.7.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.7.7.1.m1.1.1.3.1.cmml\" xref=\"A4.T8.7.7.1.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.7.7.1.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.7.7.1.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.7.7.1.m1.1.1.3.3.cmml\" xref=\"A4.T8.7.7.1.m1.1.1.3.3\"><minus id=\"A4.T8.7.7.1.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.7.7.1.m1.1.1.3.3\"></minus><cn id=\"A4.T8.7.7.1.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.7.7.1.m1.1.1.3.3.2\">8</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.7.7.1.m1.1c\">1.44\\times 10^{-8}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.7.7.1.m1.1d\">1.44 × 10 start_POSTSUPERSCRIPT - 8 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T8.8.8.2\"><math alttext=\"8.32\\times 10^{-8}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.8.8.2.m1.1\"><semantics id=\"A4.T8.8.8.2.m1.1a\"><mrow id=\"A4.T8.8.8.2.m1.1.1\" xref=\"A4.T8.8.8.2.m1.1.1.cmml\"><mn id=\"A4.T8.8.8.2.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.8.8.2.m1.1.1.2.cmml\">8.32</mn><mo id=\"A4.T8.8.8.2.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.8.8.2.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.8.8.2.m1.1.1.3\" xref=\"A4.T8.8.8.2.m1.1.1.3.cmml\"><mn id=\"A4.T8.8.8.2.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.8.8.2.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.8.8.2.m1.1.1.3.3\" xref=\"A4.T8.8.8.2.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.8.8.2.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.8.8.2.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.8.8.2.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.8.8.2.m1.1.1.3.3.2.cmml\">8</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.8.8.2.m1.1b\"><apply id=\"A4.T8.8.8.2.m1.1.1.cmml\" xref=\"A4.T8.8.8.2.m1.1.1\"><times id=\"A4.T8.8.8.2.m1.1.1.1.cmml\" xref=\"A4.T8.8.8.2.m1.1.1.1\"></times><cn id=\"A4.T8.8.8.2.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.8.8.2.m1.1.1.2\">8.32</cn><apply id=\"A4.T8.8.8.2.m1.1.1.3.cmml\" xref=\"A4.T8.8.8.2.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.8.8.2.m1.1.1.3.1.cmml\" xref=\"A4.T8.8.8.2.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.8.8.2.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.8.8.2.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.8.8.2.m1.1.1.3.3.cmml\" xref=\"A4.T8.8.8.2.m1.1.1.3.3\"><minus id=\"A4.T8.8.8.2.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.8.8.2.m1.1.1.3.3\"></minus><cn id=\"A4.T8.8.8.2.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.8.8.2.m1.1.1.3.3.2\">8</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.8.8.2.m1.1c\">8.32\\times 10^{-8}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.8.8.2.m1.1d\">8.32 × 10 start_POSTSUPERSCRIPT - 8 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A4.T8.10.10\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb\" id=\"A4.T8.10.10.3\"><span class=\"ltx_text\" id=\"A4.T8.10.10.3.1\" style=\"font-size:90%;\">MMLU</span></th>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A4.T8.9.9.1\"><math alttext=\"2.81\\times 10^{-8}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.9.9.1.m1.1\"><semantics id=\"A4.T8.9.9.1.m1.1a\"><mrow id=\"A4.T8.9.9.1.m1.1.1\" xref=\"A4.T8.9.9.1.m1.1.1.cmml\"><mn id=\"A4.T8.9.9.1.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.9.9.1.m1.1.1.2.cmml\">2.81</mn><mo id=\"A4.T8.9.9.1.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.9.9.1.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.9.9.1.m1.1.1.3\" xref=\"A4.T8.9.9.1.m1.1.1.3.cmml\"><mn id=\"A4.T8.9.9.1.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.9.9.1.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.9.9.1.m1.1.1.3.3\" xref=\"A4.T8.9.9.1.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.9.9.1.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.9.9.1.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.9.9.1.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.9.9.1.m1.1.1.3.3.2.cmml\">8</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.9.9.1.m1.1b\"><apply id=\"A4.T8.9.9.1.m1.1.1.cmml\" xref=\"A4.T8.9.9.1.m1.1.1\"><times id=\"A4.T8.9.9.1.m1.1.1.1.cmml\" xref=\"A4.T8.9.9.1.m1.1.1.1\"></times><cn id=\"A4.T8.9.9.1.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.9.9.1.m1.1.1.2\">2.81</cn><apply id=\"A4.T8.9.9.1.m1.1.1.3.cmml\" xref=\"A4.T8.9.9.1.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.9.9.1.m1.1.1.3.1.cmml\" xref=\"A4.T8.9.9.1.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.9.9.1.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.9.9.1.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.9.9.1.m1.1.1.3.3.cmml\" xref=\"A4.T8.9.9.1.m1.1.1.3.3\"><minus id=\"A4.T8.9.9.1.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.9.9.1.m1.1.1.3.3\"></minus><cn id=\"A4.T8.9.9.1.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.9.9.1.m1.1.1.3.3.2\">8</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.9.9.1.m1.1c\">2.81\\times 10^{-8}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.9.9.1.m1.1d\">2.81 × 10 start_POSTSUPERSCRIPT - 8 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A4.T8.10.10.2\"><math alttext=\"1.42\\times 10^{-6}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.10.10.2.m1.1\"><semantics id=\"A4.T8.10.10.2.m1.1a\"><mrow id=\"A4.T8.10.10.2.m1.1.1\" xref=\"A4.T8.10.10.2.m1.1.1.cmml\"><mn id=\"A4.T8.10.10.2.m1.1.1.2\" mathsize=\"90%\" xref=\"A4.T8.10.10.2.m1.1.1.2.cmml\">1.42</mn><mo id=\"A4.T8.10.10.2.m1.1.1.1\" lspace=\"0.222em\" mathsize=\"90%\" rspace=\"0.222em\" xref=\"A4.T8.10.10.2.m1.1.1.1.cmml\">×</mo><msup id=\"A4.T8.10.10.2.m1.1.1.3\" xref=\"A4.T8.10.10.2.m1.1.1.3.cmml\"><mn id=\"A4.T8.10.10.2.m1.1.1.3.2\" mathsize=\"90%\" xref=\"A4.T8.10.10.2.m1.1.1.3.2.cmml\">10</mn><mrow id=\"A4.T8.10.10.2.m1.1.1.3.3\" xref=\"A4.T8.10.10.2.m1.1.1.3.3.cmml\"><mo id=\"A4.T8.10.10.2.m1.1.1.3.3a\" mathsize=\"90%\" xref=\"A4.T8.10.10.2.m1.1.1.3.3.cmml\">−</mo><mn id=\"A4.T8.10.10.2.m1.1.1.3.3.2\" mathsize=\"90%\" xref=\"A4.T8.10.10.2.m1.1.1.3.3.2.cmml\">6</mn></mrow></msup></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.10.10.2.m1.1b\"><apply id=\"A4.T8.10.10.2.m1.1.1.cmml\" xref=\"A4.T8.10.10.2.m1.1.1\"><times id=\"A4.T8.10.10.2.m1.1.1.1.cmml\" xref=\"A4.T8.10.10.2.m1.1.1.1\"></times><cn id=\"A4.T8.10.10.2.m1.1.1.2.cmml\" type=\"float\" xref=\"A4.T8.10.10.2.m1.1.1.2\">1.42</cn><apply id=\"A4.T8.10.10.2.m1.1.1.3.cmml\" xref=\"A4.T8.10.10.2.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.10.10.2.m1.1.1.3.1.cmml\" xref=\"A4.T8.10.10.2.m1.1.1.3\">superscript</csymbol><cn id=\"A4.T8.10.10.2.m1.1.1.3.2.cmml\" type=\"integer\" xref=\"A4.T8.10.10.2.m1.1.1.3.2\">10</cn><apply id=\"A4.T8.10.10.2.m1.1.1.3.3.cmml\" xref=\"A4.T8.10.10.2.m1.1.1.3.3\"><minus id=\"A4.T8.10.10.2.m1.1.1.3.3.1.cmml\" xref=\"A4.T8.10.10.2.m1.1.1.3.3\"></minus><cn id=\"A4.T8.10.10.2.m1.1.1.3.3.2.cmml\" type=\"integer\" xref=\"A4.T8.10.10.2.m1.1.1.3.3.2\">6</cn></apply></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.10.10.2.m1.1c\">1.42\\times 10^{-6}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.10.10.2.m1.1d\">1.42 × 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 8: </span>\nAverage Fisher information for the trainable key parameters <math alttext=\"\\Theta_{K}\\subset\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.14.m1.1\"><semantics id=\"A4.T8.14.m1.1b\"><mrow id=\"A4.T8.14.m1.1.1\" xref=\"A4.T8.14.m1.1.1.cmml\"><msub id=\"A4.T8.14.m1.1.1.2\" xref=\"A4.T8.14.m1.1.1.2.cmml\"><mi id=\"A4.T8.14.m1.1.1.2.2\" mathvariant=\"normal\" xref=\"A4.T8.14.m1.1.1.2.2.cmml\">Θ</mi><mi id=\"A4.T8.14.m1.1.1.2.3\" xref=\"A4.T8.14.m1.1.1.2.3.cmml\">K</mi></msub><mo id=\"A4.T8.14.m1.1.1.1\" xref=\"A4.T8.14.m1.1.1.1.cmml\">⊂</mo><msub id=\"A4.T8.14.m1.1.1.3\" xref=\"A4.T8.14.m1.1.1.3.cmml\"><mi id=\"A4.T8.14.m1.1.1.3.2\" mathvariant=\"normal\" xref=\"A4.T8.14.m1.1.1.3.2.cmml\">Θ</mi><mi id=\"A4.T8.14.m1.1.1.3.3\" xref=\"A4.T8.14.m1.1.1.3.3.cmml\">CT</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.14.m1.1c\"><apply id=\"A4.T8.14.m1.1.1.cmml\" xref=\"A4.T8.14.m1.1.1\"><subset id=\"A4.T8.14.m1.1.1.1.cmml\" xref=\"A4.T8.14.m1.1.1.1\"></subset><apply id=\"A4.T8.14.m1.1.1.2.cmml\" xref=\"A4.T8.14.m1.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A4.T8.14.m1.1.1.2.1.cmml\" xref=\"A4.T8.14.m1.1.1.2\">subscript</csymbol><ci id=\"A4.T8.14.m1.1.1.2.2.cmml\" xref=\"A4.T8.14.m1.1.1.2.2\">Θ</ci><ci id=\"A4.T8.14.m1.1.1.2.3.cmml\" xref=\"A4.T8.14.m1.1.1.2.3\">𝐾</ci></apply><apply id=\"A4.T8.14.m1.1.1.3.cmml\" xref=\"A4.T8.14.m1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.14.m1.1.1.3.1.cmml\" xref=\"A4.T8.14.m1.1.1.3\">subscript</csymbol><ci id=\"A4.T8.14.m1.1.1.3.2.cmml\" xref=\"A4.T8.14.m1.1.1.3.2\">Θ</ci><ci id=\"A4.T8.14.m1.1.1.3.3.cmml\" xref=\"A4.T8.14.m1.1.1.3.3\">CT</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.14.m1.1d\">\\Theta_{K}\\subset\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.14.m1.1e\">roman_Θ start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ⊂ roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> and value parameters <math alttext=\"\\Theta_{V}\\subset\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.15.m2.1\"><semantics id=\"A4.T8.15.m2.1b\"><mrow id=\"A4.T8.15.m2.1.1\" xref=\"A4.T8.15.m2.1.1.cmml\"><msub id=\"A4.T8.15.m2.1.1.2\" xref=\"A4.T8.15.m2.1.1.2.cmml\"><mi id=\"A4.T8.15.m2.1.1.2.2\" mathvariant=\"normal\" xref=\"A4.T8.15.m2.1.1.2.2.cmml\">Θ</mi><mi id=\"A4.T8.15.m2.1.1.2.3\" xref=\"A4.T8.15.m2.1.1.2.3.cmml\">V</mi></msub><mo id=\"A4.T8.15.m2.1.1.1\" xref=\"A4.T8.15.m2.1.1.1.cmml\">⊂</mo><msub id=\"A4.T8.15.m2.1.1.3\" xref=\"A4.T8.15.m2.1.1.3.cmml\"><mi id=\"A4.T8.15.m2.1.1.3.2\" mathvariant=\"normal\" xref=\"A4.T8.15.m2.1.1.3.2.cmml\">Θ</mi><mi id=\"A4.T8.15.m2.1.1.3.3\" xref=\"A4.T8.15.m2.1.1.3.3.cmml\">CT</mi></msub></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.15.m2.1c\"><apply id=\"A4.T8.15.m2.1.1.cmml\" xref=\"A4.T8.15.m2.1.1\"><subset id=\"A4.T8.15.m2.1.1.1.cmml\" xref=\"A4.T8.15.m2.1.1.1\"></subset><apply id=\"A4.T8.15.m2.1.1.2.cmml\" xref=\"A4.T8.15.m2.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A4.T8.15.m2.1.1.2.1.cmml\" xref=\"A4.T8.15.m2.1.1.2\">subscript</csymbol><ci id=\"A4.T8.15.m2.1.1.2.2.cmml\" xref=\"A4.T8.15.m2.1.1.2.2\">Θ</ci><ci id=\"A4.T8.15.m2.1.1.2.3.cmml\" xref=\"A4.T8.15.m2.1.1.2.3\">𝑉</ci></apply><apply id=\"A4.T8.15.m2.1.1.3.cmml\" xref=\"A4.T8.15.m2.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.T8.15.m2.1.1.3.1.cmml\" xref=\"A4.T8.15.m2.1.1.3\">subscript</csymbol><ci id=\"A4.T8.15.m2.1.1.3.2.cmml\" xref=\"A4.T8.15.m2.1.1.3.2\">Θ</ci><ci id=\"A4.T8.15.m2.1.1.3.3.cmml\" xref=\"A4.T8.15.m2.1.1.3.3\">CT</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.15.m2.1d\">\\Theta_{V}\\subset\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.15.m2.1e\">roman_Θ start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ⊂ roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math> across 5 random selections of <math alttext=\"k\" class=\"ltx_Math\" display=\"inline\" id=\"A4.T8.16.m3.1\"><semantics id=\"A4.T8.16.m3.1b\"><mi id=\"A4.T8.16.m3.1.1\" xref=\"A4.T8.16.m3.1.1.cmml\">k</mi><annotation-xml encoding=\"MathML-Content\" id=\"A4.T8.16.m3.1c\"><ci id=\"A4.T8.16.m3.1.1.cmml\" xref=\"A4.T8.16.m3.1.1\">𝑘</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.T8.16.m3.1d\">k</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.T8.16.m3.1e\">italic_k</annotation></semantics></math> demonstration pairs over each dataset.\n</figcaption>\n</figure>\n</section>\n<section class=\"ltx_paragraph\" id=\"A4.SS0.SSS0.Px2\">\n<h4 class=\"ltx_title ltx_title_paragraph\">CT-Prefix</h4>\n<div class=\"ltx_para\" id=\"A4.SS0.SSS0.Px2.p1\">\n<p class=\"ltx_p\" id=\"A4.SS0.SSS0.Px2.p1.4\">We freeze <math alttext=\"\\Theta_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.1.m1.1\"><semantics id=\"A4.SS0.SSS0.Px2.p1.1.m1.1a\"><msub id=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.3\" xref=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml\">CT</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.1.m1.1b\"><apply id=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.1.m1.1.1.3\">CT</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.1.m1.1c\">\\Theta_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.1.m1.1d\">roman_Θ start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math>, average the parameters across tokens to obtain an average prefix <math alttext=\"\\bar{\\Theta}_{\\mathrm{CT}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.2.m2.1\"><semantics id=\"A4.SS0.SSS0.Px2.p1.2.m2.1a\"><msub id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml\"><mover accent=\"true\" id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml\"><mi id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml\">Θ</mi><mo id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.1\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml\">¯</mo></mover><mi id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.3\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml\">CT</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.2.m2.1b\"><apply id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1\">subscript</csymbol><apply id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2\"><ci id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.1\">¯</ci><ci id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.2.2\">Θ</ci></apply><ci id=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.2.m2.1.1.3\">CT</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.2.m2.1c\">\\bar{\\Theta}_{\\mathrm{CT}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.2.m2.1d\">over¯ start_ARG roman_Θ end_ARG start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT</annotation></semantics></math>, and then form a new trainable <math alttext=\"m\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.3.m3.1\"><semantics id=\"A4.SS0.SSS0.Px2.p1.3.m3.1a\"><mi id=\"A4.SS0.SSS0.Px2.p1.3.m3.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml\">m</mi><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.3.m3.1b\"><ci id=\"A4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.3.m3.1.1\">𝑚</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.3.m3.1c\">m</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.3.m3.1d\">italic_m</annotation></semantics></math>-token prefix <math alttext=\"\\Theta_{\\mathrm{prefix}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.4.m4.1\"><semantics id=\"A4.SS0.SSS0.Px2.p1.4.m4.1a\"><msub id=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.3\" xref=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml\">prefix</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.4.m4.1b\"><apply id=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.4.m4.1.1.3\">prefix</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.4.m4.1c\">\\Theta_{\\mathrm{prefix}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.4.m4.1d\">roman_Θ start_POSTSUBSCRIPT roman_prefix end_POSTSUBSCRIPT</annotation></semantics></math> by adding small Gaussian perturbations:</p>\n<table class=\"ltx_equation ltx_eqn_table\" id=\"A4.Ex17\">\n<tbody><tr class=\"ltx_equation ltx_eqn_row ltx_align_baseline\">\n<td class=\"ltx_eqn_cell ltx_eqn_center_padleft\"></td>\n<td class=\"ltx_eqn_cell ltx_align_center\"><math alttext=\"\\Theta_{\\mathrm{prefix}}=\\{\\bar{\\Theta}_{\\mathrm{CT}}+\\epsilon_{i}\\}_{i=1}^{m},\" class=\"ltx_Math\" display=\"block\" id=\"A4.Ex17.m1.1\"><semantics id=\"A4.Ex17.m1.1a\"><mrow id=\"A4.Ex17.m1.1.1.1\" xref=\"A4.Ex17.m1.1.1.1.1.cmml\"><mrow id=\"A4.Ex17.m1.1.1.1.1\" xref=\"A4.Ex17.m1.1.1.1.1.cmml\"><msub id=\"A4.Ex17.m1.1.1.1.1.3\" xref=\"A4.Ex17.m1.1.1.1.1.3.cmml\"><mi id=\"A4.Ex17.m1.1.1.1.1.3.2\" mathvariant=\"normal\" xref=\"A4.Ex17.m1.1.1.1.1.3.2.cmml\">Θ</mi><mi id=\"A4.Ex17.m1.1.1.1.1.3.3\" xref=\"A4.Ex17.m1.1.1.1.1.3.3.cmml\">prefix</mi></msub><mo id=\"A4.Ex17.m1.1.1.1.1.2\" xref=\"A4.Ex17.m1.1.1.1.1.2.cmml\">=</mo><msubsup id=\"A4.Ex17.m1.1.1.1.1.1\" xref=\"A4.Ex17.m1.1.1.1.1.1.cmml\"><mrow id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.2.cmml\"><mo id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.2\" stretchy=\"false\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.2.cmml\">{</mo><mrow id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.cmml\"><msub id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.cmml\"><mover accent=\"true\" id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.cmml\"><mi id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.2\" mathvariant=\"normal\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml\">Θ</mi><mo id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.1\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml\">¯</mo></mover><mi id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.3\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.3.cmml\">CT</mi></msub><mo id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.1\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.1.cmml\">+</mo><msub id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.cmml\"><mi id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.2\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.2.cmml\">ϵ</mi><mi id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.3\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.3.cmml\">i</mi></msub></mrow><mo id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.3\" stretchy=\"false\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.2.cmml\">}</mo></mrow><mrow id=\"A4.Ex17.m1.1.1.1.1.1.1.3\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3.cmml\"><mi id=\"A4.Ex17.m1.1.1.1.1.1.1.3.2\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3.2.cmml\">i</mi><mo id=\"A4.Ex17.m1.1.1.1.1.1.1.3.1\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3.1.cmml\">=</mo><mn id=\"A4.Ex17.m1.1.1.1.1.1.1.3.3\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3.3.cmml\">1</mn></mrow><mi id=\"A4.Ex17.m1.1.1.1.1.1.3\" xref=\"A4.Ex17.m1.1.1.1.1.1.3.cmml\">m</mi></msubsup></mrow><mo id=\"A4.Ex17.m1.1.1.1.2\" xref=\"A4.Ex17.m1.1.1.1.1.cmml\">,</mo></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.Ex17.m1.1b\"><apply id=\"A4.Ex17.m1.1.1.1.1.cmml\" xref=\"A4.Ex17.m1.1.1.1\"><eq id=\"A4.Ex17.m1.1.1.1.1.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.2\"></eq><apply id=\"A4.Ex17.m1.1.1.1.1.3.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.Ex17.m1.1.1.1.1.3.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.3\">subscript</csymbol><ci id=\"A4.Ex17.m1.1.1.1.1.3.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.3.2\">Θ</ci><ci id=\"A4.Ex17.m1.1.1.1.1.3.3.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.3.3\">prefix</ci></apply><apply id=\"A4.Ex17.m1.1.1.1.1.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.Ex17.m1.1.1.1.1.1.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1\">superscript</csymbol><apply id=\"A4.Ex17.m1.1.1.1.1.1.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.Ex17.m1.1.1.1.1.1.1.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1\">subscript</csymbol><set id=\"A4.Ex17.m1.1.1.1.1.1.1.1.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1\"><apply id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1\"><plus id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.1\"></plus><apply id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2\"><csymbol cd=\"ambiguous\" id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2\">subscript</csymbol><apply id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2\"><ci id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.1\">¯</ci><ci id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.2.2\">Θ</ci></apply><ci id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.3.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.2.3\">CT</ci></apply><apply id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3\"><csymbol cd=\"ambiguous\" id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3\">subscript</csymbol><ci id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.2\">italic-ϵ</ci><ci id=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.3.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.1.1.1.3.3\">𝑖</ci></apply></apply></set><apply id=\"A4.Ex17.m1.1.1.1.1.1.1.3.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3\"><eq id=\"A4.Ex17.m1.1.1.1.1.1.1.3.1.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3.1\"></eq><ci id=\"A4.Ex17.m1.1.1.1.1.1.1.3.2.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3.2\">𝑖</ci><cn id=\"A4.Ex17.m1.1.1.1.1.1.1.3.3.cmml\" type=\"integer\" xref=\"A4.Ex17.m1.1.1.1.1.1.1.3.3\">1</cn></apply></apply><ci id=\"A4.Ex17.m1.1.1.1.1.1.3.cmml\" xref=\"A4.Ex17.m1.1.1.1.1.1.3\">𝑚</ci></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.Ex17.m1.1c\">\\Theta_{\\mathrm{prefix}}=\\{\\bar{\\Theta}_{\\mathrm{CT}}+\\epsilon_{i}\\}_{i=1}^{m},</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.Ex17.m1.1d\">roman_Θ start_POSTSUBSCRIPT roman_prefix end_POSTSUBSCRIPT = { over¯ start_ARG roman_Θ end_ARG start_POSTSUBSCRIPT roman_CT end_POSTSUBSCRIPT + italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>\n<td class=\"ltx_eqn_cell ltx_eqn_center_padright\"></td>\n</tr></tbody>\n</table>\n<p class=\"ltx_p\" id=\"A4.SS0.SSS0.Px2.p1.8\">where <math alttext=\"\\epsilon_{i}\\in\\mathcal{N}(0,0.02)\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.5.m1.2\"><semantics id=\"A4.SS0.SSS0.Px2.p1.5.m1.2a\"><mrow id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.cmml\"><msub id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.cmml\"><mi id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.2\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.2.cmml\">ϵ</mi><mi id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.3\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.3.cmml\">i</mi></msub><mo id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.1\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.1.cmml\">∈</mo><mrow id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.cmml\"><mi class=\"ltx_font_mathcaligraphic\" id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.2\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.2.cmml\">𝒩</mi><mo id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.1\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.1.cmml\">⁢</mo><mrow id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.2\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.1.cmml\"><mo id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.2.1\" stretchy=\"false\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.1.cmml\">(</mo><mn id=\"A4.SS0.SSS0.Px2.p1.5.m1.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.1.1.cmml\">0</mn><mo id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.2.2\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.1.cmml\">,</mo><mn id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.2\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.2.cmml\">0.02</mn><mo id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.2.3\" stretchy=\"false\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.1.cmml\">)</mo></mrow></mrow></mrow><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.5.m1.2b\"><apply id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3\"><in id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.1\"></in><apply id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.2\">italic-ϵ</ci><ci id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.2.3\">𝑖</ci></apply><apply id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3\"><times id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.1\"></times><ci id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.2\">𝒩</ci><interval closure=\"open\" id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.3.3.3.2\"><cn id=\"A4.SS0.SSS0.Px2.p1.5.m1.1.1.cmml\" type=\"integer\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.1.1\">0</cn><cn id=\"A4.SS0.SSS0.Px2.p1.5.m1.2.2.cmml\" type=\"float\" xref=\"A4.SS0.SSS0.Px2.p1.5.m1.2.2\">0.02</cn></interval></apply></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.5.m1.2c\">\\epsilon_{i}\\in\\mathcal{N}(0,0.02)</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.5.m1.2d\">italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_N ( 0 , 0.02 )</annotation></semantics></math>. The model additionally conditions on <math alttext=\"\\Theta_{\\mathrm{prefix}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.6.m2.1\"><semantics id=\"A4.SS0.SSS0.Px2.p1.6.m2.1a\"><msub id=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.3\" xref=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.3.cmml\">prefix</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.6.m2.1b\"><apply id=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.6.m2.1.1.3\">prefix</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.6.m2.1c\">\\Theta_{\\mathrm{prefix}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.6.m2.1d\">roman_Θ start_POSTSUBSCRIPT roman_prefix end_POSTSUBSCRIPT</annotation></semantics></math>, analogous to Prefix Tuning. Since we only train <math alttext=\"\\Theta_{\\mathrm{prefix}}\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.7.m3.1\"><semantics id=\"A4.SS0.SSS0.Px2.p1.7.m3.1a\"><msub id=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.cmml\"><mi id=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.2\" mathvariant=\"normal\" xref=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.2.cmml\">Θ</mi><mi id=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.3\" xref=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.3.cmml\">prefix</mi></msub><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.7.m3.1b\"><apply id=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1\"><csymbol cd=\"ambiguous\" id=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1\">subscript</csymbol><ci id=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.2.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.2\">Θ</ci><ci id=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.3.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.7.m3.1.1.3\">prefix</ci></apply></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.7.m3.1c\">\\Theta_{\\mathrm{prefix}}</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.7.m3.1d\">roman_Θ start_POSTSUBSCRIPT roman_prefix end_POSTSUBSCRIPT</annotation></semantics></math>, this variant has the same number of trainable parameters as Prefix Tuning with <math alttext=\"m\" class=\"ltx_Math\" display=\"inline\" id=\"A4.SS0.SSS0.Px2.p1.8.m4.1\"><semantics id=\"A4.SS0.SSS0.Px2.p1.8.m4.1a\"><mi id=\"A4.SS0.SSS0.Px2.p1.8.m4.1.1\" xref=\"A4.SS0.SSS0.Px2.p1.8.m4.1.1.cmml\">m</mi><annotation-xml encoding=\"MathML-Content\" id=\"A4.SS0.SSS0.Px2.p1.8.m4.1b\"><ci id=\"A4.SS0.SSS0.Px2.p1.8.m4.1.1.cmml\" xref=\"A4.SS0.SSS0.Px2.p1.8.m4.1.1\">𝑚</ci></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A4.SS0.SSS0.Px2.p1.8.m4.1c\">m</annotation><annotation encoding=\"application/x-llamapun\" id=\"A4.SS0.SSS0.Px2.p1.8.m4.1d\">italic_m</annotation></semantics></math> tokens.</p>\n</div>\n<div class=\"ltx_para\" id=\"A4.SS0.SSS0.Px2.p2\">\n<p class=\"ltx_p\" id=\"A4.SS0.SSS0.Px2.p2.1\">We evaluate <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px2.p2.1.1\">CT-V</span> and <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px2.p2.1.2\">CT-Prefix</span> across all benchmarks and compare them to <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px2.p2.1.3\">CT-KV</span> in Table <a class=\"ltx_ref\" href=\"#A4.T9\" title=\"Table 9 ‣ CT-Prefix ‣ Appendix D Parameter-Efficient Variants of CT-KV ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">9</span></a>, showing that both parameter-efficient variants retain most of the performance gain of <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px2.p2.1.4\">CT-KV</span> and outperform Prefix Tuning. For <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px2.p2.1.5\">CT-V</span>, we use the same hyperparameters as <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px2.p2.1.6\">CT-KV</span> from Section <a class=\"ltx_ref\" href=\"#A3\" title=\"Appendix C More Details on Experiment Setup ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">C</span></a>. For <span class=\"ltx_text ltx_font_italic\" id=\"A4.SS0.SSS0.Px2.p2.1.7\">CT-Prefix</span>, we find that higher learning rates, 1e-1 for NLP-LR and 5e-2 for other datasets, are needed for better performance.</p>\n</div>\n<figure class=\"ltx_table\" id=\"A4.T9\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"A4.T9.1\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"A4.T9.1.1.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt\" id=\"A4.T9.1.1.1.1\"><span class=\"ltx_text ltx_font_bold\" id=\"A4.T9.1.1.1.1.1\" style=\"font-size:90%;\">Method</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A4.T9.1.1.1.2\"><span class=\"ltx_text ltx_font_bold\" id=\"A4.T9.1.1.1.2.1\" style=\"font-size:90%;\">NLP-LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A4.T9.1.1.1.3\"><span class=\"ltx_text ltx_font_bold\" id=\"A4.T9.1.1.1.3.1\" style=\"font-size:90%;\">MMLU</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A4.T9.1.1.1.4\"><span class=\"ltx_text ltx_font_bold\" id=\"A4.T9.1.1.1.4.1\" style=\"font-size:90%;\">BBH</span></th>\n<th class=\"ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A4.T9.1.1.1.5\"><span class=\"ltx_text ltx_font_bold\" id=\"A4.T9.1.1.1.5.1\" style=\"font-size:90%;\">ARC</span></th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"A4.T9.1.2.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" id=\"A4.T9.1.2.1.1\"><span class=\"ltx_text\" id=\"A4.T9.1.2.1.1.1\" style=\"font-size:90%;\">Prefix Tuning (m = 32)</span></th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A4.T9.1.2.1.2\"><span class=\"ltx_text\" id=\"A4.T9.1.2.1.2.1\" style=\"font-size:90%;\">42.0</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A4.T9.1.2.1.3\"><span class=\"ltx_text\" id=\"A4.T9.1.2.1.3.1\" style=\"font-size:90%;\">39.9</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A4.T9.1.2.1.4\"><span class=\"ltx_text\" id=\"A4.T9.1.2.1.4.1\" style=\"font-size:90%;\">52.7</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_t\" id=\"A4.T9.1.2.1.5\"><span class=\"ltx_text\" id=\"A4.T9.1.2.1.5.1\" style=\"font-size:90%;\">9.3</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A4.T9.1.3.2\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A4.T9.1.3.2.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A4.T9.1.3.2.1.1\" style=\"font-size:90%;\">CT-Prefix</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T9.1.3.2.2\"><span class=\"ltx_text\" id=\"A4.T9.1.3.2.2.1\" style=\"font-size:90%;\">44.0</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T9.1.3.2.3\"><span class=\"ltx_text\" id=\"A4.T9.1.3.2.3.1\" style=\"font-size:90%;\">42.6</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T9.1.3.2.4\"><span class=\"ltx_text\" id=\"A4.T9.1.3.2.4.1\" style=\"font-size:90%;\">55.9</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A4.T9.1.3.2.5\"><span class=\"ltx_text\" id=\"A4.T9.1.3.2.5.1\" style=\"font-size:90%;\">22.8</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A4.T9.1.4.3\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A4.T9.1.4.3.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A4.T9.1.4.3.1.1\" style=\"font-size:90%;\">CT-V</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T9.1.4.3.2\"><span class=\"ltx_text\" id=\"A4.T9.1.4.3.2.1\" style=\"font-size:90%;\">44.0</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T9.1.4.3.3\"><span class=\"ltx_text\" id=\"A4.T9.1.4.3.3.1\" style=\"font-size:90%;\">43.5</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A4.T9.1.4.3.4\"><span class=\"ltx_text\" id=\"A4.T9.1.4.3.4.1\" style=\"font-size:90%;\">57.5</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A4.T9.1.4.3.5\"><span class=\"ltx_text\" id=\"A4.T9.1.4.3.5.1\" style=\"font-size:90%;\">23.5</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A4.T9.1.5.4\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb\" id=\"A4.T9.1.5.4.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A4.T9.1.5.4.1.1\" style=\"font-size:90%;\">CT-KV</span></th>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A4.T9.1.5.4.2\"><span class=\"ltx_text\" id=\"A4.T9.1.5.4.2.1\" style=\"font-size:90%;\">44.2</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A4.T9.1.5.4.3\"><span class=\"ltx_text\" id=\"A4.T9.1.5.4.3.1\" style=\"font-size:90%;\">43.7</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A4.T9.1.5.4.4\"><span class=\"ltx_text\" id=\"A4.T9.1.5.4.4.1\" style=\"font-size:90%;\">57.9</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_bb\" id=\"A4.T9.1.5.4.5\"><span class=\"ltx_text\" id=\"A4.T9.1.5.4.5.1\" style=\"font-size:90%;\">23.8</span></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 9: </span>\nAccuracies (%) of <span class=\"ltx_text ltx_font_italic\" id=\"A4.T9.6.1\">CT-KV</span>, its parameter-efficient variants, and Prefix Tuning across benchmarks, averaged over 5 seeds (except for ARC because it has fixed demonstration pairs).\n</figcaption>\n</figure>\n</section>\n</section>\n<section class=\"ltx_appendix\" id=\"A5\">\n<h2 class=\"ltx_title ltx_title_appendix\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix E </span>Number of Trainable Parameters</h2>\n<div class=\"ltx_para\" id=\"A5.p1\">\n<p class=\"ltx_p\" id=\"A5.p1.1\">Corresponding to the performance shown in Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a>, we report the average number of trainable parameters for each method across tasks in Table <a class=\"ltx_ref\" href=\"#A5.T10\" title=\"Table 10 ‣ Appendix E Number of Trainable Parameters ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">10</span></a>. Note that although <span class=\"ltx_text ltx_font_italic\" id=\"A5.p1.1.1\">CT-KV</span>’s number of trainable parameters scales with the number of demonstration tokens, it still trains significantly fewer parameters on average per task than the number of LoRA parameters used by TTT. Following <cite class=\"ltx_cite ltx_citemacro_citet\">Akyürek et al., (<a class=\"ltx_ref\" href=\"#bib.bib1\" title=\"\">2024</a>)</cite>, we use task instructions for BBH and set the instruction prompt or prefix to be trainable as well. We omit Zero-Shot and ICL from this comparison because they do not involve any trainable parameters.</p>\n</div>\n<figure class=\"ltx_table\" id=\"A5.T10\">\n<table class=\"ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle\" id=\"A5.T10.1\">\n<thead class=\"ltx_thead\">\n<tr class=\"ltx_tr\" id=\"A5.T10.1.1.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt\" id=\"A5.T10.1.1.1.1\"><span class=\"ltx_text ltx_font_bold\" id=\"A5.T10.1.1.1.1.1\" style=\"font-size:90%;\">Method</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A5.T10.1.1.1.2\"><span class=\"ltx_text ltx_font_bold\" id=\"A5.T10.1.1.1.2.1\" style=\"font-size:90%;\">NLP-LR</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A5.T10.1.1.1.3\"><span class=\"ltx_text ltx_font_bold\" id=\"A5.T10.1.1.1.3.1\" style=\"font-size:90%;\">MMLU</span></th>\n<th class=\"ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A5.T10.1.1.1.4\"><span class=\"ltx_text ltx_font_bold\" id=\"A5.T10.1.1.1.4.1\" style=\"font-size:90%;\">BBH</span></th>\n<th class=\"ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt\" id=\"A5.T10.1.1.1.5\"><span class=\"ltx_text ltx_font_bold\" id=\"A5.T10.1.1.1.5.1\" style=\"font-size:90%;\">ARC</span></th>\n</tr>\n</thead>\n<tbody class=\"ltx_tbody\">\n<tr class=\"ltx_tr\" id=\"A5.T10.1.2.1\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t\" id=\"A5.T10.1.2.1.1\"><span class=\"ltx_text\" id=\"A5.T10.1.2.1.1.1\" style=\"font-size:90%;\">Prompt Tuning (m = 32)</span></th>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A5.T10.1.2.1.2\"><span class=\"ltx_text\" id=\"A5.T10.1.2.1.2.1\" style=\"font-size:90%;\">41</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A5.T10.1.2.1.3\"><span class=\"ltx_text\" id=\"A5.T10.1.2.1.3.1\" style=\"font-size:90%;\">98</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_t\" id=\"A5.T10.1.2.1.4\"><span class=\"ltx_text\" id=\"A5.T10.1.2.1.4.1\" style=\"font-size:90%;\">229</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_t\" id=\"A5.T10.1.2.1.5\"><span class=\"ltx_text\" id=\"A5.T10.1.2.1.5.1\" style=\"font-size:90%;\">66</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.3.2\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.3.2.1\"><span class=\"ltx_text\" id=\"A5.T10.1.3.2.1.1\" style=\"font-size:90%;\">Prompt Tuning (m = # demo)</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.3.2.2\"><span class=\"ltx_text\" id=\"A5.T10.1.3.2.2.1\" style=\"font-size:90%;\">578</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.3.2.3\"><span class=\"ltx_text\" id=\"A5.T10.1.3.2.3.1\" style=\"font-size:90%;\">2160</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.3.2.4\"><span class=\"ltx_text\" id=\"A5.T10.1.3.2.4.1\" style=\"font-size:90%;\">3656</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.3.2.5\"><span class=\"ltx_text\" id=\"A5.T10.1.3.2.5.1\" style=\"font-size:90%;\">2743</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.4.3\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.4.3.1\"><span class=\"ltx_text\" id=\"A5.T10.1.4.3.1.1\" style=\"font-size:90%;\">Prefix Tuning (m = 32)</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.4.3.2\"><span class=\"ltx_text\" id=\"A5.T10.1.4.3.2.1\" style=\"font-size:90%;\">2949</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.4.3.3\"><span class=\"ltx_text\" id=\"A5.T10.1.4.3.3.1\" style=\"font-size:90%;\">1835</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.4.3.4\"><span class=\"ltx_text\" id=\"A5.T10.1.4.3.4.1\" style=\"font-size:90%;\">3668</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.4.3.5\"><span class=\"ltx_text\" id=\"A5.T10.1.4.3.5.1\" style=\"font-size:90%;\">524</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.5.4\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.5.4.1\"><span class=\"ltx_text\" id=\"A5.T10.1.5.4.1.1\" style=\"font-size:90%;\">Prefix Tuning (m = # demo)</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.5.4.2\"><span class=\"ltx_text\" id=\"A5.T10.1.5.4.2.1\" style=\"font-size:90%;\">41634</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.5.4.3\"><span class=\"ltx_text\" id=\"A5.T10.1.5.4.3.1\" style=\"font-size:90%;\">40327</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.5.4.4\"><span class=\"ltx_text\" id=\"A5.T10.1.5.4.4.1\" style=\"font-size:90%;\">58501</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.5.4.5\"><span class=\"ltx_text\" id=\"A5.T10.1.5.4.5.1\" style=\"font-size:90%;\">21944</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.6.5\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.6.5.1\"><span class=\"ltx_text\" id=\"A5.T10.1.6.5.1.1\" style=\"font-size:90%;\">TTT</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.6.5.2\"><span class=\"ltx_text\" id=\"A5.T10.1.6.5.2.1\" style=\"font-size:90%;\">47186</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.6.5.3\"><span class=\"ltx_text\" id=\"A5.T10.1.6.5.3.1\" style=\"font-size:90%;\">89915</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.6.5.4\"><span class=\"ltx_text\" id=\"A5.T10.1.6.5.4.1\" style=\"font-size:90%;\">157286</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.6.5.5\"><span class=\"ltx_text\" id=\"A5.T10.1.6.5.5.1\" style=\"font-size:90%;\">84935</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.7.6\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.7.6.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A5.T10.1.7.6.1.1\" style=\"font-size:90%;\">CT-Prompt</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.7.6.2\"><span class=\"ltx_text\" id=\"A5.T10.1.7.6.2.1\" style=\"font-size:90%;\">578</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.7.6.3\"><span class=\"ltx_text\" id=\"A5.T10.1.7.6.3.1\" style=\"font-size:90%;\">2160</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.7.6.4\"><span class=\"ltx_text\" id=\"A5.T10.1.7.6.4.1\" style=\"font-size:90%;\">3656</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.7.6.5\"><span class=\"ltx_text\" id=\"A5.T10.1.7.6.5.1\" style=\"font-size:90%;\">2743</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.8.7\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.8.7.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A5.T10.1.8.7.1.1\" style=\"font-size:90%;\">CT-Prefix</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.8.7.2\"><span class=\"ltx_text\" id=\"A5.T10.1.8.7.2.1\" style=\"font-size:90%;\">2949</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.8.7.3\"><span class=\"ltx_text\" id=\"A5.T10.1.8.7.3.1\" style=\"font-size:90%;\">1835</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.8.7.4\"><span class=\"ltx_text\" id=\"A5.T10.1.8.7.4.1\" style=\"font-size:90%;\">3668</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.8.7.5\"><span class=\"ltx_text\" id=\"A5.T10.1.8.7.5.1\" style=\"font-size:90%;\">524</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.9.8\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.9.8.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A5.T10.1.9.8.1.1\" style=\"font-size:90%;\">Context Tuning</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.9.8.2\"><span class=\"ltx_text\" id=\"A5.T10.1.9.8.2.1\" style=\"font-size:90%;\">20817</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.9.8.3\"><span class=\"ltx_text\" id=\"A5.T10.1.9.8.3.1\" style=\"font-size:90%;\">20163</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.9.8.4\"><span class=\"ltx_text\" id=\"A5.T10.1.9.8.4.1\" style=\"font-size:90%;\">29250</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.9.8.5\"><span class=\"ltx_text\" id=\"A5.T10.1.9.8.5.1\" style=\"font-size:90%;\">10972</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.10.9\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row\" id=\"A5.T10.1.10.9.1\"><span class=\"ltx_text ltx_font_italic\" id=\"A5.T10.1.10.9.1.1\" style=\"font-size:90%;\">CT-KV</span></th>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.10.9.2\"><span class=\"ltx_text\" id=\"A5.T10.1.10.9.2.1\" style=\"font-size:90%;\">41634</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.10.9.3\"><span class=\"ltx_text\" id=\"A5.T10.1.10.9.3.1\" style=\"font-size:90%;\">40327</span></td>\n<td class=\"ltx_td ltx_align_center\" id=\"A5.T10.1.10.9.4\"><span class=\"ltx_text\" id=\"A5.T10.1.10.9.4.1\" style=\"font-size:90%;\">58501</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center\" id=\"A5.T10.1.10.9.5\"><span class=\"ltx_text\" id=\"A5.T10.1.10.9.5.1\" style=\"font-size:90%;\">21944</span></td>\n</tr>\n<tr class=\"ltx_tr\" id=\"A5.T10.1.11.10\">\n<th class=\"ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb\" id=\"A5.T10.1.11.10.1\">\n<span class=\"ltx_text\" id=\"A5.T10.1.11.10.1.1\" style=\"font-size:90%;\">TTT+</span><span class=\"ltx_text ltx_font_italic\" id=\"A5.T10.1.11.10.1.2\" style=\"font-size:90%;\">CT-KV</span>\n</th>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A5.T10.1.11.10.2\"><span class=\"ltx_text\" id=\"A5.T10.1.11.10.2.1\" style=\"font-size:90%;\">88820</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A5.T10.1.11.10.3\"><span class=\"ltx_text\" id=\"A5.T10.1.11.10.3.1\" style=\"font-size:90%;\">130242</span></td>\n<td class=\"ltx_td ltx_align_center ltx_border_bb\" id=\"A5.T10.1.11.10.4\"><span class=\"ltx_text\" id=\"A5.T10.1.11.10.4.1\" style=\"font-size:90%;\">215787</span></td>\n<td class=\"ltx_td ltx_nopad_r ltx_align_center ltx_border_bb\" id=\"A5.T10.1.11.10.5\"><span class=\"ltx_text\" id=\"A5.T10.1.11.10.5.1\" style=\"font-size:90%;\">106878</span></td>\n</tr>\n</tbody>\n</table>\n<figcaption class=\"ltx_caption ltx_centering\" style=\"font-size:90%;\"><span class=\"ltx_tag ltx_tag_table\">Table 10: </span>\nNumber of trainable parameters (in thousands) for each method across benchmarks, corresponding to entries in Table <a class=\"ltx_ref\" href=\"#S5.T1\" title=\"Table 1 ‣ 5.4 Comparing Context Tuning to Baselines ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">1</span></a>.\n</figcaption>\n</figure>\n</section>\n<section class=\"ltx_appendix\" id=\"A6\">\n<h2 class=\"ltx_title ltx_title_appendix\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix F </span>Qualitative Samples vs. Training Iteration</h2>\n<figure class=\"ltx_figure\" id=\"A6.F5\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_portrait\" height=\"680\" id=\"A6.F5.g1\" src=\"./assets/x5.png\" width=\"538\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 5: </span>\nFor each of the two ARC tasks at the top and bottom, we display 4 demonstration query-answer pairs, the test query, and LLM predictions at <span class=\"ltx_text ltx_font_italic\" id=\"A6.F5.2.1\">CT-KV</span> training iterations 0, 50, 100, 150, 200. Note that iteration 0 is equivalent to ICL. We color-code the iterations of correct predictions in green and incorrect predictions in red.\n</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"A6.p1\">\n<p class=\"ltx_p\" id=\"A6.p1.1\">In this section, we select sample tasks from question-answering datasets to illustrate how autoregressively generated answers gradually improve with <span class=\"ltx_text ltx_font_italic\" id=\"A6.p1.1.1\">CT-KV</span> training. We present two ARC tasks in Figure <a class=\"ltx_ref\" href=\"#A6.F5\" title=\"Figure 5 ‣ Appendix F Qualitative Samples vs. Training Iteration ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">5</span></a>. In the top task, the model’s prediction at iteration 0 (equivalent to ICL) shows a strong bias toward filling orange squares with yellow. As <span class=\"ltx_text ltx_font_italic\" id=\"A6.p1.1.2\">CT-KV</span> training progresses, the model gradually learns to fill each orange square with the correct color. Similarly, in the bottom task, the model first learns that only grey grid cells can turn red, and then correctly completes the cross shapes.</p>\n</div>\n<figure class=\"ltx_figure\" id=\"A6.F6\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"336\" id=\"A6.F6.g1\" src=\"./assets/x6.png\" width=\"598\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 6: </span>\nWe display LLM predictions at <span class=\"ltx_text ltx_font_italic\" id=\"A6.F6.4.1\">CT-KV</span> training iterations 0, 12, 16, 20 for two queries from the task “word sorting” in BBH. We omit showing the <math alttext=\"16\" class=\"ltx_Math\" display=\"inline\" id=\"A6.F6.2.m1.1\"><semantics id=\"A6.F6.2.m1.1b\"><mn id=\"A6.F6.2.m1.1.1\" xref=\"A6.F6.2.m1.1.1.cmml\">16</mn><annotation-xml encoding=\"MathML-Content\" id=\"A6.F6.2.m1.1c\"><cn id=\"A6.F6.2.m1.1.1.cmml\" type=\"integer\" xref=\"A6.F6.2.m1.1.1\">16</cn></annotation-xml><annotation encoding=\"application/x-tex\" id=\"A6.F6.2.m1.1d\">16</annotation><annotation encoding=\"application/x-llamapun\" id=\"A6.F6.2.m1.1e\">16</annotation></semantics></math> demonstration pairs of each task for brevity. We color-code the iterations of correct predictions in green and incorrect predictions in red.\n</figcaption>\n</figure>\n<div class=\"ltx_para\" id=\"A6.p2\">\n<p class=\"ltx_p\" id=\"A6.p2.1\">Similarly, for BBH, in Figure <a class=\"ltx_ref\" href=\"#A6.F6\" title=\"Figure 6 ‣ Appendix F Qualitative Samples vs. Training Iteration ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">6</span></a>’s top query, the model initially predicts “padre, panicking” and “schoolmate, suburbia” in reversed order at iteration 0. During <span class=\"ltx_text ltx_font_italic\" id=\"A6.p2.1.1\">CT-KV</span> training, the model learns to use the second letter of each word for sorting and eventually answers the query correctly. Likewise, for the bottom query, <span class=\"ltx_text ltx_font_italic\" id=\"A6.p2.1.2\">CT-KV</span> helps the model avoid omitting the word “scrumptious” from its outputs and sort the words “sidereal, siena” into the correct order based on their second letters.</p>\n</div>\n</section>\n<section class=\"ltx_appendix\" id=\"A7\">\n<h2 class=\"ltx_title ltx_title_appendix\">\n<span class=\"ltx_tag ltx_tag_appendix\">Appendix G </span>Demonstration Pairs for Figure <a class=\"ltx_ref\" href=\"#S5.F3\" title=\"Figure 3 ‣ 5.1 Datasets ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">3</span></a>\n</h2>\n<div class=\"ltx_para\" id=\"A7.p1\">\n<p class=\"ltx_p\" id=\"A7.p1.1\">We present three demonstration pairs of datasets: BBH, NLP-LR, and MMLU in Figure <a class=\"ltx_ref\" href=\"#A7.F7\" title=\"Figure 7 ‣ Appendix G Demonstration Pairs for Figure 3 ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">7</span></a>, Figure <a class=\"ltx_ref\" href=\"#A7.F8\" title=\"Figure 8 ‣ Appendix G Demonstration Pairs for Figure 3 ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">8</span></a>, and Figure <a class=\"ltx_ref\" href=\"#A7.F9\" title=\"Figure 9 ‣ Appendix G Demonstration Pairs for Figure 3 ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">9</span></a>, respectively.</p>\n</div>\n<figure class=\"ltx_figure\" id=\"A7.F7\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_square\" height=\"549\" id=\"A7.F7.g1\" src=\"./assets/x7.png\" width=\"598\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 7: </span>3 demonstration pairs for the BBH task from Figure <a class=\"ltx_ref\" href=\"#S5.F3\" title=\"Figure 3 ‣ 5.1 Datasets ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">3</span></a>.</figcaption>\n</figure>\n<figure class=\"ltx_figure\" id=\"A7.F8\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"218\" id=\"A7.F8.g1\" src=\"./assets/x8.png\" width=\"598\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 8: </span>3 demonstration pairs for the NLP-LR task from Figure <a class=\"ltx_ref\" href=\"#S5.F3\" title=\"Figure 3 ‣ 5.1 Datasets ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">3</span></a>.</figcaption>\n</figure>\n<figure class=\"ltx_figure\" id=\"A7.F9\"><img alt=\"Refer to caption\" class=\"ltx_graphics ltx_centering ltx_img_landscape\" height=\"221\" id=\"A7.F9.g1\" src=\"./assets/x9.png\" width=\"598\"/>\n<figcaption class=\"ltx_caption ltx_centering\"><span class=\"ltx_tag ltx_tag_figure\">Figure 9: </span>3 demonstration pairs for the MMLU task from Figure <a class=\"ltx_ref\" href=\"#S5.F3\" title=\"Figure 3 ‣ 5.1 Datasets ‣ 5 Experiments ‣ Context Tuning for In-Context Optimization\"><span class=\"ltx_text ltx_ref_tag\">3</span></a>.</figcaption>\n</figure>\n<div class=\"ltx_pagination ltx_role_newpage\"></div>\n</section>",
  "css": "",
  "arxiv_id": "2507.04221",
  "source": "arxiv-experimental",
  "generated": "2025-10-18T01:15:16.074Z"
}
